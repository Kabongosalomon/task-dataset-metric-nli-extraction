[{"caption":"Table 1: Maximum model size of AmoebaNet supported by GPipe under different scenarios. Naive-1 \nrefers to the sequential version without GPipe. Pipeline-k means k partitions with GPipe on k \naccelerators. AmoebaNet-D (L, D): AmoebaNet model with L normal cell layers and filter size D . \nTransformer-L: Transformer model with L layers, 2048 model and 8192 hidden dimensions. Each \nmodel parameter needs 12 bytes since we applied RMSProp during training. \n\n","rows":["542M","Peak Activation Memory","82M","# of Model Parameters","318M","Total Model Parameter Memory"],"columns":["( 18 , 208 )","( 18 , 416 )","( 72 , 512 )","Pipeline - 4","15 . 21GB","Pipeline - 2","Pipeline - 1","Pipeline - 8","26 . 24GB","Naive - 1","1 . 05GB","415","6 . 45GB","24 . 62GB","6 . 26GB","3 . 46GB","Pipeline - 128","13","3 . 8GB","3","103","1663","8 . 11GB","( 36 , 544 )","( 18 , 544 )","12 . 53GB","Pipeline - 32"],"mergedAllColumns":[],"numberCells":[{"number":"1.8B","isBolded":false,"associatedRows":["# of Model Parameters","82M","318M","542M"],"associatedColumns":["Pipeline - 8","( 72 , 512 )"],"associatedMergedColumns":[]},{"number":"11.7G","isBolded":false,"associatedRows":["Total Model Parameter Memory"],"associatedColumns":["Naive - 1","( 18 , 208 )","1 . 05GB","6 . 26GB","Naive - 1","3"],"associatedMergedColumns":[]},{"number":"8.8G","isBolded":false,"associatedRows":["Total Model Parameter Memory"],"associatedColumns":["Pipeline - 1","( 18 , 416 )","3 . 8GB","3 . 46GB","Pipeline - 1","13"],"associatedMergedColumns":[]},{"number":"3.15G","isBolded":false,"associatedRows":["Peak Activation Memory"],"associatedColumns":["Naive - 1","( 18 , 208 )","1 . 05GB","6 . 26GB","Naive - 1","3"],"associatedMergedColumns":[]},{"number":"937.9G","isBolded":false,"associatedRows":["Total Model Parameter Memory"],"associatedColumns":["Pipeline - 8","( 72 , 512 )","24 . 62GB","26 . 24GB","Pipeline - 128","1663"],"associatedMergedColumns":[]},{"number":"50.9G","isBolded":false,"associatedRows":["Peak Activation Memory"],"associatedColumns":["Pipeline - 2","( 18 , 544 )","6 . 45GB","8 . 11GB","Pipeline - 8","103"],"associatedMergedColumns":[]},{"number":"199.9G","isBolded":false,"associatedRows":["Peak Activation Memory"],"associatedColumns":["Pipeline - 4","( 36 , 544 )","12 . 53GB","15 . 21GB","Pipeline - 32","415"],"associatedMergedColumns":[]},{"number":"282.2M","isBolded":false,"associatedRows":["# of Model Parameters"],"associatedColumns":["Naive - 1","( 18 , 208 )","1 . 05GB","6 . 26GB","Naive - 1","3"],"associatedMergedColumns":[]},{"number":"1.05B","isBolded":false,"associatedRows":["# of Model Parameters","82M","318M","542M"],"associatedColumns":["Pipeline - 4","( 36 , 544 )"],"associatedMergedColumns":[]},{"number":"21.0B","isBolded":false,"associatedRows":["# of Model Parameters"],"associatedColumns":["Pipeline - 4","( 36 , 544 )","12 . 53GB","15 . 21GB","Pipeline - 32","415"],"associatedMergedColumns":[]},{"number":"796.1G","isBolded":false,"associatedRows":["Peak Activation Memory"],"associatedColumns":["Pipeline - 8","( 72 , 512 )","24 . 62GB","26 . 24GB","Pipeline - 128","1663"],"associatedMergedColumns":[]},{"number":"5.3B","isBolded":false,"associatedRows":["# of Model Parameters"],"associatedColumns":["Pipeline - 2","( 18 , 544 )","6 . 45GB","8 . 11GB","Pipeline - 8","103"],"associatedMergedColumns":[]},{"number":"59.5G","isBolded":false,"associatedRows":["Total Model Parameter Memory"],"associatedColumns":["Pipeline - 2","( 18 , 544 )","6 . 45GB","8 . 11GB","Pipeline - 8","103"],"associatedMergedColumns":[]},{"number":"83.9B","isBolded":false,"associatedRows":["# of Model Parameters"],"associatedColumns":["Pipeline - 8","( 72 , 512 )","24 . 62GB","26 . 24GB","Pipeline - 128","1663"],"associatedMergedColumns":[]},{"number":"785.8M","isBolded":false,"associatedRows":["# of Model Parameters"],"associatedColumns":["Pipeline - 1","( 18 , 416 )","3 . 8GB","3 . 46GB","Pipeline - 1","13"],"associatedMergedColumns":[]},{"number":"235.1G","isBolded":false,"associatedRows":["Total Model Parameter Memory"],"associatedColumns":["Pipeline - 4","( 36 , 544 )","12 . 53GB","15 . 21GB","Pipeline - 32","415"],"associatedMergedColumns":[]},{"number":"6.4G","isBolded":false,"associatedRows":["Peak Activation Memory"],"associatedColumns":["Pipeline - 1","( 18 , 416 )","3 . 8GB","3 . 46GB","Pipeline - 1","13"],"associatedMergedColumns":[]}]},{"caption":"Table 2: Normalized training throughput using \nGPipe with different # of partitions K and differ-\nent # of micro-batches M on TPUs. Performance \nincreases with more micro-batches. There is an \nalmost linear speedup with the number of accelera-\ntors for Transformer model when M \nK. Batch \nsize was adjusted to fit memory if necessary. \n\n","rows":["M \u003d 32","K \u003d","M \u003d"],"columns":["AmoebaNet","Transformer","TPU"],"mergedAllColumns":[],"numberCells":[{"number":"1.07","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1.21","isBolded":false,"associatedRows":["M \u003d 32"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"1.72","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"4","isBolded":false,"associatedRows":["M \u003d 32","K \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"8","isBolded":false,"associatedRows":["M \u003d 32","K \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"2","isBolded":false,"associatedRows":["M \u003d 32","K \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1.26","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"1.07","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"1.13","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"3.2","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"4","isBolded":false,"associatedRows":["M \u003d 32","K \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"4.8","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1.38","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"1","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"8","isBolded":false,"associatedRows":["M \u003d 32","K \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1.84","isBolded":false,"associatedRows":["M \u003d 32"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"1.7","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"3.4","isBolded":false,"associatedRows":["M \u003d 32"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1","isBolded":true,"associatedRows":["M \u003d"],"associatedColumns":["TPU"],"associatedMergedColumns":[]},{"number":"1.3","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"6.3","isBolded":false,"associatedRows":["M \u003d 32"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"4","isBolded":true,"associatedRows":["M \u003d"],"associatedColumns":["TPU"],"associatedMergedColumns":[]},{"number":"1.8","isBolded":false,"associatedRows":["M \u003d 32"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"3.48","isBolded":false,"associatedRows":["M \u003d 32"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"2","isBolded":false,"associatedRows":["M \u003d","K \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]}]},{"caption":"Table 2. Each partition is as-\nsigned to a separate accelerator. We observe \nthat when the number of micro-batches M is \nat least 4? the number of partitions, the bub-\nble overhead is almost negligible. For Trans-\nformer model, there is a 3.5? speedup when it is \npartitioned across four times more accelerators. \nFurthermore, training throughput scales almost \nlinearly with the number of devices, thanks to \nthe computation being evenly distributed across \nTransformer layers. In contrast, the AmoebaNet \nmodel achieves sub-linear speedup due to its im-\nbalanced computation distribution. When M is \nrelatively small, the bubble overhead can no longer be negligible. When M is 1, there is effectively \nno pipeline parallelism. We observe relatively constant throughput regardless of the number of \naccelerators used, indicating only one device is actively computing at any given time. \n\n","rows":["M \u003d 32","K \u003d","M \u003d"],"columns":["AmoebaNet","Transformer","TPU"],"mergedAllColumns":[],"numberCells":[{"number":"1.21","isBolded":false,"associatedRows":["M \u003d 32"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"1","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"1.3","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1.72","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"4","isBolded":false,"associatedRows":["M \u003d 32","K \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1.38","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"1.07","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"8","isBolded":false,"associatedRows":["M \u003d 32","K \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"2","isBolded":false,"associatedRows":["M \u003d","K \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"4","isBolded":false,"associatedRows":["M \u003d 32","K \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"8","isBolded":false,"associatedRows":["M \u003d 32","K \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"1.8","isBolded":false,"associatedRows":["M \u003d 32"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1.7","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1.07","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"3.4","isBolded":false,"associatedRows":["M \u003d 32"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"6.3","isBolded":false,"associatedRows":["M \u003d 32"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1.84","isBolded":false,"associatedRows":["M \u003d 32"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"1","isBolded":true,"associatedRows":["M \u003d"],"associatedColumns":["TPU"],"associatedMergedColumns":[]},{"number":"3.2","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"2","isBolded":false,"associatedRows":["M \u003d 32","K \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"1.13","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"4","isBolded":true,"associatedRows":["M \u003d"],"associatedColumns":["TPU"],"associatedMergedColumns":[]},{"number":"4.8","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["Transformer"],"associatedMergedColumns":[]},{"number":"3.48","isBolded":false,"associatedRows":["M \u003d 32"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]},{"number":"1.26","isBolded":false,"associatedRows":["M \u003d"],"associatedColumns":["AmoebaNet"],"associatedMergedColumns":[]}]},{"caption":"Table 4: Image classification accuracy using AmoebaNet-B (18, 512) first trained on ImageNet 2012 \nthen fine-tuned on others. Please refer to the supplementary material for a detailed description of our \ntraining setup. Our fine-tuned results were averaged across 5 fine-tuning runs. Baseline results from \nReal et al. [12] and Cubuk et al. [26] were directly trained from scratch. *Mahajan et al.\u0027s model [27]  achieved 85.4% top-1 accuracy but it was pretrained on non-public Instagram data. Ngiam et al. [28]  achieved better results by pre-training with data from a private dataset (JFT-300M). \n\n","rows":["3 , 333","25 , 250","1000","Oxford Pets","196","FGVC Aircraft","Birdsnap","ImageNet - 2012","10","2 , 443","10 , 000","3 , 369","8 , 041","37","8 , 144","50 , 000","CIFAR - 10","Food - 101","47 , 386","1 , 281 , 167","100","Stanford Cars","101","500","3 , 680","CIFAR - 100","75 , 750","6 , 667"],"columns":["Accuracy ( % )","Previous Best ( % )"],"mergedAllColumns":[],"numberCells":[{"number":"83.6","isBolded":true,"associatedRows":["Birdsnap","47 , 386","2 , 443","500"],"associatedColumns":["Accuracy ( % )"],"associatedMergedColumns":[]},{"number":"(85.4*[27])","isBolded":false,"associatedRows":["ImageNet - 2012","1 , 281 , 167","50 , 000","1000"],"associatedColumns":["Previous Best ( % )"],"associatedMergedColumns":[]},{"number":"83.9[12]","isBolded":true,"associatedRows":["ImageNet - 2012","1 , 281 , 167","50 , 000","1000"],"associatedColumns":["Previous Best ( % )"],"associatedMergedColumns":[]},{"number":"94.8*[26]","isBolded":true,"associatedRows":["Stanford Cars","8 , 144","8 , 041","196"],"associatedColumns":["Previous Best ( % )"],"associatedMergedColumns":[]},{"number":"84.4","isBolded":true,"associatedRows":["ImageNet - 2012","1 , 281 , 167","50 , 000","1000"],"associatedColumns":["Accuracy ( % )"],"associatedMergedColumns":[]},{"number":"92.7","isBolded":true,"associatedRows":["FGVC Aircraft","6 , 667","3 , 333","100"],"associatedColumns":["Accuracy ( % )"],"associatedMergedColumns":[]},{"number":"93.8*[29]","isBolded":true,"associatedRows":["Oxford Pets","3 , 680","3 , 369","37"],"associatedColumns":["Previous Best ( % )"],"associatedMergedColumns":[]},{"number":"91.3","isBolded":true,"associatedRows":["CIFAR - 100","50 , 000","10 , 000","100"],"associatedColumns":["Accuracy ( % )"],"associatedMergedColumns":[]},{"number":"80.2*[32]","isBolded":true,"associatedRows":["Birdsnap","47 , 386","2 , 443","500"],"associatedColumns":["Previous Best ( % )"],"associatedMergedColumns":[]},{"number":"98.5[26]","isBolded":true,"associatedRows":["CIFAR - 10","50 , 000","10 , 000","10"],"associatedColumns":["Previous Best ( % )"],"associatedMergedColumns":[]},{"number":"90.4*[30]","isBolded":true,"associatedRows":["Food - 101","75 , 750","25 , 250","101"],"associatedColumns":["Previous Best ( % )"],"associatedMergedColumns":[]},{"number":"93.0","isBolded":true,"associatedRows":["Food - 101","75 , 750","25 , 250","101"],"associatedColumns":["Accuracy ( % )"],"associatedMergedColumns":[]},{"number":"99.0","isBolded":true,"associatedRows":["CIFAR - 10","50 , 000","10 , 000","10"],"associatedColumns":["Accuracy ( % )"],"associatedMergedColumns":[]},{"number":"95.9","isBolded":true,"associatedRows":["Oxford Pets","3 , 680","3 , 369","37"],"associatedColumns":["Accuracy ( % )"],"associatedMergedColumns":[]},{"number":"92.9*[31]","isBolded":true,"associatedRows":["FGVC Aircraft","6 , 667","3 , 333","100"],"associatedColumns":["Previous Best ( % )"],"associatedMergedColumns":[]},{"number":"94.6","isBolded":true,"associatedRows":["Stanford Cars","8 , 144","8 , 041","196"],"associatedColumns":["Accuracy ( % )"],"associatedMergedColumns":[]},{"number":"89.3[26]","isBolded":true,"associatedRows":["CIFAR - 100","50 , 000","10 , 000","100"],"associatedColumns":["Previous Best ( % )"],"associatedMergedColumns":[]}]},{"caption":"Table 5: The Effect of Batch Size \n\nBatch Size \n260K \n1M \n4M \nBLEU \n30.92 31.86 32.71 \nLoss (NLL) 2.58 \n2.51 \n2.46 \n\n","rows":["BLEU","Loss ( NLL )"],"columns":["Table 5 : The Effect of Batch Size","260K","4M","1M"],"mergedAllColumns":[],"numberCells":[{"number":"30.92","isBolded":false,"associatedRows":["BLEU"],"associatedColumns":["Table 5 : The Effect of Batch Size","260K"],"associatedMergedColumns":[]},{"number":"2.51","isBolded":false,"associatedRows":["Loss ( NLL )"],"associatedColumns":["Table 5 : The Effect of Batch Size","1M"],"associatedMergedColumns":[]},{"number":"2.46","isBolded":false,"associatedRows":["Loss ( NLL )"],"associatedColumns":["Table 5 : The Effect of Batch Size","4M"],"associatedMergedColumns":[]},{"number":"31.86","isBolded":false,"associatedRows":["BLEU"],"associatedColumns":["Table 5 : The Effect of Batch Size","1M"],"associatedMergedColumns":[]},{"number":"2.58","isBolded":false,"associatedRows":["Loss ( NLL )"],"associatedColumns":["Table 5 : The Effect of Batch Size","260K"],"associatedMergedColumns":[]},{"number":"32.71","isBolded":false,"associatedRows":["BLEU"],"associatedColumns":["Table 5 : The Effect of Batch Size","4M"],"associatedMergedColumns":[]}]}]