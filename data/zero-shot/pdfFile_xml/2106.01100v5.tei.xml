<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /nfs/home/kabenamualus/Research/task-dataset-metric-extraction/../grobid-0.6.0/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Prediction of the Position of External Markers Using a Recurrent Neural Network Trained With Unbiased Online Recurrent Optimization for Safe Lung Cancer Radiotherapy</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michel</forename><surname>Pohl</surname></persName>
							<email>michel.pohl@centrale-marseille.fr</email>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mitsuru</forename><surname>Uesaka</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Hiroyuki</forename><surname>Takahashi</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">?</forename><surname>Kazuyuki</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Demachi</forename><forename type="middle">?</forename><surname>Ritu</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Bhusal</forename><surname>Chhatkuli</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michel</forename><surname>Pohl</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mitsuru</forename><surname>Uesaka</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Hiroyuki</forename><surname>Takahashi</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kazuyuki</forename><surname>Demachi</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ritu</forename><forename type="middle">Bhusal</forename><surname>Chhatkuli</surname></persName>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="institution">The University of Tokyo</orgName>
								<address>
									<postCode>113-8654</postCode>
									<settlement>Tokyo</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<orgName type="department">Atomic Energy Commission</orgName>
								<address>
									<postCode>100-8914</postCode>
									<settlement>Tokyo</settlement>
									<country>Japan, Japan</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff2">
								<orgName type="institution">The University of Tokyo</orgName>
								<address>
									<postCode>113-8654</postCode>
									<settlement>Tokyo</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff3">
								<orgName type="department">National Institutes for Quantum and Radiological Science and Technology</orgName>
								<address>
									<postCode>263-8555</postCode>
									<settlement>Chiba</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Prediction of the Position of External Markers Using a Recurrent Neural Network Trained With Unbiased Online Recurrent Optimization for Safe Lung Cancer Radiotherapy</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<note>Preprint submitted to Computer Methods and Programs in Biomedicine</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>

		<encodingDesc>
			<appInfo>
				<application version="0.6.0" ident="GROBID-SDO" when="2022-11-11T13:48+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid-sdo"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>Radiotherapy ? Respiratory motion management ? External markers ? Recurrent neural network ? Online training ? Time series forecasting</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Background and Objective: During lung cancer radiotherapy, the position of infrared reflective objects on the chest can be recorded to estimate the tumor location. However, radiotherapy systems have a latency inherent to robot control limitations that impedes the radiation delivery precision. Prediction with online learning of recurrent neural networks (RNN) allows for adaptation to non-stationary respiratory signals, but classical methods such as real-time recurrent learning (RTRL) and truncated backpropagation through time are respectively slow and biased. This study investigates the capabilities of unbiased online recurrent optimization (UORO) to forecast respiratory motion and enhance safety in lung radiotherapy. Methods: We used nine observation records of the threedimensional (3D) position of three external markers on the chest and abdomen of healthy individuals breathing during intervals from 73s to 222s. The sampling frequency was 10Hz, and the amplitudes of the recorded trajectories range from 6mm to 40mm in the superiorinferior direction. We forecast the 3D location of each marker simultaneously with a horizon value (the time interval in advance for which the prediction is made) between 0.1s and 2.0s, using an RNN trained with UORO. We compare its performance with an RNN trained with RTRL, least mean squares (LMS), and offline linear re-gression. We provide closed-form expressions for quantities involved in the loss gradient calculation in UORO, thereby making its implementation efficient. Training and cross-validation were performed during the first minute of each sequence. Results: On average over the horizon values considered and the nine sequences, UORO achieves the lowest rootmean-square (RMS) error and maximum error among the compared algorithms. These errors are respectively equal to 1.3mm and 8.8mm, and the prediction time per time step was lower than 2.8ms (Dell Intel core i9-9900K 3.60 GHz). Linear regression has the lowest RMS error for the horizon values 0.1s and 0.2s, followed by LMS for horizon values between 0.3s and 0.5s, and UORO for horizon values greater than 0.6s. Conclusions: UORO can accurately predict the 3D position of external markers for intermediate to high response times with an acceptable time performance. This will help limit unwanted damage to healthy tissues caused by radiotherapy.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>tude of lung tumor motion due to breathing can exceed 5cm in the superior-inferior (SI) direction <ref type="bibr" target="#b42">[43]</ref>. Respiratory motion is largely cyclic but exhibits changes in frequency and amplitude, shifts and drifts, and varies across patients and fractions <ref type="bibr" target="#b50">[51,</ref><ref type="bibr" target="#b6">7]</ref>. The term "shift" designates abrupt changes of the respiratory signal, whereas "drift" designates continuous variations of the mean tumor position. Baseline drifts of 1.65 ? 5.95 mm (mean position ? standard deviation) in the craniocaudal direction have been observed in <ref type="bibr" target="#b46">[47]</ref>. To overcome this problem, one can record the position of external markers placed on the chest and abdomen with infrared cameras (e.g., Cyberknife system <ref type="bibr" target="#b14">[15]</ref> in <ref type="figure" target="#fig_0">Fig. 1</ref>). By using an appropriate correspondence model, these positions may be correlated to the three-dimensional (3D) position and shape of the tumor for accurate irradiation <ref type="bibr" target="#b6">[7,</ref><ref type="bibr" target="#b26">27]</ref>. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.2">Compensation of treatment system latency via prediction</head><p>Radiotherapy treatment machines are subject to a time latency due to communication delays, robot control, and radiation system delivery preparation. <ref type="bibr">Verma et al.</ref> reported that "for most radiation treatments, the latency will be more than 100ms, and can be up to two seconds" <ref type="bibr" target="#b50">[51]</ref>. Delay compensation is necessary to minimize excessive damage to healthy tissues ( <ref type="figure">Fig. 3</ref>). To achieve that, various prediction methods, including Bayesian filtering based on Kalman theory <ref type="bibr" target="#b38">[39]</ref>, relevance vector machines <ref type="bibr" target="#b7">[8]</ref>, and online sequential forecasting random convolution nodes <ref type="bibr" target="#b53">[54]</ref>, have been proposed. Reviews and comparisons of the classical <ref type="bibr" target="#b0">1</ref> Adapted from <ref type="bibr" target="#b43">[44]</ref> with permission from Wiley, Copyright 2004 American Association of Physicists in Medicine. methods can be found in <ref type="bibr" target="#b50">[51,</ref><ref type="bibr" target="#b19">20,</ref><ref type="bibr" target="#b12">13,</ref><ref type="bibr" target="#b6">7]</ref>. Among the approaches studied, artificial neural networks (ANNs) form a class of algorithms that perform well at forecasting tasks. Different ANN architectures and training algorithms have been investigated extensively in the context of respiratory motion prediction, mostly for onedimensional (1D) traces ( <ref type="figure" target="#fig_1">Fig. 2a)</ref>  <ref type="bibr" target="#b44">[45,</ref><ref type="bibr" target="#b8">9,</ref><ref type="bibr" target="#b30">31,</ref><ref type="bibr" target="#b15">16,</ref><ref type="bibr" target="#b20">21,</ref><ref type="bibr" target="#b21">22,</ref><ref type="bibr" target="#b5">6,</ref><ref type="bibr" target="#b45">46,</ref><ref type="bibr" target="#b13">14,</ref><ref type="bibr" target="#b49">50,</ref><ref type="bibr" target="#b52">53,</ref><ref type="bibr" target="#b11">12,</ref><ref type="bibr" target="#b22">23,</ref><ref type="bibr" target="#b56">57,</ref><ref type="bibr" target="#b12">13,</ref><ref type="bibr" target="#b23">24,</ref><ref type="bibr" target="#b55">56,</ref><ref type="bibr" target="#b4">5,</ref><ref type="bibr" target="#b18">19,</ref><ref type="bibr" target="#b37">38,</ref><ref type="bibr" target="#b51">52]</ref>. ANNs are efficient for performing prediction with a high response time, which is the time interval in advance for which the prediction is made, also called the look-ahead time or horizon, and for non-stationary and complex signals. However, they are heavily computer resource intensive and have high processing times <ref type="bibr" target="#b50">[51]</ref>. Furthermore, deep ANNs need large amounts of data for training which can be practically difficult because of patient data regulations, and the prediction results are strongly dependent on the database chosen. Tumor motion is essentially three-dimensional, but most previous works about ANNs applied to respiratory motion management in radiotherapy focused on univariate time-series forecasting.</p><p>Recurrent neural networks (RNNs) are characterized by a feedback loop that acts as a memory and enables the retention of information over time. They are able to efficiently learn features and long-term dependencies from sequential and time-series data <ref type="bibr" target="#b41">[42]</ref>. As a result, almost all of the recent research about ANNs applied to time series forecasting for motion management in radiotherapy focuses on RNNs <ref type="bibr" target="#b13">[14,</ref><ref type="bibr" target="#b52">53,</ref><ref type="bibr" target="#b56">57,</ref><ref type="bibr" target="#b22">23,</ref><ref type="bibr" target="#b23">24,</ref><ref type="bibr" target="#b55">56,</ref><ref type="bibr" target="#b18">19,</ref><ref type="bibr" target="#b51">52,</ref><ref type="bibr" target="#b37">38]</ref>. It has experimentally been observed that forecasting respiratory signals with an RNN could improve radiation delivery accuracy <ref type="bibr" target="#b18">[19]</ref>. RNN models such as long short term memory (LSTM) networks have also been used in related medical data processing problems such as cardiorespiratory motion prediction from X-ray angiography sequences <ref type="bibr" target="#b1">[2]</ref> and next-frame prediction in medical image sequences, including chest dynamic imaging <ref type="bibr" target="#b32">[33,</ref><ref type="bibr" target="#b39">40]</ref>.</p><p>Our research investigates the feasibility of predicting breathing motion with online training algorithms for RNNs. In contrast to offline methods, online methods update the synaptic weights with each new training example. That enables the neural network to adapt to the continuously changing breathing patterns of the patient (section 1.1), therefore providing robustness to complex motion. Because online learning enables adap-2 MLP, FCL, NARX, and TCN respectively stand for "multilayer perceptron", "fully connected layer", "nonlinear autoregressive exogenous model", and "temporal convolutional network". By abuse of language, the number of layers mentioned actually refers to the number of hidden layers. For instance, a "1-layer MLP" architecture refers to an MLP with 1 hidden layer. (b) Evolution and development of algorithms for online learning of RNNs. Our study is the first to assess the potential of UORO for respiratory motion compensation in radiotherapy. tation to examples unseen in the training set, it can be viewed as a way to compensate for the difficulty of acquiring and using large training databases for medical applications. Adaptive or dynamic learning has been applied many times to radiotherapy, and several studies demonstrated the benefit of that approach in comparison with static models <ref type="bibr" target="#b15">[16,</ref><ref type="bibr" target="#b49">50,</ref><ref type="bibr" target="#b23">24]</ref>. Real-time recurrent learning (RTRL) <ref type="bibr" target="#b54">[55]</ref> is one of these dynamic approaches that has already been used for predicting tumor motion from the Cyberknife Synchrony system <ref type="bibr" target="#b23">[24]</ref> and the SyncTraX system <ref type="bibr" target="#b11">[12]</ref>, as well as the position of internal points in the chest <ref type="bibr" target="#b37">[38]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>POHL</head><p>Many techniques for online training of RNNs have recently emerged <ref type="bibr" target="#b34">[35,</ref><ref type="bibr" target="#b48">49,</ref><ref type="bibr" target="#b9">10,</ref><ref type="bibr" target="#b29">30,</ref><ref type="bibr" target="#b40">41,</ref><ref type="bibr" target="#b2">3,</ref><ref type="bibr" target="#b31">32,</ref><ref type="bibr" target="#b0">1,</ref><ref type="bibr" target="#b27">28,</ref><ref type="bibr" target="#b24">25,</ref><ref type="bibr" target="#b3">4]</ref>, such as unbiased online recurrent optimization (UORO) <ref type="bibr" target="#b47">[48]</ref>  <ref type="figure" target="#fig_1">(Fig. 2b</ref>). Most of these seek to approximate RTRL, which suffers from a large computational complexity. They also aim to provide an unbiased estimation of the loss gradient that truncated backpropagation through time (truncated BPTT) <ref type="bibr" target="#b10">[11]</ref> cannot compute, guaran-teeing an appropriate balance between short-term and long-term temporal dependencies. The theoretical convergence of RTRL and UORO, which could not be proved by standard stochastic gradient descent theory, has recently been established <ref type="bibr" target="#b25">[26]</ref>. <ref type="figure">Fig. 3</ref>: Excessive irradiation of healthy lung tissue due to an overall system delay ?t not compensated. The area irradiated, represented here using diagonal stripes, is larger than the tumor size, to take into consideration effects such as the variation of the tumor shape during the treatment 3 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.3">Content of this study</head><p>This is the first study evaluating the capabilities of RNNs trained online with UORO to predict the position of external markers on the chest and abdomen for safety in radiotherapy. In contrast to most of the studies mentioned in Section 1.2 focusing on the prediction of 1D signals, we tackle the problem of multivariate forecasting of the 3D coordinates of the markers, as this will help estimate the tumor location more precisely during the treatment. The proposed RNN framework does not perform prediction for each marker separately but instead learns patterns about the correlation between their motion to potentially increase the forecasting accuracy. We provide closed-form expressions for some quantities involved in UORO in the specific case of vanilla RNNs, as the original article <ref type="bibr" target="#b47">[48]</ref> only describes UORO for a general RNN model. We compare UORO with different forecasting algorithms, namely RTRL, least mean squares (LMS), and linear regression, for different look-ahead values h, ranging from h min = 0.1s to h max = 2.0s, by observing different prediction metrics as h varies. We divide the subjects' data into two groups: regular and irregular breathing, to quantify the 3 Reprinted from <ref type="bibr" target="#b37">[38]</ref>, Copyright 2021, with permission from Elsevier. robustness of each prediction algorithm. We analyze the influence of the hyper-parameters on the prediction accuracy of UORO as the horizon value changes and discuss the selection of the best hyper-parameters.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Material and Methods</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Marker position data</head><p>In this study, we use 9 records of the 3D position of 3 external markers on the chest and abdomen of individuals lying on a treatment couch (HexaPOD), acquired by an infrared camera (NDI Polaris). The duration of each sequence is between 73s and 320s and the sampling rate is 10Hz. The superior-inferior, left-right, and anteroposterior trajectories respectively range between 6mm and 40mm, between 2mm and 10mm, and between 18 mm and 45mm. In five of the sequences, the breathing motion is normal and in the four remaining sequences, the individuals were asked to perform actions such as talking or laughing. Additional details concerning the dataset can be found in <ref type="bibr" target="#b17">[18]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">The RTRL and UORO algorithms for training RNNs</head><p>In this study, we train an RNN with one hidden layer to predict the position of 3 markers in the future. RNNs with one hidden layer are characterized by the state equation, which describes the dynamics of the internal states, and the measurement equation, which describes how the RNN output is influenced by the hidden states (Eq. 1). In the following, we denote by u n ? R m+1 , x n ? R q , y n ? R p , and ? n the input, state, output, and synaptic weight vectors at time t n . <ref type="figure">Fig. 4</ref> gives a graphical representation of these two equations.</p><formula xml:id="formula_0">x n+1 = F st (x n , u n , ? n ) y n = F out (x n , ? n )<label>(1)</label></formula><p>The instantaneous square loss L n of the network can be calculated from the instantaneous error e n between the vector y * n containing the ground-truth positions and the output y n containing the predicted positions (Eq.  ? n affect the instantaneous loss L n+1 and state vector x n+1 . Computation of the gradient of L n+1 with respect to the parameter vector using Eq. 3, followed by recursive computation of the influence matrix ?x n /?? using Eq. 4 constitutes the RTRL algorithm. RTRL is computationally expensive, and UORO attempts to solve that problem by approximating the influence matrix with an unbiased rank-one estimator. In UORO, two random column vectorsx n and? n are recursively updated at each time step so that E(x n? T n ) = ?x n /??. It was reported that "UORO's noisy estimates of the true gradient are almost orthogonal with RTRL at each time point, but the errors average out over time and allow UORO to find the same solution" <ref type="bibr" target="#b24">[25]</ref>  <ref type="figure" target="#fig_4">(Fig. 5</ref>).</p><formula xml:id="formula_1">?L n+1 ?? = ?L n+1 ?y (y n+1 ) ?F out ?x (x n , ? n ) ?x n ?? + ?F out ?? (x n , ? n ) (3) ?x n+1 ?? = ?F st ?x (x n , u n , ? n ) ?x n ?? + ?F st ?? (x n , u n , ? n ) (4)</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Online prediction of the position of the markers with a vanilla RNN</head><p>If we denote by u j (t k ) = [u x j (t k ), u y j (t k ), u z j (t k )] the normalized 3D displacement of marker j at time t k , the in- <ref type="bibr" target="#b4">5</ref> Reprinted from <ref type="bibr" target="#b24">[25]</ref>, Copyright JMLR 2020. put u n of the RNN consists of the concatenation of the vectors u j (t n ), ..., u j (t n+L?1 ) for each marker j, where L designates the signal history length (SHL), expressed here in number of time steps. The prediction of the displacement of the 3 markers is performed simultaneously to use information about the correlation between each of them. The output vector y n+1 consists of the position of these 3 points at time t n+L+h?1 , where h refers to the horizon value, expressed also in number of time steps (Eq. 5).</p><formula xml:id="formula_2">u n = ? ? ? ? ? ? ? ? ? ? ? ? ? ? 1 u x 1 (t n ) u y 1 (t n ) u z 1 (t n ) ... u z 3 (t n ) u x 1 (t n+1 ) ... u z 3 (t n+L?1 ) ? ? ? ? ? ? ? ? ? ? ? ? ? ? y n+1 = ? ? ? ? ? ? u x 1 (t n+L+h?1 ) u y 1 (t n+L+h?1 ) u z 1 (t n+L+h?1 ) ... u z 3 (t n+L+h?1 ) ? ? ? ? ? ?<label>(5)</label></formula><p>In this work, we use a vanilla RNN structure, described by Eqs. 6 and 7, where the parameter vector ? n consists of the elements of the matrices W a,n , W b,n , and W c,n of respective size q ? q, q ? (m + 1), and p ? q. ? is the nonlinear activation function and we use here the hyperbolic tangent function (Eq. 8).</p><formula xml:id="formula_3">F st (x n , u n , ? n ) = ?(W a,n x n + W b,n u n ) (6) F out (x n , ? n ) = W c,n x n (7) ? ? ? z 1 ... z q ? ? = ? ? tanh(z 1 ) ... tanh(z q ) ? ?<label>(8)</label></formula><p>RNNs updated by the gradient descent rule may be unstable. Therefore, we prevent large weight updates by clipping the gradient norm to avoid numerical instability <ref type="bibr" target="#b35">[36]</ref>. The optimizer is stochastic gradient descent. The implementation of UORO in the case of the vanilla model described above is detailed in Algorithm 1. The Algorithm 1 UORO 1: Parameters : 2: L ? N * : signal history length, n M = 3 : number of external markers considered 3: m = 3n M L, q ? N * and p = 3n M : dimension of the RNN input, RNN state and RNN output 4: ? ? R &gt;0 and ? ? R &gt;0 : learning rate and gradient threshold 5: ? init ? R &gt;0 : standard deviation of the Gaussian distribution of the initial weights 6: norm = 1.10 ?7 , prop = 1.10 ?7 7: 8:</p><formula xml:id="formula_4">Initialization 9: W a,n=1 , W b,n=1 , W c,n=1</formula><p>: synaptic weight matrices of respective sizes q ? q, q ? (m + 1) and p ? q, initialized randomly according to a Gaussian distribution with std. deviation ? init . 10: Notation : |Wa| = q 2 , |W b | = q(m + 1), |Wc| = pq, and |W | = q(p + q + m + 1) 11: x n=1 := 0 q?1 : state vector,x n=1 := 0 q?1 ,? n=1 := 0 1?|W | : vectors such that ?xn/?? ?xn?n 12: ?? := 0 1?|W | , ??g = 0 1?|W | : vectors defined by ?? = ?L n+1 ?y ?Fout ?? and ??g = ? T ?Fst ?? 13: 14: Learning and prediction 15: for n = 1, 2, ... do 16:</p><formula xml:id="formula_5">zn := Wa,nxn + W b,n un, x n+1 := ?(zn) (hidden state update) 17: y n+1 := Wc,nx n+1 (prediction), e n+1 := y * n+1 ? y n+1 (error vector update) 18: [?? 1+|Wa|+|W b | , ..., ?? |W | ] := ?[(e n+1 x T n ) 1,1 , ..., (e n+1 x T n )p,q] 19: ?xL n+1 := ?e T n+1</formula><p>Wc,n, ?? := ?xL n+1xn?n + ?? (gradient estimate) 20:</p><p>? : column vector of size q with random values in {?1, 1}</p><p>21:</p><formula xml:id="formula_6">x n+1 := ?[Wa,n(xn + propxn) + W b,n un] ? x n+1</formula><p>prop (tangent forward propagation) <ref type="bibr" target="#b21">22</ref>:</p><formula xml:id="formula_7">?? aux g := ? * ? (zn) (element-wise product) 23: [(??g) 1 , ..., (??g) |Wa| ] := [(?? aux g x T n ) 1,1 , ..., (?? aux g x T n ) q,q ] 24: [(??g) |Wa|+1 , ..., (??g) |Wa|+|W b | ] := [(?? aux g u T n ) 1,1 , ..., (?? aux g u T n ) q,m+1 ] 25:</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>26:</head><p>? 0 := ? 2 </p><formula xml:id="formula_8">x 2 + norm + norm, ? 1 := ? g 2 ? 2 + norm + norm 27:x n+1 := ? 0xn+1 + ? 1 ?? n+1 :=?n/? 0 + (??g)/? 1 28: ?n := [(Wa,n) 1,1 , ..., (Wa,n)q,q, (W b,n ) 1,1 , ..., (W b,n ) q,</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>32:</head><p>? n+1 := ?n ? ??? (weights update) <ref type="bibr" target="#b32">33</ref>:</p><formula xml:id="formula_9">W a,n+1 := ? ? (? n+1 ) 1 ... (? n+1 ) q(q?1)+1 ... ... ... (? n+1 )q ... (? n+1 ) |Wa| ? ? W b,n+1 := ? ? (? n+1 ) |Wa|+1 ... (? n+1 ) |Wa|+qm+1 ... ... ... (? n+1 ) |Wa|+q ... (? n+1 ) |Wa|+|W b | ? ? 34: W c,n+1 := ? ? (? n+1 ) |Wa|+|W b |+1 ... (? n+1 ) |Wa|+|W b |+p(q?1)+1 ... ... ... (? n+1 ) |Wa|+|W b |+p ... (? n+1 ) |Wa|+|W b |+|Wc| ? ? 35: end for 36: 37: Convention : for A ? R M ? R N we note [A 1,1 , ..., A M,N ] = [A 1,1 , ..., A M,1 , A 1,2 , ..., A M,N ]</formula><p>quantities ? x L n+1 , ??, and ?? g are calculated in Appendix A. The RNN characteristics are summarized in <ref type="table" target="#tab_2">Table 1</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Experimental design</head><p>We compare RNNs trained with UORO with other prediction methods: RNNs trained with RTRL, LMS, and multivariate linear regression ( <ref type="table">Table 2</ref>). We clipped the gradient estimate of the instantaneous loss (Eq. 2) with respect to the parameter vector ? ? L n for UORO, RTRL, and LMS when ? ? L n 2 &gt; ? with the same threshold value ? = 2.0 for these three algorithms.</p><p>Learning is performed using only information from the sequence that is used for testing. Each time series is split into a training and development set of 1 min and the remaining test set. The training set comprises the data between 0s and 30s except in the case of linear regression as using more data is beneficial to offline methods. The hyper-parameters that minimize the  root-mean-square error (Eq. 10) of the cross-validation set during the grid search process are selected for evaluation. The term ? j (t k ) in Eq. 10 designates the instantaneous prediction error at time t k due to marker j, defined in Eq. 9.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>RNN characteristic</head><formula xml:id="formula_10">? j (t k ) = u pred j (t k ) ? u true j (t k ) 2 (9) RM SE = 1 3(k max ? k min + 1) kmax k=kmin 3 j=1 ? j (t k ) 2 (10)</formula><p>To analyze the forecasting performance of each algorithm, we compute the RMSE, but also the normalized RMSE (Eq. 11), mean average error (Eq. 12), and maximum error (Eq. 13) of the test set. In Eq. 11, ? true j designates the mean 3D position of marker j in the test set. Because the weights of the RNNs are initialized randomly, given each set of hyper-parameters, we average the RMSE of the cross-validation set over n cv = 50 successive runs. Then, during performance evaluation, each metric is averaged over n test = 300 runs.</p><formula xml:id="formula_11">nRM SE = kmax k=kmin 3 j=1 ? j (t k ) 2 kmax k=kmin 3 j=1 ? true j ? u true j (t k ) 2 2 (11) M AE = 1 3(k max ? k min + 1) kmax k=kmin 3 j=1 ? j (t k ) (12) e max = max k=kmin,...,kmax max j=1,2,3 ? j (t k )<label>(13)</label></formula><p>Furthermore, we examine the jitter of the test set, which measures the oscillation amplitude of the predicted signal (Eq. 14). High fluctuations of the prediction signal result in difficulties concerning robot control during the treatment. The jitter J is minimized when the prediction is constant, thus there is a trade-off between accuracy and jitter <ref type="bibr" target="#b17">[18]</ref>.</p><formula xml:id="formula_12">J = 1 3(kmax ? k min ) kmax?1 k=k min 3 j=1 u pred j (t k+1 ) ? u pred j (t k ) 2 (14)</formula><p>We assume that given an RNN training method, each associated error measure e i,h (the MAE, RMSE, nRMSE, maximum error, or jitter) corresponding to sequence i and horizon h follows a Gaussian distribution    </p><formula xml:id="formula_13">N (? i,h , ? 2 i,h</formula><formula xml:id="formula_14">? i,h ? ?? i,h , ? i,h + ?? i,h ] for ? i,h , where ?? i,h is defined in Eq. 16. 6 ? 2 i,h = 1 n test ? 1 ntest r=1 e (r) i,h ? ? i,h 2 (15) ?? i,h = 1.96 ? i,h ? n test<label>(16)</label></formula><formula xml:id="formula_15">?? I = 1 |I| |H| i?I hmax h=hmin (?? i,h ) 2<label>(17)</label></formula><p>3 Results</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Prediction accuracy and oscillatory behavior of the predicted signal</head><p>UORO achieves the lowest RMSE, nRMSE and maximum error averaged over all the sequences and horizons (cf <ref type="table">Table 3</ref>). It is relatively robust to irregular motion, as its nRMSE only increases by 10.6% between regular and irregular breathing. LMS is subject to high jitter values (cf also <ref type="figure" target="#fig_0">Fig. 7, Fig. 8, Fig. 9, and Fig. 13</ref>).</p><p>The high maximum errors corresponding to RTRL, relative to UORO and LMS, can be observed in <ref type="figure" target="#fig_0">Fig. 14.</ref> The narrow 95% confidence intervals associated with the performance measures reported in <ref type="table">Table 3</ref> indicate that selecting n test = 300 runs is sufficient for providing accurate results. <ref type="bibr" target="#b7">8</ref> Sequence 201205111057-LACLARUAR-3-O-72 (cf <ref type="bibr" target="#b17">[18]</ref>) has been removed from the sequences with abnormal respiratory motion when reporting performance measures in the last column, as it does not contain abrupt or sudden motion that typically makes forecasting difficult. In particular, this is why the nRMSE of UORO averaged over the 9 sequences is lower than nRMSE of UORO averaged over the regular or irregular breathing sequences.</p><p>The graphs representing the performance of each algorithm as a function of the horizon value h appear to have irregular and changeable local variations, especially in the case of RTRL and LMS, because the set of hyper-parameters automatically selected by crossvalidation is different for each horizon value <ref type="figure" target="#fig_7">(Fig. 7)</ref>. These instabilities may also be caused by the relatively low number of breathing records in our dataset. However, it can be observed that the prediction errors and jitter of the test set corresponding to each algorithm globally tend to increase with h.</p><p>Linear regression achieves the lowest RMSE and nRMSE for h ? 0.2s as well as the lowest MAE and maximum error for h = 0.1s. The RMSE corresponding to linear regression for h = 0.2s is equal to 0.92mm. LMS gives the lowest RMSE for 0.3s ? h ? 0.5s, the lowest MAE for 0.2s ? h ? 0.4s, the lowest nRMSE for h = 0.3s and h = 0.4s, and the lowest maximum error for 0.4s ? h ? 0.6s. The RMSE corresponding to LMS for h = 0.5s is equal to 1.23mm. UORO outperforms the other algorithms in terms of RMSE for h ? 0.6s and maximum error for h ? 0.7s. The RMSE given by UORO is rather constant and stays below 1.33mm across all the horizon values considered. RTRL and UORO both have a lower prediction MAE than LMS for h ? 0.5s. Our analysis of the influence of the latency on the relative performance of linear filters, adaptive filters, and ANNs agrees with the review of Verma et al. <ref type="bibr">[</ref>  <ref type="table">Table 3</ref>: Comparison of the forecasting performance of each algorithm. Each error value corresponds to the average of a given performance measure of the test set over the sequences considered and the horizon values between 0.1s and 2.0s. The 95% mean confidence intervals associated with the RNNs are calculated assuming that the error distribution is Gaussian (Eq. 17).</p><p>The jitter associated with RTRL and UORO respectively increases from 0.71mm and 0.94mm for h = 0.1s to 0.78mm and 0.96mm for h = 2.0s. However, the jitter associated with linear regression and LMS increases more significantly with h. The jitter corresponding to linear regression is the lowest among the four prediction methods for h ? 0.6s.</p><p>The performance of each algorithm as a function of the horizon in the cases of normal breathing and abnormal breathing is detailed in Appendix D. The local unsteadiness of the variations of each performance measure with h in <ref type="figure" target="#fig_0">Figs. 15 and 16</ref> is more pronounced than in <ref type="figure" target="#fig_7">Fig. 7</ref> because both situations involve averaging results over fewer respiratory traces. However, it still appears that the prediction errors globally tend to increase with h in both cases. UORO performs better than the other algorithms for lower horizon values in the scenario of abnormal breathing. Indeed, it achieves the lowest RMSE and nRMSE for h ? 0.3s, and the lowest MAE for h ? 0.2s (RTRL and UORO achieve comparable performance for high horizons in terms of MAE). <ref type="figure" target="#fig_0">Fig. 10</ref> also shows that the prediction nRMSE of the cross-validation set tends to increase as the horizon value h increases. On average over the 9 sequences and all the horizon values, ? = 0.1 and L = 7.0s give the best prediction results. However, for h = 2.0s, a higher learning rate ? = 0.2 and a lower value of the SHL L = 5.0s give better results <ref type="figure" target="#fig_0">(Figs. 10a, 10c</ref>). In other words, when performing prediction with a high lookahead time, it seems better to make the RNN more dependent on the recent inputs, and quickly correct the synaptic weights when large prediction errors occur. In our experimental setting, ? init = 0.02 and q = 90 hidden units correspond to the lowest nRMSE of the cross-validation set <ref type="figure" target="#fig_0">(Figs. 10b, 10d</ref>). The nRMSE of the cross-validation set decreases as the number of hidden units increases, therefore we may achieve higher accuracy with more hidden units. However, that would consequently increase the computing time ( <ref type="figure" target="#fig_0">Fig. 12</ref>). With the hyper-parameters L = 7.0s and q = 90 correspond- ing to the highest accuracy on average over the 9 sequences and all the horizon values, our shallow network already has 65,700 parameters to learn. Similarly, it has been reported in <ref type="bibr" target="#b37">[38]</ref> that increasing the number of hidden units of a vanilla RNN with a single hidden layer trained to predict breathing signals using RTRL led to a decrease of the forecasting MAE. <ref type="figure" target="#fig_0">Fig. 10</ref> displays the nRMSE averaged over the 9 sequences, and the general aforementioned recommendations are not optimal for each sequence. Therefore, we recommend using crossvalidation to determine the best hyper-parameter set for each breathing record. The learning rate and SHL appear to be the most important hyper-parameters to tune <ref type="figure" target="#fig_0">(Fig. 11)</ref>. Appropriately selecting them resulted in a decrease of the mean cross-validation nRMSE of 18.2% (from 0.395 to 0.323) and 21.3% (from 0.417 to 0.329), respectively.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Influence of the hyper-parameters on prediction accuracy</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Time performance</head><p>UORO has a prediction time per time step equal to 2.8ms for 90 hidden neurons and an SHL of 9.0s, whereas RTRL requires 55ms to perform a single prediction using 55 hidden units with an SHL of 5.5s (Dell Intel Core i9-9900K 3.60GHz CPU 32Gb RAM with Matlab, <ref type="figure" target="#fig_0">Fig. 12</ref>). The complexity O(q 3 (q + L)) and resulting high computing time of RTRL is the reason why we performed cross-validation for RTRL with fewer hidden units and lower SHL values than UORO, which has a complexity O(q(q + L)) ( <ref type="table">Table 2</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Discussion</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Significance of our results relative to the dataset used</head><p>One drawback of our study is the number of sequences used and their duration, which are low in comparison with some other studies related to forecasting in radiotherapy (cf section 1.2 and <ref type="table">Table 4</ref>). Therefore, our numerical results might appear to lack a certain degree of confidence. However, the dataset used is representative of a large variety of breathing patterns including shifts, drifts, slow motion, sudden irregularities, as well as resting and non-perturbed motion. In addition, our results are consistent with previous studies that claim that linear prediction, linear adaptive filters, and ANNs achieve high performance respectively for low, intermediate, and high horizon values (cf section 3.1). The algorithms studied in our work are online algorithms that do not need a high amount of prior data for making accurate predictions, as demonstrated by the high performance that we achieved with only one minute of training. Because of the reasons mentioned above, we think that the results presented in our study have a significantly high level of confidence and would generalize well to larger datasets.</p><p>The online availability of the dataset used is a particular strength of our study, as it enables reproducibility of our results. Most of the previous studies about the prediction of breathing signals for radiotherapy rely on datasets that are not publicly available (cf section 1.2 and <ref type="table">Table 4</ref>), which makes performance comparison difficult.</p><p>Laughing and talking are situations where prediction is difficult, and are controlled in a clinical setting. However, evaluating performance with such difficult scenarios gives information about other situations that will sometimes happen during treatment, such as yawning, hiccuping, and coughing. Detecting these anomalies and turning off the irradiation beam when they occur is currently the standard clinical approach. Distinguishing between normal and irregular breathing enabled us to objectively study and quantify the robustness of the algorithms compared (cf <ref type="table">Table 3</ref> and Appendix D). Since irregular breathing sequences comprise almost half of our entire dataset, the numerical error measures aver-aged over the nine sequences should be higher than one can expect in more realistic scenarios.  <ref type="table">Table 2)</ref>. Each nRMSE measure is averaged over the 9 sequences and 50 runs. The black dotted curves correspond to the nRMSE minimum averaged over the horizon values between 0.1s and 2.0s, and the associated error bars correspond to its standard deviation over these horizon values. <ref type="table">Table 4</ref> compares the performance of UORO in our work with the results previously reported in the lit-erature. Comparison with the previous research is complex because the datasets are different. In particular, the frequency, amplitude, and regularity of the signals vary from study to study. Furthermore, the response  time, as well as the partition of the data into development and test set are usually arbitrarily selected, thus they also differ between the studies.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Comparison with previous works</head><p>The prediction errors in our research might appear relatively large, but this is due to the low sampling frequency (10Hz), the high amplitude of the breathing signals, and the high proportion of irregular patterns in our dataset (cf section 4.1). Furthermore, the breathing records that we use have a relatively low duration and therefore our RNN has fewer data available for training. When taking these circumstances into account, it appears that the errors reported in our study are consistent with the findings of the previous related works.</p><p>Our purpose is to examine the extent to which RNNs can efficiently learn to adaptively predict respiratory motion with little data. We do not aim to build a generalized model with a high amount of data. All the RNN-based models reported in <ref type="table">Table 4</ref> may benefit from adaptive retraining with UORO.</p><p>Teo et al. studied breathing records with a frequency of 7.5 Hz and reported lower errors using an MLP with one hidden layer trained first with backpropagation and retrained online <ref type="bibr" target="#b49">[50]</ref>. The RMSE that they achieved was 26% lower than that of UORO in our research. Our higher errors are partly due to the amplitude of the breathing signals in our dataset, which are approximately 3 times higher. Mafi et al. and Jiang et al. also reported similar but lower prediction errors using RTRL to train a 1-layer RNN <ref type="bibr" target="#b23">[24]</ref> and a 1-layer nonlinear auto-regressive exogenous model (NARX) <ref type="bibr" target="#b11">[12]</ref>, respectively. However, the former do not provide information concerning motion amplitude, and the latter use signals with amplitudes nearly twice lower and a higher sampling rate, equal to 30 Hz. Moreover, our results demonstrate that UORO has more benefits than RTRL in practice. The RMSE error that UORO achieved is approximately 2 to 4 times lower than the RMSEs reported by Sharp et al., who used a multilayer perceptron (MLP) with one hidden layer and breathing records of the same frequency (10Hz) with similar amplitudes <ref type="bibr" target="#b44">[45]</ref>. Furthermore, the nRMSE error of UORO in our work is approximately 1 to 2 times lower than those corresponding to the 3-layer MLP in the study of J?hl et al., even though they use breathing records with a relatively higher sampling frequency (25 Hz) and lower signal amplitudes. They claim that linear filters are the most appropriate to forecast respiratory motion, but our results indicate that this is true only when the response time is low with respect to the sampling frequency (Section 3.1). The RMSE that we found is within the range reported in the first study of Jiang et al., who predicted the position of an internal marker using an RNN with 1 hidden layer trained with BPTT with a higher frequency (30 Hz) <ref type="bibr" target="#b13">[14]</ref>.  <ref type="table">Table 4</ref>: Comparison of our work with some of the previous studies about time-series forecasting with ANNs for respiratory motion compensation in radiotherapy (cf Section 1.2). In this table, the term "RNN" designates a vanilla RNN, as opposed to LSTMs. "LSTM-FCL" or "RNN-FCL" designates a combination of LSTM/RNN layers and fully connected layers. A field with " -" indicates that the information is not available in the corresponding research article. The results corresponding to our study are the performance measures averaged over the horizon values between 0.1s and 2.0s in <ref type="table">Table 3</ref>. 9</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Conclusions</head><p>This is the first study about RNNs trained with UORO applied to the forecast of the position of external markers on the chest and abdomen for safe radiotherapy, to the extent of our knowledge. This method can mitigate the latency of treatment systems due to robot control and radiation delivery preparation. This will in turn help decrease irradiation to healthy tissues and avoid lung radiation therapy side effects such as radiation pneumonitis or pulmonary fibrosis. The dataset used and our code are accessible online <ref type="bibr" target="#b16">[17,</ref><ref type="bibr" target="#b28">29]</ref>. Online processing is suitable for breathing motion prediction during the radiotherapy treatment as it enables adaptation to each patient's individual respiratory patterns varying over time. Up to now, the only online learning algorithm for RNNs that has been evaluated in the context of respiratory motion prediction is RTRL <ref type="bibr" target="#b23">[24,</ref><ref type="bibr" target="#b37">38]</ref>, but UORO has the advantage of being much faster, as they respectively have a theoretical complexity of O(q 4 ) and O(q 2 ), where q is the number of hidden units. We derived an efficient implementation of UORO in the case of vanilla RNNs that uses closedform expressions for quantities appearing in the loss gradient calculation, in contrast to the original article <ref type="bibr" target="#b47">[48]</ref> describing UORO in the general case. We could efficiently train RNNs using only one minute of breathing data per sequence, as dynamic training can be implemented with limited data.</p><p>Most previous research in respiratory motion forecasting focused on univariate signals, but we undertook 3D marker position prediction, as it will help better estimate the 3D tumor motion via correspondence modeling. In addition, prediction was performed simultaneously for the three markers so that the RNN discovers and uses information from the correlation between their motion. We suggest using such multi-dimensional input and output framework (Eq. 5), as it may improve the 3D forecasting accuracy in comparison to independently predicting univariate coordinate signals as in <ref type="bibr" target="#b13">[14,</ref><ref type="bibr" target="#b11">12]</ref>. To the best of our knowledge, the com-parison of the different prediction filters in our study takes into consideration the most extensive range of response times h among the previous studies in the literature about respiratory motion prediction. Also, our study compares the highest number of forecasting quality metrics (MAE, RMSE, nRMSE, maximum error, and jitter) for each algorithm as h varies, among the works on breathing motion forecasting. Using different metrics helps better characterize the behavior of each algorithm.</p><p>UORO achieved the lowest prediction RMSE for horizon values h ? 0.6s, with an average value over 9 breathing sequences not exceeding 1.4mm. These sequences last from 73s to 222s, correspond to a sampling rate of 10Hz and marker position amplitudes varying from 6mm to 40mm in the SI direction. Moreover, UORO achieved the lowest maximum error for h ? 0.7s with an average value over the 9 sequences not exceeding 9.1mm. The average of the RMSE and maximum error over the sequences corresponding to regular breathing were respectively lower than 1.1mm and 7.7mm. The nRMSE of UORO only increased by 10.6% when performing the evaluation with the sequences corresponding to irregular breathing instead of regular breathing, which indicates good robustness to sudden changes in respiratory patterns. The calculation time per time step of UORO is equal to 2.8ms for 90 hidden units and an SHL of 9.0s (Dell Intel Core i9-9900K 3.60GHz CPU 32Gb RAM with Matlab). UORO has a much better time performance than RTRL, whose calculation time per time step is equal to 55.2ms for 55 hidden units and an SHL of 5.5s.</p><p>Linear regression was the most efficient prediction algorithm for low look-ahead time values, with an RMSE lower than 0.9mm for h ? 0.2s. LMS gave the best prediction results for intermediate look-ahead values, with an RMSE lower than 1.2mm for h ? 0.5s. These observations regarding the influence of the horizon agree with those in <ref type="bibr" target="#b50">[51]</ref>. The errors reported in our study may be higher than in clinical scenarios due to the relatively high proportion of records corresponding to irregular breathing in our dataset.</p><p>Gradient clipping was used to ensure numerical stability and we selected a clipping threshold ? = 2.0. The learning rate and SHL were the hyper-parameters with the strongest influence on the prediction performance of UORO. To the best of our knowledge, our work is the first to examine the influence of the horizon on hyper-parameter optimization among the works about respiratory motion forecasting during radiotherapy. Concerning UORO, we found that a learning rate ? = 0.1 and SHL of 7.0s gave the best results on average, except with high horizon values close to h = 2.0s, for which a higher learning rate ? = 0.2 and lower SHL of 5.0s led to better performance. The prediction error decreased as the number of hidden units increased. That fact has also been observed previously with RTRL in the context of respiratory motion forecasting <ref type="bibr" target="#b37">[38]</ref>.</p><p>LSTM networks or gated recurrent units (GRUs) could be used instead of a vanilla RNN structure, as that could lead to higher prediction accuracy. Furthermore, UORO could be used to dynamically retrain in real-time the last hidden layer of a deep RNN that predicts respiratory waveform signals, as a form of transfer learning. This could improve the robustness of that RNN to unseen examples corresponding to irregular breathing patterns. Moreover, tumor position forecasting in lung radiotherapy will benefit from the development of new efficient online learning algorithms for deep RNNs. Using more data acquired from other institutions or synthesized via generative models <ref type="bibr" target="#b36">[37]</ref> may be beneficial to subsequent studies.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A.1 Calculation of ? x L n+1</head><p>In this section we compute the quantity 10 :</p><formula xml:id="formula_16">?L n+1 ?x = ?L n+1 ?y ?Fout ?x<label>(18)</label></formula><p>We recall that en = y * n ? yn where y * n is the exact signal and yn the predicted signal. We compute first the left factor: </p><formula xml:id="formula_17">?L n+1 ?y = ? ?y 1 2 e T n+1 e n+1<label>(19)</label></formula><p>= e T n+1 (?Ip) </p><formula xml:id="formula_19">= ?e T n+1<label>(21)</label></formula><p>We have proven the formula for ?xL n+1 appearing in line 19 of Algorithm 1.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A.2 Calculation of ??</head><p>In this section, we compute the quantity:</p><formula xml:id="formula_22">?? = ?L n+1 ?y ?Fout ??<label>(25)</label></formula><p>The left factor has already been computed previously (Eq. 22). What remains to compute is the right factor. We write the parameter (line) vector as: ) is a line vector containing the elements of Wa,n (resp. W b,n , Wc,n). We thus have: ). We have Fout(xn, ?n) = y n+1 = Wc,nxn (Eqs. 1 and 7), so the k th component of Fout(xn, ?n) is simply calculated as: </p><formula xml:id="formula_23">?n = [W</formula><formula xml:id="formula_24">?? = ?e T n+1 0 1?(|?|?pq) , ?Fout ?W unrolled c,n<label>(27)</label></formula><formula xml:id="formula_25">y n+1,k = q l=1 W k,l c,n x n,l<label>(29)</label></formula><formula xml:id="formula_26">?y n+1,k ?W i,j c,n = x n,j if k = i 0 otherwise<label>(30)</label></formula><p>Therefore:</p><formula xml:id="formula_27">e T n+1 ?Fout ?W i,j c,n = e T n+1 ? ? ? ? ? ? ? ? 0 . . . x n,j . . . 0 ? ? ? ? ? ? ? ? ? i th row (31) = e n+1,i x n,j<label>(32)</label></formula><p>This can be rewritten as: </p><p>Therefore: </p><p>We plug this expression into Eq. 28 to obtain finally: ?? = [0 1?(|?|?pq) , reshape(?e n+1 x T n , 1 ? pq)]</p><p>This justifies the update of ?? in line 18 of Algorithm 1 11 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A.3 Calculation of ?? g</head><p>In this section, we detail the calculation of the following quantity: ??g = ? T ?Fst ?? <ref type="bibr" target="#b35">(36)</ref> In this equation, ? represents a column vector of size q with random values in {?1, 1} (cf line 20 of Algorithm 1). Fst(xn, un, ?n) does not depend on the quantity Wc,n so we can write: </p><formula xml:id="formula_31">??g = ? T ?Fst ?W unrolled a,</formula><p>We focus first on the calculation of the component ? T ?Fst/?W unrolled a,n . We recall that ? is the non-linear activation function defined in Eq. 8 and we define zn as the following column vector:</p><formula xml:id="formula_33">zn = Wa,nxn + W b,n un<label>(39)</label></formula><p>The state equation can be rewritten as:</p><p>Fst(xn, un, ?n) = ?(zn)</p><p>We select (i, j) ? [[1, ..., q]] 2 . We deduce from the previous equation that: </p><p>The calculation of the left factor directly comes from the definition of ? in Eq. 8:</p><formula xml:id="formula_36">?? ?z = ? ? ? ? (z n,1 ) 0 . . . 0 ? (zn,q) ? ? ?<label>(42)</label></formula><p>The right factor can simply be calculated using an approach similar to that leading to Eq. 30:</p><formula xml:id="formula_37">?zn ?W i,j a,n = ? ? ? ? ? ? ? ? 0 . . . x n,j . . . 0 ? ? ? ? ? ? ? ? ? i th row<label>(43)</label></formula><p>Eq. 41 can thus be rewritten as: </p><p>Using Eq. 45, we can compute it the following way: </p><p>where * refers to element-wise multiplication. We can finally compute the quantity ? T ?Fst/?W unrolled a,n appearing in Eq. 38 as: </p><p>= [x n,1 (? * ? (zn)) T , ..., xn,q(? * ? (zn)) T ]</p><p>= reshape x n,1 (? * ? (zn)), ..., xn,q(? * ? (zn)) , 1 ? q 2</p><p>= reshape (? * ? (zn))x T n , 1 ? q 2</p><p>The reshaping operation, which was also used in Eq. 35, enables writing expressions with simple matrix operations that can be quickly performed with appropriate linear algebra libraries. In a similar way, we can compute the quantity To summarize, we can compute the quantity ??g using Eqs. 38, 55 and 56. The quantity ?? aux g = ? * ? (zn) appears both in Eqs. 55 and 56 so it can be computed beforehand to improve time performance. In this section, we justified the lines 22, 23, and 24 in Algorithm 1.   </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 :</head><label>1</label><figDesc>Radiotherapy treatment system (Cyberknife) using external markers to guide the irradiation beam 1 .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 2 :</head><label>2</label><figDesc>Time scope of our study, both from the radiotherapy application perspective and the algorithmic research perspective</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>e n = y * n ? y n L n = 1 2 e n 2 2 ( 2 )Fig. 4 :</head><label>224</label><figDesc>By using the chain rule, one can derive Eqs. 3 and 4, which describe how changes of the parameter vector Structure of the RNN predicting the positions of the markers. The input vector u n corresponds to the positions in the past and the output vector y n+1 corresponds to the predicted positions 4 .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig. 5 :</head><label>5</label><figDesc>Weak alignment of the gradients of UORO with those of RTRL from the loss optimization viewpoint.<ref type="bibr" target="#b4">5</ref> </figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig. 6 :</head><label>6</label><figDesc>Forecasting a 1D position signal. The signal history length L is the time interval in the past, the information of which is used for performing one prediction. The horizon h, also called response time or look-ahead time, is the time interval in advance for which the prediction is made (cf Eq. 5).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>2 :</head><label>2</label><figDesc>Overview of the different forecasting methods compared in this study. The input vector u n , corresponding to the positions in the past, and the output vector y n+1 , corresponding to the predicted positions, which appear in the second column, are defined in Eq. 5. The fourth column describes the hyper-parameter range for crossvalidation with grid search. ? refers to the learning rate, ? init to the standard deviation of the initial Gaussian distribution of the synaptic weights, L to the SHL (expressed in number of time steps), and q to the number of hidden units. W n and W are matrices used respectively in LMS and linear regression, and their size is p ? (m + 1).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig. 7 :</head><label>7</label><figDesc>Forecasting performance of each algorithm as a function of the prediction horizon. Each point corresponds to the average of one performance measure of the test set across the 9 sequences.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Fig. 8 :</head><label>8</label><figDesc>Prediction performance of each algorithm in terms of nRMSE and jitter. Each point corresponds to the mean of the nRMSE and jitter of a given algorithm of the test set over the regular or irregular breathing sequences for a single horizon value. Datapoints corresponding to linear regression with high horizon values have not been displayed for readability as they correspond to high nRMSE values.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>( a )Fig. 9 :</head><label>a9</label><figDesc>Prediction with an RNN trained with UORO (b) Prediction with an RNN trained with RTRL (c) Prediction with LMS Comparison between RTRL, UORO, and LMS regarding the prediction of the position of the z coordinate (spine axis) of marker 3 in sequence 1 (person talking)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Fig. 10 :</head><label>10</label><figDesc>(a) Prediction nRMSE of the cross-validation set as a function of the learning rate(b) Prediction nRMSE of the cross-validation set as a function of the standard deviation of the Gaussian distribution of the initial synaptic weights (c) Prediction nRMSE of the cross-validation set as a function of the signal history length (d) Prediction nRMSE of the cross-validation set as a function of the number of hidden units Prediction nRMSE of UORO of the cross-validation set as a function of each RNN hyper-parameter, for different horizon values. Given one hyper-parameter, each color point of the associated graph corresponds to the minimum of the nRMSE over every possible combination of the other hyper-parameters in the cross-validation range (</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head>Fig. 11 :</head><label>11</label><figDesc>Standard deviation of the nRMSE of the crossvalidation set (black dotted curves in Fig. 10) for each hyper-parameter. A hyper-parameter corresponding to a high standard deviation value has a high influence on the prediction error.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12"><head>Fig. 12 :</head><label>12</label><figDesc>Calculation time (Dell Intel Core i9-9900K 3.60GHz CPU 32Gb RAM with Matlab)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_15"><head>=</head><label></label><figDesc>x n,j [? 1 ? (z n,1 ), ..., ?q? (zn,q)] (50)= x n,j [? * ? (zn)] T</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_16"><head></head><label></label><figDesc>? * ? (zn))u T n , 1 ? q(m + 1)<ref type="bibr" target="#b55">(56)</ref> </figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_17"><head>BFig. 13 :</head><label>13</label><figDesc>Appendix : Predicted motion for sequence 5 (regular breathing) (a) Prediction with an RNN trained with UORO (b) Prediction with an RNN trained with RTRL (c) Prediction with LMS Comparison between RTRL, UORO, and LMS regarding the prediction of the position of the z coordinate (spine axis) of marker 3 in sequence 5 (normal breathing) D Appendix : Prediction performance for regular and irregular breathing sequences</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_18"><head>Fig. 15 :</head><label>15</label><figDesc>Forecasting performance of each algorithm as a function of the prediction horizon. Each point corresponds to the average of one performance measure of the test set across the sequences associated with regular breathing.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_19"><head>Fig. 16 :</head><label>16</label><figDesc>Forecasting performance of each algorithm as a function of the prediction horizon. Each point corresponds to the average of one performance measure of the test set across the records associated with irregular breathing.<ref type="bibr" target="#b11">12</ref> </figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head></head><label></label><figDesc>Previous ANN models proposed for respiratory motion prediction in radiotherapy. The term "RNN" here designates a vanilla RNN, as opposed to LSTMs and gated recurrent units (GRU).<ref type="bibr" target="#b1">2</ref> </figDesc><table><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>? Chang et al.</cell></row><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>5-layer TCN</cell></row><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>? J?hl et al.</cell><cell>? Lee et al.</cell></row><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>3-layer MLP</cell><cell>1-layer LSTM</cell></row><row><cell></cell><cell></cell><cell></cell><cell>? Jiang et al.</cell><cell>? Jiang et al.</cell><cell></cell><cell>&amp; 1 FCL</cell></row><row><cell></cell><cell>? Krauss et al.</cell><cell></cell><cell>1-layer RNN</cell><cell>1-layer NARX</cell><cell>? Mafi and</cell><cell></cell></row><row><cell>? Sharp et al., 1-layer MLP</cell><cell>1-layer MLP</cell><cell></cell><cell></cell><cell></cell><cell>Moghadam</cell><cell>? Pohl et al.</cell></row><row><cell></cell><cell></cell><cell></cell><cell>? Teo et al.</cell><cell>? Lin et al.</cell><cell>(RNN trained</cell><cell>(RNN trained</cell></row><row><cell>? Goodband et al.</cell><cell>? Lee et al., 1-layer RNN</cell><cell></cell><cell>1-layer MLP</cell><cell>3-layer LSTM</cell><cell>with RTRL)</cell><cell>with RTRL)</cell></row><row><cell>1-layer MLP</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>? Lee et al., RNN -FCL</cell><cell></cell><cell>? Wang et al.</cell><cell>? Yun et al.</cell><cell>? Yu et al.</cell><cell>? Wang et al.</cell></row><row><cell>? Murphy and Pokhrel</cell><cell></cell><cell>? Sun et al.</cell><cell>7-layer bi-</cell><cell>2-layer LSTM</cell><cell>3-layer bi-</cell><cell>2-layer LSTM</cell></row><row><cell>1-layer MLP</cell><cell>? Choi et al., 3-layer MLP</cell><cell>1-layer MLP</cell><cell>LSTM</cell><cell>&amp; 1 FCL</cell><cell>GRU</cell><cell>&amp; 2 FCLs</cell></row><row><cell>2004 -2009</cell><cell>2010 -2015</cell><cell>2017</cell><cell>2018</cell><cell>2019</cell><cell>2020</cell><cell>2021</cell></row><row><cell></cell><cell></cell><cell></cell><cell>Adaptive training</cell><cell></cell><cell>Online learning</cell><cell></cell></row><row><cell></cell><cell></cell><cell></cell><cell>methods</cell><cell></cell><cell cols="2">algorithms for RNNs</cell></row><row><cell cols="7">Michel UESAKA /TAKAHASHI lab. M?me figure v2 26/07/2021 UESAKA /TAKAHASHI lab. 26/07/2021 TUMOR POSITION PREDICTION USING DYNAMICALLY TRAINED RECURRENT NEURAL TUMOR POSITION PREDICTION USING DYNAMICALLY TRAINED RECURRENT NEURAL NETWORKS FOR LATENCY COMPENSATION IN LUNG CANCER RADIOTHERAPY ? Jaderberg et al. Decoupled Neural Interfaces ? Tallec and Ollivier Anticipated Reweighted Truncated Backpropagation ? Tallec and Ollivier Unbiased Online Recurrent Optimization (UORO) ? Benzing et al. r-Optimal Kronecker-sum approximation ? Murray Random-Feedback Online Learning NETWORKS FOR LATENCY COMPENSATION IN LUNG CANCER RADIOTHERAPY ? Aicher et al. PH.D. THESIS DEFENSE PH.D. THESIS DEFENSE Adaptively truncated BPTT ? Bohnstingl et al. Online Spatio-Temporal Learning ? Marschall et al. Reverse KF-RTRL Efficient BPTT Future-facing BPTT ? Menick et al. Sparse n-Step Approximation ? Mujika et al. Kronecker-Factored RTRL ? Roth et al. Kernel RNN learning ? Williams and Zipser Real-Time Recurrent Learning (RTRL) ? Williams and Peng Truncated Back-Propagation Through Time (BPTT) Online learning algorithms for RNNs applied to tumor position prediction in radiotherapy M?me figure v3 (a) POHL Michel 2020 2019 2017 1989 -1990 2018 2015</cell><cell>3 6</cell></row></table><note>? Ollivier et al. NoBackTrack</note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 1 :</head><label>1</label><figDesc>Nb. of runs for cross-val. n cv = 50 Nb. of runs for evaluation n test = 300 Configuration of the RNN forecasting the motion of the external markers. n M refers to the number of external markers and L to the SHL.</figDesc><table><row><cell>Output layer size</cell><cell>p = 3n M</cell></row><row><cell>Input layer size</cell><cell>m = 3n M L</cell></row><row><cell>Number of hidden layers</cell><cell>1</cell></row><row><cell>Size of the hidden layer</cell><cell>q</cell></row><row><cell>Activation function ?</cell><cell>Hyperbolic tangent</cell></row><row><cell>Training algorithm</cell><cell>RTRL or UORO</cell></row><row><cell>Optimization method</cell><cell>Stochastic grad. descent</cell></row><row><cell></cell><cell>with gradient clipping</cell></row><row><cell>Weights initialization</cell><cell>Gaussian</cell></row><row><cell cols="2">Input data normalization Yes (online)</cell></row><row><cell>Cross-validation metric</cell><cell>RMSE (Eq. 10)</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head></head><label></label><figDesc>). Indeed, each realization of the random variable e i,h depends on the run index r ? [[1, ..., n test ]], and we denote that value e</figDesc><table><row><cell>(r) i,h . This enables calculating</cell></row><row><cell>the 95% confidence interval [</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head></head><label></label><figDesc>The mean of the error e i,h over a subset I ? [[1, ..., 9]] of the 9 sequences 7 and h ? H = {h min , ..., h max }, denoted by e I , follows a Gaussian distribution with mean ? I . The half-range of the 95% confidence interval for ? I , denoted by ?? I , can be calculated according to Eq. 17. ?(W a,n x n + W b,n u n ) Training 30s ? ? {0.05, 0.1, 0.2} UORO y n = W c,n x n Cross-validation 30s ? init ? {0.02, 0.05} L ? {10, 30, 50, 70, 90} q ? {10, 30, 50, 70, 90} RNN x n+1 = ?(W a,n x n + W b,n u n ) Training 30s ? ? {0.02, 0.05, 0.1, 0.2} RTRL y n = W c,n x n Cross-validation 30s ? init ? {0.01, 0.02, 0.05}</figDesc><table><row><cell cols="2">Prediction Mathematical</cell><cell>Development set</cell><cell>Range of hyper-parameters</cell></row><row><cell>method</cell><cell>model</cell><cell>partition</cell><cell>for cross-validation</cell></row><row><cell>RNN</cell><cell cols="3">x n+1 = L ? {10, 25, 40, 55}</cell></row><row><cell></cell><cell></cell><cell></cell><cell>q ? {10, 25, 40, 55}</cell></row><row><cell>LMS</cell><cell>y n+1 = W n u n</cell><cell>Training 30s</cell><cell>? ? {0.002, 0.005, 0.01,</cell></row><row><cell></cell><cell></cell><cell>Cross-validation 30s</cell><cell>0.02, 0.05, 0.1, 0.2}</cell></row><row><cell></cell><cell></cell><cell></cell><cell>L ? {10, 30, 50, 70, 90}</cell></row><row><cell>Linear</cell><cell>y n+1 = W u n</cell><cell>Training 54s</cell><cell>L ? {10, 20, 30, 40, 50,</cell></row><row><cell>regression</cell><cell></cell><cell>Cross-validation 6s</cell><cell>60, 70, 80, 90}</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5"><head>Table</head><label></label><figDesc></figDesc><table /><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6"><head></head><label></label><figDesc>51] (cf section 1.2).</figDesc><table><row><cell>Error</cell><cell>Prediction</cell><cell>Average over</cell><cell>Regular</cell><cell>Irregular</cell></row><row><cell>type</cell><cell>method</cell><cell>the 9 sequences</cell><cell>breathing</cell><cell>breathing 8</cell></row><row><cell>MAE</cell><cell>RNN UORO</cell><cell>0.845 ? 0.001</cell><cell>0.674 ? 0.001</cell><cell>0.916 ? 0.001</cell></row><row><cell>(in mm)</cell><cell>RNN RTRL</cell><cell>0.834 ? 0.002</cell><cell>0.684 ? 0.002</cell><cell>0.973 ? 0.003</cell></row><row><cell></cell><cell>LMS</cell><cell>0.957</cell><cell>0.907</cell><cell>1.18</cell></row><row><cell></cell><cell>Lin. regression</cell><cell>4.45</cell><cell>3.23</cell><cell>6.57</cell></row><row><cell></cell><cell>No prediction</cell><cell>3.27</cell><cell>2.89</cell><cell>3.43</cell></row><row><cell>RMSE</cell><cell>RNN UORO</cell><cell>1.275 ? 0.001</cell><cell>1.030 ? 0.001</cell><cell>1.505 ? 0.002</cell></row><row><cell>(in mm)</cell><cell>RNN RTRL</cell><cell>1.419 ? 0.005</cell><cell>1.119 ? 0.004</cell><cell>1.721 ? 0.005</cell></row><row><cell></cell><cell>LMS</cell><cell>1.370</cell><cell>1.247</cell><cell>1.818</cell></row><row><cell></cell><cell>Lin. regression</cell><cell>6.089</cell><cell>4.454</cell><cell>9.164</cell></row><row><cell></cell><cell>No prediction</cell><cell>4.243</cell><cell>3.952</cell><cell>4.461</cell></row><row><cell>nRMSE</cell><cell>RNN UORO</cell><cell>0.2824 ? 0.0002</cell><cell>0.2868 ? 0.0004</cell><cell>0.3211 ? 0.0004</cell></row><row><cell>(no unit)</cell><cell>RNN RTRL</cell><cell>0.3027 ? 0.0007</cell><cell>0.2914 ? 0.0008</cell><cell>0.3688 ? 0.0010</cell></row><row><cell></cell><cell>LMS</cell><cell>0.3116</cell><cell>0.2987</cell><cell>0.4198</cell></row><row><cell></cell><cell>Lin. regression</cell><cell>1.411</cell><cell>1.181</cell><cell>2.132</cell></row><row><cell></cell><cell>No prediction</cell><cell>0.9312</cell><cell>1.006</cell><cell>0.9833</cell></row><row><cell>Max error</cell><cell>RNN UORO</cell><cell>8.81 ? 0.01</cell><cell>7.20 ? 0.02</cell><cell>12.34 ? 0.02</cell></row><row><cell>(in mm)</cell><cell>RNN RTRL</cell><cell>11.68 ? 0.04</cell><cell>10.01 ? 0.04</cell><cell>14.56 ? 0.06</cell></row><row><cell></cell><cell>LMS</cell><cell>9.31</cell><cell>8.59</cell><cell>12.9</cell></row><row><cell></cell><cell>Lin. regression</cell><cell>30.6</cell><cell>23.2</cell><cell>49.0</cell></row><row><cell></cell><cell>No prediction</cell><cell>14.8</cell><cell>13.9</cell><cell>18.2</cell></row><row><cell>Jitter</cell><cell>RNN UORO</cell><cell>0.9672 ? 0.0004</cell><cell>0.7778 ? 0.0002</cell><cell>0.9973 ? 0.0007</cell></row><row><cell>(in mm)</cell><cell>RNN RTRL</cell><cell>0.7532 ? 0.0015</cell><cell>0.6494 ? 0.0012</cell><cell>0.8735 ? 0.0014</cell></row><row><cell></cell><cell>LMS</cell><cell>1.596</cell><cell>1.646</cell><cell>1.724</cell></row><row><cell></cell><cell>Lin. regression</cell><cell>0.7767</cell><cell>0.6011</cell><cell>1.078</cell></row><row><cell></cell><cell>No prediction</cell><cell>0.4395</cell><cell>0.3877</cell><cell>0.5045</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_9"><head></head><label></label><figDesc>By combining Eqs. 22 and 23, we can rewrite Eq. 18 as:</figDesc><table><row><cell></cell><cell cols="3">Furthermore, is straightforward that:</cell></row><row><cell></cell><cell cols="2">?Fout ?x</cell><cell>= Wc,n</cell><cell>(23)</cell></row><row><cell></cell><cell>?L n+1 ?x</cell><cell cols="2">= ?e T n+1 Wc,n</cell></row><row><cell>?l t+1</cell><cell>?F out</cell><cell></cell></row><row><cell>?o</cell><cell>?s</cell><cell></cell></row></table><note>10 Note: with the notations of Tallec et al., Eq. 18 can be rewritten as: ?s =</note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_12"><head></head><label></label><figDesc>Thus, for (i, j) ? [[1, ..., p]] ? [[1, ..., q]], we have:</figDesc><table /><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_15"><head></head><label></label><figDesc>We define for j ? [[1, ..., q]] the following matrix:</figDesc><table><row><cell>?Fst ?W i,j a,n</cell><cell>=</cell><cell>? ? ? ? ? ? ? ? ? ?</cell><cell>? (z n,1 ) 0</cell><cell cols="2">. . .</cell><cell cols="2">. . .</cell><cell>. . .</cell><cell cols="3">0 ? (zn,q) ? ? ? ? ? ? ? ? ? ?</cell><cell>? ? ? ? ? ? ? ?</cell><cell>0 0 . . . x n,j . . .</cell><cell>? ? ? ? ? ? ? ?</cell><cell>? i th row</cell></row><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>(44)</cell></row><row><cell></cell><cell></cell><cell>?</cell><cell>0</cell><cell></cell><cell></cell><cell>?</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>=</cell><cell>? ? ? ? ? ? ?</cell><cell cols="3">. . . (z n,i )x n,j . . .</cell><cell>? ? ? ? ? ? ?</cell><cell cols="4">? i th row</cell><cell></cell><cell>(45)</cell></row><row><cell></cell><cell></cell><cell></cell><cell>0</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell></cell><cell cols="2">?Fst ?W j a,n</cell><cell cols="2">=</cell><cell cols="3">?Fst ?W 1,j a,n</cell><cell>, ...,</cell><cell cols="2">?Fst ?W q,j a,n</cell></row><row><cell>)]</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row></table><note>11 Note: with the notations of Tallec et al., Eqs. 25 and 35 can be rewritten as: ?? = (?l t+1 /?o)(?Fout/??) = [0 1?(|?|?pq) , reshape(e t+1 s Tt , 1 ? pq?</note></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="4">Reprinted from<ref type="bibr" target="#b37">[38]</ref>, Copyright 2021, with permission from Elsevier.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="6">We write ? i,h instead of ? i,h and ? i,h instead of ? i,h to designate estimators of these parameters given the ntest runs.<ref type="bibr" target="#b6">7</ref> When I is the set [[1, ...,<ref type="bibr" target="#b8">9]</ref>], the confidence intervals calculated are those associated with the 9 records. Otherwise, we select I as the set of indexes associated with the regular or irregular breathing sequences.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="9">RPM stands for "real-time position management". See also footnote 2.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="12">Sequence 201205111057-LACLARUAR-3-O-72 (cf<ref type="bibr" target="#b17">[18]</ref>) has been removed from the sequences associated with abnormal respiratory motion for plotting the performance graphs, as that sequence does not contain abrupt or sudden motion that typically makes forecasting difficult.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgments</head><p>We thank Prof. Masaki Sekino, Prof. Ichiro Sakuma, and Prof. Hitoshi Tabata (The University of Tokyo, Graduate School of Engineering) for their insightful comments that helped improve the quality of this research. We also thank Dr. Stephen Wells (Nikon) who proofread the article.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Ethical approval</head><p>The authors did not perform experiments involving human participants or animals.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>This research did not receive any specific grant from funding agencies in the public, commercial, or not-forprofit sectors.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Declaration of competing interests</head><p>The authors declare that they have no conflict of interest.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>A Appendix : Notes on the derivation of UORO for standard RNNs The derivation of UORO for RNNs in the general case is described in <ref type="bibr" target="#b47">[48]</ref>. In this section, we provide details concerning the calculation of several quantities involved in the computation of the loss gradient ? ? Ln in the case of vanilla RNNs defined by Eqs. 6 and 7. </p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Adaptively truncating backpropagation through time to control gradient bias</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Aicher</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J</forename><surname>Foti</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">B</forename><surname>Fox</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Uncertainty in Artificial Intelligence, PMLR</title>
		<imprint>
			<date type="published" when="2020" />
			<biblScope unit="page" from="799" to="808" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Model-free cardiorespiratory motion prediction from X-ray angiography sequence with LSTM network</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Azizmohammadi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Martin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Miro</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Duong</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">41st Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC)</title>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2019" />
			<biblScope unit="page" from="7014" to="7018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Optimal kronecker-sum approximation of real time recurrent learning</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Benzing</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">M</forename><surname>Gauy</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Mujika</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Martinsson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Steger</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Machine Learning, PMLR</title>
		<imprint>
			<date type="published" when="2019" />
			<biblScope unit="page" from="604" to="613" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title level="m" type="main">Online spatio-temporal learning in deep neural networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Bohnstingl</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Wo?niak</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Maass</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Pantazi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Eleftheriou</surname></persName>
		</author>
		<idno>arXiv:200712723</idno>
		<imprint>
			<date type="published" when="2020" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Realtime respiratory tumor motion prediction based on a temporal convolutional neural network: Prediction model development study</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Chang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Dang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Dai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Sun</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Medical Internet Research</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page">27235</biblScope>
			<date type="published" when="2021" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Performance enhancement of respiratory tumor motion prediction using adaptive support vector regression: Comparison with adaptive neural network method</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Choi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Chang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Kim</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">H</forename><surname>Park</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">Y</forename><surname>Song</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><forename type="middle">S</forename><surname>Kang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">International journal of imaging systems and technology</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="8" to="15" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title level="m" type="main">4D modeling and estimation of respiratory motion for radiation therapy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Ehrhardt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Lorenz</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2013" />
			<publisher>Springer</publisher>
			<biblScope unit="volume">10</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">A respiratory motion prediction method based on improved relevance vector machine</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Q</forename><surname>Fan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Yu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Zhao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Yu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mobile Networks and Applications</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="2270" to="2279" />
			<date type="published" when="2020" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">A comparison of neural network approaches for on-line prediction in IGRT</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">H</forename><surname>Goodband</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">O</forename><forename type="middle">C</forename><surname>Haas</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Mills</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical physics</title>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="1113" to="1122" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Decoupled neural interfaces using synthetic gradients</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Jaderberg</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><forename type="middle">M</forename><surname>Czarnecki</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Osindero</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">O</forename><surname>Vinyals</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Graves</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Silver</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Kavukcuoglu</surname></persName>
		</author>
		<idno>PMLR</idno>
	</analytic>
	<monogr>
		<title level="m">International Conference on Machine Learning</title>
		<imprint>
			<date type="published" when="2017" />
			<biblScope unit="page" from="1627" to="1635" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Jaeger</surname></persName>
		</author>
		<title level="m">Tutorial on training recurrent neural networks, covering BPPT, RTRL, EKF and the &quot;echo state network&quot; approach</title>
		<imprint>
			<date type="published" when="2002" />
			<biblScope unit="volume">5</biblScope>
		</imprint>
		<respStmt>
			<orgName>GMD-Forschungszentrum Informationstechnik Bonn</orgName>
		</respStmt>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Prediction of lung tumor motion using nonlinear autoregressive model with exogenous input</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Jiang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Fujii</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Shiinoki</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Physics in Medicine &amp; Biology</title>
		<imprint>
			<biblScope unit="volume">64</biblScope>
			<biblScope unit="issue">21</biblScope>
			<biblScope unit="page" from="21" to="23" />
			<date type="published" when="2019" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Performance comparison of prediction filters for respiratory motion tracking in radiotherapy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>J?hl</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Ehrbar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Guckenberger</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Kl?ck</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Meboldt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Zeilinger</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Tanadini-Lang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Schmid</forename><surname>Daners</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical physics</title>
		<imprint>
			<biblScope unit="volume">47</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="643" to="650" />
			<date type="published" when="2020" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Prediction of lung tumor motion based on recurrent neural network</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Kai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Fujii</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Shiinoki</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE International Conference on Mechatronics and Automation (ICMA)</title>
		<meeting><address><addrLine>In</addrLine></address></meeting>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2018" />
			<biblScope unit="page" from="1093" to="1099" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Demystifying Cyberknife stereotactic body radiation therapy for interventional radiologists</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Khankan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Althaqfi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Arab Journal of Interventional Radiology</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page">55</biblScope>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">The comparative performance of four respiratory motion predictors for real-time tumour tracking</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Krauss</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Nill</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">U</forename><surname>Oelfke</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Physics in Medicine &amp; Biology</title>
		<imprint>
			<biblScope unit="volume">56</biblScope>
			<biblScope unit="issue">16</biblScope>
			<biblScope unit="page">5303</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
		<title level="m" type="main">Predicting respiratory motion for real-time tumour tracking in radiotherapy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Krilavicius</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Zliobaite</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Simonavicius</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Jarusevicius</surname></persName>
		</author>
		<idno>1508. 00749</idno>
		<imprint>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Predicting respiratory motion for real-time tumour tracking in radiotherapy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Krilavicius</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Zliobaite</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Simonavicius</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Jaruevicius</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE 29th International Symposium on Computer-Based Medical Systems (CBMS)</title>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2016" />
			<biblScope unit="page" from="7" to="12" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Geometric and dosimetric verification of a recurrent neural network algorithm to compensate for respiratory motion using an articulated robotic couch</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">S</forename><surname>Cho</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Jeong</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Kwak</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Jung</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">S</forename><surname>Kim</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">M</forename><surname>Yoon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">Y</forename><surname>Song</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Lee</forename><surname>Sw</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the Korean Physical Society</title>
		<imprint>
			<biblScope unit="volume">78</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="64" to="72" />
			<date type="published" when="2021" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<monogr>
		<title level="m" type="main">Prediction and classification of respiratory motion</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">J</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Motai</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2014" />
			<publisher>Springer</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Respiratory motion estimation with hybrid implementation of extended Kalman filter</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">J</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Motai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Murphy</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Industrial Electronics</title>
		<imprint>
			<biblScope unit="volume">59</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="4421" to="4432" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Customized prediction of respiratory motion with clustering from multiple patient interaction</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">J</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Motai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Weiss</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">S</forename><surname>Sun</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ACM Transactions on Intelligent Systems and Technology (TIST)</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="1" to="17" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Towards real-time respiratory motion prediction based on long short-term memory neural networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Shi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">F</forename><surname>Chan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Tang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ji</forename><forename type="middle">W</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Physics in Medicine &amp; Biology</title>
		<imprint>
			<biblScope unit="volume">64</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page">85010</biblScope>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Real-time prediction of tumor motion using a dynamic neural network</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Mafi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">M</forename><surname>Moghadam</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical &amp; biological engineering &amp; computing</title>
		<imprint>
			<biblScope unit="volume">58</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="529" to="539" />
			<date type="published" when="2020" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">A unified framework of online learning algorithms for training recurrent neural networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">O</forename><surname>Marschall</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Cho</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Savin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Machine Learning Research</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">135</biblScope>
			<biblScope unit="page" from="1" to="34" />
			<date type="published" when="2020" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">Y</forename><surname>Mass?</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Ollivier</surname></persName>
		</author>
		<idno>arXiv:200505645</idno>
		<title level="m">Convergence of online adaptive and recurrent optimization algorithms</title>
		<imprint>
			<date type="published" when="2020" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Respiratory motion models: a review</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">R</forename><surname>Mcclelland</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">J</forename><surname>Hawkes</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Schaeffter</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">P</forename><surname>King</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical image analysis</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="19" to="42" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
		<title level="m" type="main">A practical sparse approximation for real time recurrent learning</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Menick</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Elsen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">U</forename><surname>Evci</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Osindero</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Simonyan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Graves</surname></persName>
		</author>
		<idno>arXiv:200607232</idno>
		<imprint>
			<date type="published" when="2020" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b28">
	<monogr>
		<title level="m" type="main">Time series forecasting with UORO, RTRL, LMS, and linear regression: Fourth release</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Michel</surname></persName>
		</author>
		<idno type="DOI">10.5281/zenodo.5506964</idno>
		<ptr target="https://doi.org/10.5281/zenodo.5506964" />
		<imprint>
			<date type="published" when="2022" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<monogr>
		<title level="m" type="main">Approximating real-time recurrent learning with random kronecker factors</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Mujika</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Meier</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Steger</surname></persName>
		</author>
		<idno>arXiv:180510842</idno>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">Optimization of an adaptive neural network to predict breathing</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">J</forename><surname>Murphy</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Pokhrel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical physics</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="40" to="47" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<monogr>
		<title level="m" type="main">Local online learning in recurrent networks with random feedback</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">M</forename><surname>Murray</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2019" />
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page">43299</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">Mohammadi M (2020) Respiratory motion prediction using deep convolutional long short-term memory network</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Nabavi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Abdoos</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">E</forename><surname>Moghaddam</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Medical Signals and Sensors</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page">69</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<monogr>
		<title level="m" type="main">Cancer stat facts: Lung and bronchus cancer</title>
		<ptr target="https://seer.cancer.gov/statfacts/html/lungb.html" />
		<imprint>
			<date type="published" when="2021-04" />
		</imprint>
		<respStmt>
			<orgName>National Cancer Institute -Surveillance, Epidemiology and End Results Program</orgName>
		</respStmt>
	</monogr>
	<note>Online; accessed 26</note>
</biblStruct>

<biblStruct xml:id="b34">
	<monogr>
		<title level="m" type="main">Training recurrent networks online without backtracking</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Ollivier</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Tallec</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Charpiat</surname></persName>
		</author>
		<idno>1507.07680</idno>
		<imprint>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title level="a" type="main">On the difficulty of training recurrent neural networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Pascanu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Mikolov</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Bengio</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International conference on machine learning</title>
		<imprint>
			<date type="published" when="2013" />
			<biblScope unit="page" from="1310" to="1318" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title level="a" type="main">A semi-supervised autoencoder framework for joint generation and classification of breathing</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">O</forename><surname>Pastor-Serrano</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Lathouwers</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Perk?</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computer Methods and Programs in Biomedicine</title>
		<imprint>
			<biblScope unit="volume">209</biblScope>
			<biblScope unit="page">106312</biblScope>
			<date type="published" when="2021" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<monogr>
		<title level="m" type="main">Prediction of the motion of chest internal points using a recurrent neural network trained with real-time recurrent learning for latency compensation in lung cancer radiotherapy. Computerized Medical Imaging and Graphics p 101941</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Pohl</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Uesaka</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Demachi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">B</forename><surname>Chhatkuli</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.compmedimag.2021.101941</idno>
		<ptr target="https://doi.org/10.1016/j.compmedimag.2021.101941" />
		<imprint>
			<date type="published" when="2021" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title level="a" type="main">Potential of a probabilistic framework for target prediction from surrogate respiratory motion during lung radiotherapy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Remy</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Ahumada</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Labine</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">C</forename><surname>C?t?</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Lachaine</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Bouchard</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Physics in Medicine &amp; Biology</title>
		<imprint>
			<biblScope unit="volume">66</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page">105002</biblScope>
			<date type="published" when="2021" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<analytic>
		<title level="a" type="main">Prediction of inplane organ deformation during free-breathing radiotherapy via discriminative spatial transformer networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">V</forename><surname>Romaguera</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Plantef?ve</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><forename type="middle">P</forename><surname>Romero</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>H?bert</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">F</forename><surname>Carrier</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Kadoury</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical image analysis</title>
		<imprint>
			<biblScope unit="volume">64</biblScope>
			<biblScope unit="page">101754</biblScope>
			<date type="published" when="2020" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<analytic>
		<title level="a" type="main">Kernel RNN learning (KeRNL)</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Roth</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Kanitscheider</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Fiete</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Learning Representations</title>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Salehinejad</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Sankar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Barfett</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Colak</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Valaee</surname></persName>
		</author>
		<idno>arXiv:180101078</idno>
		<title level="m">Recent advances in recurrent neural networks</title>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b42">
	<analytic>
		<title level="a" type="main">Systematic evaluation of lung tumor motion using four-dimensional computed tomography</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Sarudis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Karlsson</forename><surname>Hauer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Nyman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>B?ck</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Acta Oncologica</title>
		<imprint>
			<biblScope unit="volume">56</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="525" to="530" />
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b43">
	<analytic>
		<title level="a" type="main">Respiration tracking in radiosurgery</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Schweikard</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Shiomi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Adler</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical physics</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page" from="2738" to="2741" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b44">
	<analytic>
		<title level="a" type="main">Prediction of respiratory tumour motion for real-time image-guided radiotherapy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">C</forename><surname>Sharp</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">B</forename><surname>Jiang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Shimizu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Shirato</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Physics in Medicine &amp; Biology</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">425</biblScope>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b45">
	<analytic>
		<title level="a" type="main">Respiratory signal prediction based on adaptive boosting and multi-layer perceptron neural network</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Sun</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Jiang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Ren</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Dang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>You</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Yin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Physics in Medicine &amp; Biology</title>
		<imprint>
			<biblScope unit="volume">62</biblScope>
			<biblScope unit="issue">17</biblScope>
			<biblScope unit="page">6822</biblScope>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b46">
	<analytic>
		<title level="a" type="main">Intrafractional baseline shift or drift of lung tumor motion during gated radiation therapy with a real-time tumor-tracking system</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Takao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Miyamoto</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Matsuura</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Onimaru</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Katoh</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Inoue</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">L</forename><surname>Sutherland</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Suzuki</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Shirato</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Shimizu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">International Journal of Radiation Oncology* Biology* Physics</title>
		<imprint>
			<biblScope unit="volume">94</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="172" to="180" />
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b47">
	<monogr>
		<title level="m" type="main">Unbiased online recurrent optimization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Tallec</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Ollivier</surname></persName>
		</author>
		<idno>arXiv:170205043</idno>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b48">
	<monogr>
		<title level="m" type="main">Unbiasing truncated backpropagation through time</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Tallec</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Ollivier</surname></persName>
		</author>
		<idno>1705.08209</idno>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b49">
	<analytic>
		<title level="a" type="main">Feasibility of predicting tumor motion using online data acquired during treatment and a generalized neural network optimized with offline patient tumor trajectories</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">P</forename><surname>Teo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">B</forename><surname>Ahmed</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Kawalec</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Alayoubi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Bruce</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Lyn</forename><forename type="middle">E</forename><surname>Pistorius</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical physics</title>
		<imprint>
			<biblScope unit="volume">45</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="830" to="845" />
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b50">
	<analytic>
		<title level="a" type="main">Survey: real-time tumor motion prediction for image-guided radiation treatment</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Verma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Wu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Langer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Das</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Sandison</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computing in Science &amp; Engineering</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="24" to="35" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b51">
	<analytic>
		<title level="a" type="main">Real-time liver tracking algorithm based on LSTM and SVR networks for use in surface-guided radiation therapy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Dai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Q</forename><surname>Xiao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Bai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>He</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Bai</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Radiation Oncology</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="12" />
			<date type="published" when="2021" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b52">
	<analytic>
		<title level="a" type="main">A feasibility of respiration prediction based on deep Bi-LSTM for real-time tumor tracking</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Liang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Zhu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Xie</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Access</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="51262" to="51268" />
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b53">
	<analytic>
		<title level="a" type="main">Fast and accurate online sequential learning of respiratory motion with random convolution nodes for radiotherapy applications</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Yu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Sivanagaraja</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">C</forename><surname>Veluvolu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Applied Soft Computing</title>
		<imprint>
			<biblScope unit="volume">95</biblScope>
			<biblScope unit="page">106528</biblScope>
			<date type="published" when="2020" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b54">
	<analytic>
		<title level="a" type="main">A learning algorithm for continually running fully recurrent neural networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">J</forename><surname>Williams</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Zipser</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Neural computation</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="270" to="280" />
			<date type="published" when="1989" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b55">
	<analytic>
		<title level="a" type="main">Rapid prediction of respiratory motion based on bidirectional gated recurrent unit network</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Yu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Sun</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Kuang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Sun</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Access</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="49424" to="49435" />
			<date type="published" when="2020" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b56">
	<analytic>
		<title level="a" type="main">A deeplearning based 3D tumor motion prediction algorithm for non-invasive intra-fractional tumortracked radiotherapy (nifteRT) on Linac-MR</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Yun</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Rathee</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Fallone</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">International Journal of Radiation Oncology</title>
		<imprint>
			<biblScope unit="volume">105</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">28</biblScope>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
	<note>Physics</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
