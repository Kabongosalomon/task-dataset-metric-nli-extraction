<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /nfs/home/kabenamualus/Research/task-dataset-metric-extraction/../grobid-0.6.0/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">TransEDRP: Dual Transformer model with Edge Emdedded for Drug Respond Prediction</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kun</forename><surname>Li</surname></persName>
							<email>li__kun@whu.edu.cn</email>
							<affiliation key="aff0">
								<orgName type="department">School of Computer Science</orgName>
								<orgName type="institution">Wuhan University</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Wenbin</forename><surname>Hu</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Computer Science</orgName>
								<orgName type="institution">Wuhan University</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">TransEDRP: Dual Transformer model with Edge Emdedded for Drug Respond Prediction</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>

		<encodingDesc>
			<appInfo>
				<application version="0.6.0" ident="GROBID-SDO" when="2022-11-11T17:24+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid-sdo"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>GNN-based methods have achieved excellent results as a mainstream task in drug response prediction tasks in recent years. Traditional GNN methods use only the atoms in a drug molecule as nodes to obtain the representation of the molecular graph through node information passing, whereas the method using the transformer can only extract information about the nodes. However, the covalent bonding and chirality of a drug molecule have a great influence on the pharmacological properties of the molecule, and these information are implied in the chemical bonds formed by the edges between the atoms. In addition, CNN methods for modelling cell lines genomics sequences can only perceive local rather than global information about the sequence. In order to solve the above problems, we propose the decoupled dual transformer structure with edge embedded for drug respond prediction (TransEDRP), which is used for the representation of cell line genomics and drug respectively. For the drug branch, we encoded the chemical bond information within the molecule as the embedding of the edge in the molecular graph, extracted the global structural and biochemical information of the drug molecule using graph transformer. For the branch of cell lines genomics, we use the multi-headed attention mechanism to globally represent the genomics sequence. Finally, the drug and genomics branches are fused to predict IC50 values through the transformer layer and the fully connected layer, which two branches are different modalities. Extensive experiments have shown that our method is better than the current mainstream approach in all evaluation indicators.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>With the development of deep learning and big data, several scholars have applied graph computation theory to the task of drug response prediction(DRP). Compared with methods based on non-graph computational deep learning <ref type="bibr" target="#b1">[Liu et al., 2019;</ref><ref type="bibr">Sharifi-Noghabi et al., 2019;</ref><ref type="bibr" target="#b0">Chang et al., 2018]</ref>, GNNs methods have achieved better performance in the task of drug molecule representation <ref type="bibr" target="#b1">[Liu et al., 2020;</ref><ref type="bibr" target="#b2">Nguyen et al., 2022a;</ref><ref type="bibr" target="#b1">Nguyen et al., 2020;</ref><ref type="bibr">Nguyen et al., 2022b;</ref><ref type="bibr" target="#b1">Chu and Nguyen, 2021]</ref>.Usually, the DRP method based on graph neural networks is to convert the drug molecule into a graph structure where nodes are the atoms and the edges are the bonding of atoms. The atom-based graph representation constructs a defined graph structure for each drug molecule, which can more completely and stably represent the atomic features and the chemical bonds between atoms, and helps the model to accurately predict the biochemical properties of the molecule. In particular, GraTransDRP <ref type="bibr" target="#b1">[Chu and Nguyen, 2021]</ref> has achieved state-of-the-art results to date, which combined with Graph and Transformer for predicting cancer drug response. However, most existing methods based on GNNs assume that different types of intramolecular chemical bonds are the same type. Therefore, they apply permutation-invariant local aggregation of neighbors to learn a representation for each node without edge information, which omits important information about chemical bonds.</p><p>In fact, most atoms in chemical drug molecules have different labels or features, the types of chemical bonds in a molecule are different (see <ref type="figure" target="#fig_0">Figure 1</ref> b and c). In addition, molecules with atoms in the same order of interconnection but with double bonds and ring structures lead to the creation of chiral compounds. Most of the drugs used today are small organic molecules consisting of less than 50 atoms, a large proportion of which are chiral, and their pharmacological effects are realized through strict chiral matching and molecular recognition with large molecules in vivo. The enantiomers of chemical drugs containing chiral factors differ significantly in their pharmacological activity, metabolic processes and toxicity in the human body.</p><p>As a result, often only one of the two isomers is effective and the other is ineffective or even harmful. For example (see <ref type="figure" target="#fig_0">Figure 1</ref> a), thalidomide could be used to treat multiple myeloma, but due to technical problems the phenomenon of molecular chirality was ignored, leading to a failure to distinguish between the R-configuration of the compound, which has an inhibitory and sedative effect on pregnancy, and the Sconfiguration, which has teratogenic properties. Ultimately, tens of thousands of babies were malformed or died in the 1960s. 1D-CNN is widely used for extraction of features in cell genomics <ref type="bibr" target="#b1">[Liu et al., 2019;</ref><ref type="bibr">Nguyen et al., 2022b;</ref><ref type="bibr" target="#b1">Liu et al., 2020;</ref><ref type="bibr" target="#b1">Chu and Nguyen, 2021;</ref><ref type="bibr" target="#b1">Nguyen et al., 2020]</ref>. Although CNN has O(n) time and space complexity and can process long sequences, it is mainly used to extract local features of sequences, which a single operation of its convolution kernel can only compute a small range in the sequence(see <ref type="figure" target="#fig_1">Figure 2</ref>). Since the receptive field expands faster in the middle of the sequence and slower in the sides, the CNN can not make fair use of the information at all positions, resulting in the sequence position having an impact on the output of the convolution (sequences of cell genomics are positionindependent).</p><p>We propose TransEDRP to solve the above problems mentioned above separately, which is the dual transformer structure.</p><p>1) For the representation of drug molecules, we have creatively introduced molecular chirality and covalent bond types to encode information on intramolecular chemical bonds, and designed a graph transformer with edge embedded network to effectively combine intramolecular chemical bond information to represent molecules.</p><p>2) For the representation of genomics of cell lines, we designed a multi-head attention feature extraction module that allows similarity to be calculated between any two gene expression terms in genomics sequence and is used to improve the ability of the model to express complex dependencies in genomics sequences.</p><p>We fused the outputs of the two branches in a base concatenation way and then predicted IC50 by MLP and activation function. Noting that the two branches are decoupled, allowing the flexibility to modify either branch without affecting the other, which improves the practicality and scalability of the model.</p><p>Extensive comparative experiments have been done on mainstream datasets Genomicsof Drug Sensitivity in Cancer (GDSC) <ref type="bibr" target="#b4">[Yang et al., 2013]</ref> and Cancer Cell Line Encyclopedia (CCLE) <ref type="bibr" target="#b0">[Barretina et al., 2012]</ref> to show that TransE-DRP achieved state-of-the-art performance in all evaluation metrics, where the comparative methods are included tCNNs, GraphDRP, GraphTransDRP, etc. In addition, we have performed reliable ablation experiments and parametric sensitivity analyses to demonstrate the validity and robustness of our model.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Related Work</head><p>With the completion of large-scale projects on drug response in cell lines, such as GDSC <ref type="bibr" target="#b4">[Yang et al., 2013]</ref>, CCLE <ref type="bibr" target="#b0">[Barretina et al., 2012]</ref>, there is data support for drug response prediction.</p><p>The expression of drug molecules can utilize the Pubchem ID recorded in GDSC to get the line notation of simplified molecularinput line entry system (SMILES) from Pubchem, which was initially used to extract the structural and chemical features of each drug.</p><p>In addition, the release of high-throughput sequencing data for cancer cell lines has made it possible to study cancer phenotypes using multi-omics data such as genomics, transcriptomics and epigenomics. For example, the CCLE has published approximately 1,000 cancer cell lines and their corresponding holographic profiles. The half maximal inhibitory concentration (IC50) is the half inhibitory concentration of an antagonist being measured. It indicates the half amount of a drug or substance (inhibitor) that inhibits a biological process (or a substance included in such a process, such as an enzyme, cell receptor or microorganism).</p><p>Based on these data, many researchers have conducted studies on drug sensitivity prediction tasks. These methods can be broadly classified as graph based and no-graph based.</p><p>The no-graph based methods generally use neural network models of CNN and MLP for information extraction,e.g. CDRscan <ref type="bibr" target="#b0">[Chang et al., 2018]</ref>  <ref type="bibr">et al., 2018]</ref> is the first deep learning method for drug response prediction, which used genomics mutation as a cancer cell profile. tCNNs <ref type="bibr" target="#b1">[Liu et al., 2019]</ref> adopt two convolution networks to learn the representations of drug and cancer cell lines,which they using SMILES sequences of drugs and genomics mutation data of cell lines. MOLI <ref type="bibr">[Sharifi-Noghabi et al., 2019</ref>] is a multi-omics late integration method based on deep neural networks, which takes somatic mutation, copy number aberration and gene expression data as input.</p><p>The graph-based methods focuses on converting drug molecules into graph structures and then using graph neural networks (GNNs) models for graph representation, e.g. GraphDRP <ref type="bibr">[Nguyen et al., 2022b]</ref>, <ref type="bibr">DeepCDR [Liu et al., 2020]</ref>, GraTransDRP <ref type="bibr" target="#b1">[Chu and Nguyen, 2021]</ref>, etc. Considering that GNNs can extract structural features of molecular, GraphDRP <ref type="bibr">[Nguyen et al., 2022b]</ref> used GNNs to drug response prediction for the first time, which achieved superior performance compared to traditional machine learning methods. Subsequently, <ref type="bibr" target="#b2">[Nguyen et al., 2022a]</ref> proposed a deep learning model, GraOmicDRP, to learn the features of drug from graph representation and integrate multiple genomics data of cell lines, which is similar to MOLI <ref type="bibr">[Sharifi-Noghabi et al., 2019]</ref>. DeepCDR <ref type="bibr" target="#b1">[Liu et al., 2020</ref>] is a hybrid graph convolutional network that integrated multi-omics profiles and explored intrinsic chemical structures of drugs for drug response prediction. GraTransDRP <ref type="bibr" target="#b1">[Chu and Nguyen, 2021]</ref> is combined with GNNs and Transformer for predicting cancer drug response, which is primarily used to reduce the error associated with the approximation of heterogeneous graphs to homogeneous graphs. DeepTTA <ref type="bibr" target="#b1">[Jiang et al., 2022]</ref> decomposes drug molecules into fragments, and encodes drug molecules using fragment probabilities, then uses Transformer methods for drug response prediction.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Method</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Framework of TransEDRP</head><p>We proposed an end-to-end deep learning model to predict the anti-cancer drug response, named TransEDRP (see <ref type="bibr">Figure 3)</ref>. Due to the specificity of cancer drug response task, there are usually two main parts for feature extraction of anticancer drug and genomics of cell lines from the cancer patients, respectively. For the extensibility of the model, two separate branches based on the transformer are proposed for the two parts. Specifically, we utilize the graph transformer with edge embedded module to extract the higher-order semantics of the drug molecule graph, and utilize the multihead attention module to extract information from genomics of cell line, then the two types of features are are fused to predict the IC50 through the fully connected neural network.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Graph transformer with edge embedding</head><p>We use the W edge ? R 5? mapping the edges features X rawEdge ? R M ?5 into the X edge = { e 1 , e 2 , ..., e M } , e m ? R (see <ref type="table" target="#tab_1">Table 1</ref>).</p><p>We initialize the graph for the drug molecule SMILES string to obtain the adjacency matrix A ? R N ?N and the feature matrix of the atomic nodes X ? R N ? , N is the number of nodes in a graph, also known as the number of atoms in the drug molecule.</p><p>To extract the global information of the graph, we introduced the multi-head attention encoder layer to encode representation of each node. In this paper, the multi-head attention encoder layer is made up of several self-attention to extract the information of the graph: </p><formula xml:id="formula_0">Attention(X) = sof tmax( (XQ)(XK) ? d )XV<label>(1)</label></formula><formula xml:id="formula_1">where Q = W Q i ? R ? , K = W K i ? R ? , V = W V i ? R ?</formula><p>, and i is the index of the multi-head. The representation of the node X atten1 ? R N ? is obtained after multi-head attention extraction (we set the number of the head is 1).</p><p>Then we adopt a graph attention network (GAT) <ref type="bibr" target="#b3">[Veli?kovi? et al., 2017]</ref> in our model for the first massage passing. Take X atten1 as the node input to the GAT and representation the dependencies of the node neighbours by using the edges features X edge as the weight-share</p><formula xml:id="formula_2">W G ? R M ?M , where W G [i, j] = e m .</formula><p>The attention score between two node i and j can be calculate as fellows:</p><formula xml:id="formula_3">e ij = f ([W G x i , W G x j ])<label>(2)</label></formula><p>where f is the two-layer feed forward neural network. Then we use softmax function normalizes the correlation coefficient of node i, j.</p><formula xml:id="formula_4">? ij = softmax j (e ij ) = exp (e ij ) k?Ni exp (e ik )<label>(3)</label></formula><p>where j ? N i is a neighborhood of node i in the graph.The aggregated features from each head are concatenated to obtain x i :</p><formula xml:id="formula_5">x i = ? ? ? ? ? j?Ni ? k ij W k x j ? ? ? ?<label>(4)</label></formula><p>where ?(?) is the LeakyReLU non-linear activation functions, k ? (1, K) is the index of the multi-heads and K is total number of multi-head, [?] means concatenation of vectors.</p><p>Denote the X gat = { x 1 , x 2 , ..., x N } , x i ? R K as the node features output from GAT. Then we use Equation 1 again to obtain the representation of node X atten2 = h 1 , h 2 , ..., h N , h i ? R K .</p><p>The message aggregation of the node representation X atten2 of the graph is performed by GCN with the following equation: <ref type="figure">Figure 3</ref>: The framework illustration for TransEDRP. The inputs of the model are the drug SMILES string and the genomics sequence of cell lines, respectively. Our model therefore consists of three components: an encoder module for the drug, an encoder module for the genomics, and a prediction module for the interactions between the drugs and the genomics.</p><formula xml:id="formula_6">h i = ? ? ? j?Ni W h j ? ?<label>(5)</label></formula><p>where W ? R K ?K is the linear transformation matrix, ?(?) is also a nonlinear activation function.</p><p>We denote the X gcn = h 1 , h 2 , ..., h N , h i ? R K as the node features output from GCN.</p><formula xml:id="formula_7">h mean = N i=1 h i N (6) h max = max 1&lt;i?N h i<label>(7)</label></formula><p>For graph pooling, we compute the global mean pooling and global max pooling of all nodes X gcn respectively and denote them as h mean , h max .</p><formula xml:id="formula_8">X Drug = sof tmax(f 1 ( h mean , h max ))<label>(8)</label></formula><p>Finally, we use the fully-connected layers and dropout layer as fusion neural network f 1 to combine two vectors and convert them to R N ?128 , and get representation of each drug molecule graph X Drug ? R N ?128 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Multi-head attention genomics extraction block</head><p>We obtained gene mutation and pan-cancer gene from CCLE <ref type="bibr" target="#b0">[Barretina et al., 2012]</ref> and encoded them into one-hot format to obtain X cell = { c 1 , c 2 , ..., c N } , c t ? R 735?1 as an anticancer cell line for gene expression. The genomics of cell lines X cell is processed by the attention extraction module , of which is made up of multiple attention-based layers. One layer is given as an example:</p><formula xml:id="formula_9">c t = LN (Attention( c t ) + c t ) + f 2 ( c t )<label>(9)</label></formula><p>where LN means layer normalization, Attention(?) function is referenced to Equation 1, f 2 is the fully connected network. We add the result of attention to c t and c t as the residual connection, and then perform layer normalization.</p><formula xml:id="formula_10">f 3 ( c t ) = Dropout(ReLu(W cell c t ))<label>(10)</label></formula><p>where f 3 is the fully connected network, W cell ? R 735?128 . Then the genomics of cell lines can be expressed as X cell = c 1 , c 2 , ..., c N , , c t ? R 1?128 . We map the genomics information into the 128-dimensional feature space consistent with the size of the feature space of the drug molecule for multimodal fusion.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Multimodal fusion block for drug response prediction</head><formula xml:id="formula_11">IC 50 = ?(f 4 (Attention([X Drug , X cell ])))<label>(11)</label></formula><p>Finally, for the prediction of drug response, X Drug , X cell are concatenated and put through two fully-connected layers f 4 and ReLU activation function ?(?) to predict the response IC 50 = {y 1 , y 2 , ..., y N } ? R N ?1 .</p><formula xml:id="formula_12">L = N i=1 (y i ? y i ) 2 N<label>(12)</label></formula><p>where Y = {y 1 , y 2 , ..., y N } ? R N ?1 is the true label of IC50 score. We use mean squared loss L as the loss function of our model, which are consistent with other methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Experimental Setting</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Dataset</head><p>Drug sensitivity screening projects such as CCLE <ref type="bibr" target="#b0">[Barretina et al., 2012]</ref> and GDSC <ref type="bibr" target="#b4">[Yang et al., 2013]</ref> can provide genomics information and anti-cancer drug response data. Drug molecules can be downloaded from Pubchem in SMILES standard format. We parse the SMILES of the drug through rdkit and DeepChem to obtain the features of all the atoms and bonds within the molecule. Each chemical bond includes two features: double bond stereo information, the type of bond. Fellow GraphDRP <ref type="bibr">[Nguyen et al., 2022b]</ref>, each atom includes five features: atom symbol, atom degree calculated by the number of bonded neighbors and Hydrogen, the total number of Hydrogen, implicit value of the atom,(possible formal charge list) and whether the atom is aromatic. If there exists a bond among a pair of atoms, an edge is set. The genomics data of cell lines include mutation and copy number aberration , which is converted to one-hot format with a vector of 735 dimensions. The response values IC50 score is normalized in a range (0,1). As a result, we obtained drugs, cell line gene expressions, and drug response data after coding the drug and genomics sequences. Each drug was transformed into an undirected graph G , where the dimensions of the atom feature in a drug molecule is 78. Each cell line is converted to one-hot format with a vector of 735 dimensions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Experimental Design</head><p>Drug sensitivity data for cancer from GDSC database, we split it into 80% as the training set, 10% as the validation, and 10% as the test set. The validation set is used to tune the hyperparameters, and the testing set is used to evaluate the model.</p><p>In the training phase we set the batch size to 256 , the learning rate to 0.0005, the random seeds to 42. For our model, the number of attention heads for drug representation is 1, the number of GAT heads is 10, the number of multi-head attention blocks for cell lines genomics is 3 in total, each with 15 attention heads. By using an Adam optimizer, all the experiments are performed five times and then averaged. In the comparative experiment we show the variance of the evaluation results from different methods as a stability reference. Our equipment information is: Intel(R) Xeon(R) Silver 4210R, GeForce RTX 2080 Ti.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Performance Evaluation</head><p>We use Pearson's correlation coefficient (CC p ), Spearman's correlation coefficient (SC pp ), and root means square error (RM SE) as metrics. RMSE measures the difference between the predicted value and the true value:</p><formula xml:id="formula_13">RM SE = 1 n n i (o i ? y i ) 2<label>(13)</label></formula><p>where n is the number of data , o i is a ground-truth of ith sample, y i is the predicted value of i-th sample. Pearson correlation coefficient measures how strong a relationship is between two variables. CC p is defined as:</p><formula xml:id="formula_14">CC p = n i (o i ? y i ) 2 ? O ? Y<label>(14)</label></formula><p>where the standard deviation of O and Y be ? O , ? Y respectively.</p><p>The Spearman rank correlation coefficient is a nonparametric (distribution-independent) rank statistical parameter, which is usually considered as the Pearson linear correlation coefficient between the ranked variables. Then the Spearman rank correlation coefficient is:</p><formula xml:id="formula_15">SC pp = 1 ? 6 n i=1 (O i ? Y i ) 2 n(n 2 ? 1)<label>(15)</label></formula><p>The lower RM SE is, the better the model is. Meanwhile, the higher CC p and SC pp are, the better the model is. Typically, model performance is evaluated by these three metrics.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Results and Discussion</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Sensitivity Analysis of the hyperparameter</head><p>Mapping sequences in a lower dimensional feature space is easier to learn rich feature information without increasing the time complexity <ref type="bibr" target="#b3">[Vaswani et al., 2017]</ref>. The length of the genomics sequence of the cell lines encoded is 735, and the multi-head mechanism could reduce the difficulty of feature extraction. Therefore, we investigated the trend of model performance as a result of variation in the number of attention blocks n and list of head number in each multihead attention-based gene sequence feature extraction module H = {h 1 , h 2 , ..., h n }. <ref type="figure">Figure 4</ref>: The line shows the trend in model performance with n when hi is determined to be 1. <ref type="table" target="#tab_3">Table 3</ref>, in contrast to n greater than 1, the performance of the model drops significantly for n equal to 1. In <ref type="figure">Figure 4</ref>, With h i all 1, i ? <ref type="bibr">[1,</ref><ref type="bibr">9]</ref> the performance of the model increases slowly to decreases rapidly as n changes from 1 to 9. The time complexity of multi-head attention is O(n 2 d), and the single-layer CNN is O(knd), where n is the sequence length, d is the representation dimension, k is the kernel size of convolutions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>As shown in</head><p>Furthermore, comparing CNNs, our attention with only 1 layer and the head is 1 also outperforms state-of-the-art, fully demonstrating the problem of receptive field in <ref type="figure" target="#fig_1">Figure 2</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Comparative Experiment</head><p>For our comparative drug response prediction experiments, we selected five methods that are representative of current publicly available methods: GCN, GIN, GAT, concatenate of <ref type="bibr">GCN and GAT under GraphDRP [Nguyen et al., 2022b]</ref> structure , GraTransDRP <ref type="bibr" target="#b1">[Chu and Nguyen, 2021]</ref>, tCNNs <ref type="bibr" target="#b1">[Liu et al., 2019]</ref> with excellent performance among nongraph based methods.  The Comparative Experiments were done on the GDSC drug response datasets and measured in the RM SE, CC p and SC pp metrics. Since the experimental environment and data processing of the tCNNs method are different from our method, this paper shows the experimental results from <ref type="bibr">[Nguyen et al., 2022b]</ref>.</p><p>Five randomized experiments on each model to obtain the mean and standard deviation as the model performance. In the evaluation of Pearson, RMSE and Spearman metrics, ours model achieved the best results, improving over the current SOTA method GraTransDRP by 0.35% (Pearson), 2.34% (RMSE) and 0.47% (Spearman) respectively.</p><p>In addition the graph-based methods are better than the CNN-based method tCNNs due to the introduction of molecular structural information. Our models for the ablation experiments in drug molecular representation and genomics representation methods are shown in <ref type="table" target="#tab_4">Table 4</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3">Ablation Experiments</head><p>In the ablation experiments, we had three points to verify:</p><p>? The validity of using transformer to extract node features for the representation of molecular graphs;</p><p>? The validity of using edge embedding in the graph representation;</p><p>? The validity of using multi-head attention for the extraction of cell line genomics.</p><p>By comparing the performance of graph transformer with edge embedding and multi-head attention in RMSE, Pearson and Spearman metrics, the effectiveness of the two parts of the method can be verified. The best experimental result is achieved by using Graph Transformer with edge embedding for the representation of drug and multi-head attention for the representation of cell line genomics.</p><p>In response to the third point, we found that the effectiveness of using the multi-head attention to extract cell lines genomics is only manifested when a graph transformer was used in the other branch. Although the structure of the dual transformer shows that the features of the two branches are not coupled before fusion, the results show that there is a clear interaction between them, which may imply that the extent of drug molecule representation is a determining factor in the performance of drug response prediction models.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.4">External validation</head><p>The visualisation is shown in <ref type="figure">Figure 5</ref>. The red line represents the linear fit to the data we predicted. The red dashed line indicates that the prediction is the same as the true value in the ideal case. We visualise the distribution of true and predicted values through scatter plots and our model shows good predictive performance for a large number of random samples. <ref type="figure">Figure 5</ref>: The x-axis indicates the true value and the y-axis indicates the predicted results, the sample size is 19,105.</p><p>Our approach was compared with tCNNs <ref type="bibr" target="#b1">[Liu et al., 2019]</ref>, GraphDRP <ref type="bibr">[Nguyen et al., 2022b]</ref>, GraphTransDRP <ref type="bibr" target="#b1">[Chu and Nguyen, 2021]</ref>, etc. The reproducible experimental results showed that TransEDRP achieved SOTA in all experiments. In this study, we focused on the representation of the graph structure data of the drug and the representation of the cell lines genomics separately to improve the prediction accuracy of IC50, and we conducted ablation experiments to demonstrate the validity of the individual improvements of our model.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2">Future Work</head><p>In the area of drug molecule representation, future experiments could be made with 3d drug molecule modelling and more robust and explainable analyses based on drug effect groups, for example. Currently, it is more difficult to compare the performance of different models in the same situation due to the limitations of the data set and the different data selection, feature design and processing of drug molecules and genomics of cell line. by different drug response prediction methods. Perhaps, in the future, the performance of different models should be tested in the same data set split case (an unbiased test set need to be published).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Ethical Statement</head><p>There are no ethical issues.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>The process of diagrammatic characterisation of a drug molecule, using the chemical bonds between atoms as edges. The information on the edges includes chirality, covalent bond, aromatic, etc.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2 :</head><label>2</label><figDesc>Receptive field of 2-layer CNN (a) vs. 1-layer multi-head attention (b), where we set the kernel size to 1, stride to 1 and dilation to 0.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head></head><label></label><figDesc>, tCNNs [Liu et al., 2019], MOLI [Sharifi-Noghabi et al., 2019], etc. CDRscan [Chang</figDesc><table /><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 1 :</head><label>1</label><figDesc>The isomers caused by double bonds or single bonds of ring-forming carbon atoms that are not free to rotate are geometric isomers, and for this property of the molecule we obtain information on the five types of bond. In the 3D diagram of a molecule, we refer to a bond between two carbon atoms, except for the third example, which is a chemical bond between a carbon and an oxygen atom (oxygen atoms are indicated by red nodes).</figDesc><table><row><cell>Example</cell><cell>Type as Double</cell><cell cols="3">IsAromatic IsConjugated IsInRing</cell><cell>BondDir</cell></row><row><cell></cell><cell>1.0(SINGLE)</cell><cell>False</cell><cell>True</cell><cell>False</cell><cell>NONE</cell></row><row><cell></cell><cell>1.5(AROMATIC)</cell><cell>True</cell><cell>True</cell><cell>True</cell><cell>NONE</cell></row><row><cell></cell><cell>2.0(DOUBLE)</cell><cell>False</cell><cell>True</cell><cell>False</cell><cell>ENDDOWNRIGHT / ENDUPRIGHT</cell></row><row><cell></cell><cell>3.0(TRIPLE)</cell><cell>False</cell><cell>True</cell><cell>False</cell><cell>NONE</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 2 :</head><label>2</label><figDesc>The best performance is in bold, the second best experimental result is indicated in italics</figDesc><table><row><cell>Models</cell><cell></cell><cell>Paper show</cell><cell>Pearson? Our test</cell><cell>Paper show</cell><cell>RMSE? Our test</cell><cell>Spearman? Our test</cell></row><row><cell>tCNNs</cell><cell></cell><cell>0.91600</cell><cell>0.88307 ? 0.00213</cell><cell>0.02840</cell><cell cols="2">0.03291 ? 0.00089 0.85547 ? 0.00073</cell></row><row><cell></cell><cell>GCN</cell><cell>0.92160</cell><cell>0.91794? 0.00027</cell><cell>0.02590</cell><cell cols="2">0.02664? 0.00006 0.89770? 0.00017</cell></row><row><cell>GraphDRP</cell><cell>GIN GAT</cell><cell>0.93100 0.92700</cell><cell>0.93005? 0.00060 0.92646? 0.00055</cell><cell>0.02440 0.02500</cell><cell cols="2">0.02477? 0.00015 0.90842? 0.00071 0.02532? 0.00012 0.90309? 0.00045</cell></row><row><cell cols="2">GCN_GAT</cell><cell>0.93080</cell><cell>0.93060? 0.00016</cell><cell>0.02430</cell><cell cols="2">0.02452? 0.00003 0.90944? 0.00019</cell></row><row><cell cols="2">GraTransDRP</cell><cell>0.93170</cell><cell>0.93481 ? 0.00019</cell><cell>0.02380</cell><cell cols="2">0.02377 ? 0.00003 0.91364 ? 0.00047</cell></row><row><cell>Ours</cell><cell></cell><cell>\</cell><cell>0.93807 ? 0.00017</cell><cell>\</cell><cell cols="2">0.02319 ? 0.00007 0.91796 ? 0.00014</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head>Table 3</head><label>3</label><figDesc></figDesc><table><row><cell cols="6">: We show the model evaluation metrics Pearson at different</cell></row><row><cell cols="5">variations of n and h h when n is determined from 1 to 5.</cell><cell></cell></row><row><cell>h Pearson n</cell><cell>1</cell><cell>2</cell><cell>3</cell><cell>4</cell><cell>5</cell></row><row><cell>1</cell><cell>0.93649</cell><cell cols="2">0.93751 0.93738</cell><cell cols="2">0.93794 0.93763</cell></row><row><cell>7</cell><cell>0.93642</cell><cell cols="4">0.93781 0.93747 0.937379 0.93796</cell></row><row><cell>15</cell><cell>0.93624</cell><cell>0.93797</cell><cell cols="3">0.93810 0.937252 0.93744</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head>Table 4 :</head><label>4</label><figDesc>Ablation experiments for TransEDRP.</figDesc><table><row><cell>Graph Transformer</cell><cell>Edge Embedding</cell><cell>Cell Line Extract</cell><cell cols="2">RMSE? Pearson? Spearman?</cell></row><row><cell></cell><cell>No</cell><cell>Conv1d</cell><cell>0.02461 0.93004</cell><cell>0.90965</cell></row><row><cell>No</cell><cell>Yes No</cell><cell cols="2">Conv1d Attention 0.02539 0.92533 0.02442 0.93112</cell><cell>0.91047 0.90370</cell></row><row><cell></cell><cell>Yes</cell><cell cols="2">Attention 0.02523 0.92635</cell><cell>0.90548</cell></row><row><cell></cell><cell>No</cell><cell>Conv1d</cell><cell>0.02378 0.93480</cell><cell>0.91360</cell></row><row><cell>Yes</cell><cell>Yes No</cell><cell cols="2">Conv1d Attention 0.02329 0.93774 0.02370 0.93530</cell><cell>0.91467 0.91738</cell></row><row><cell></cell><cell>Yes</cell><cell cols="2">Attention 0.02329 0.93808</cell><cell>0.91796</cell></row></table><note></note></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="6">Summary and Future Work6.1 SummaryIn this study, we propose a method for drug response prediction called TransEDRP. Our model used graph transformer with edge embedding network to extract a better graph representation of drug and used the multi-head attention to extract genomics representation of cell line, which is a dual-branch attention architecture.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgments</head></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Cancer drug response profile scan (cdrscan): A deep learning model that predicts drug effectiveness from cancer genomic signature</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">[</forename><surname>References</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Barretina</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Scientific Reports</title>
		<editor>Chang, Hyejin Park, Hyun jin Yang, Seungju Lee, Kwee-Yum Lee, Tae Soon Kim, Jongsun Jung, and Jae-Min Shin</editor>
		<imprint>
			<biblScope unit="volume">483</biblScope>
			<biblScope unit="issue">7391</biblScope>
			<biblScope unit="page" from="1" to="11" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
	<note>Nature</note>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Improving prediction of phenotypic drug response on cancer cell lines using deep convolutional network</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Thang</forename><surname>Chu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Tuan</forename><surname>Nguyen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">;</forename><surname>Jiang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Graph transformer for drug response prediction. bioRxiv</title>
		<imprint>
			<date type="published" when="2019" />
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="1140" to="1147" />
		</imprint>
	</monogr>
	<note>Bioinformatics</note>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Integrating molecular graph data of drugs and multiple -omic data of cell lines for drug response prediction</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Nguyen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE/ACM Transactions on Computational Biology and Bioinformatics</title>
		<editor>Nguyen et al., 2022b] Tuan Nguyen, Giang T. T. Nguyen, Thin Nguyen, and Duc-Hau Le</editor>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="146" to="154" />
			<date type="published" when="2022" />
		</imprint>
	</monogr>
	<note>IEEE/ACM Transactions on Computational Biology and Bioinformatics. Sharifi-Noghabi et al., 2019] Hossein Sharifi-Noghabi</note>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">MOLI: multi-omics late integration with deep neural networks for drug response prediction</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Olga</forename><surname>Zolotareva</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Colin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Martin</forename><surname>Collins</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">;</forename><surname>Ester</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Vaswani</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Advances in Neural Information Processing Systems 30: Annual Conference on Neural Information Processing Systems</title>
		<editor>Isabelle Guyon, Ulrike von Luxburg, Samy Bengio, Hanna M. Wallach, Rob Fergus, S. V. N. Vishwanathan, and Roman Garnett</editor>
		<meeting><address><addrLine>Long Beach, CA, USA</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2017-12-09" />
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="page" from="6000" to="6010" />
		</imprint>
	</monogr>
	<note>Graph attention networks</note>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<title level="m" type="main">Genomics of drug sensitivity in cancer (gdsc): a resource for therapeutic biomarker discovery in cancer cells</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">[</forename><surname>Yang</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2013-01" />
			<biblScope unit="page" from="955" to="61" />
		</imprint>
	</monogr>
	<note>Nucleic acids research, 41(Database issue</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
