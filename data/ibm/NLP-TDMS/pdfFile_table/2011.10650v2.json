[{"caption":"Table 1: Loss by network with different configurations of stochastic layers on ImageNet-32 \n(similar trends appear on CIFAR-10). Left: Networks with equal number of layers, but with lower \nstochastic depth as described in Section 5.1. Increasing depth up to 48 layers still shows gains, \nwhich is farther than previous work has explored. Right: Networks with 48 layers, but distributed \nat different resolutions. We find higher resolutions benefit more from layers. \n\n","rows":["41M","Test Loss","2","3","4","6","8","Params","Depth","Distribution of"],"columns":["Test Loss","4x4","16x16","8x8","1x1","32x32"],"mergedAllColumns":[],"numberCells":[{"number":"10","isBolded":false,"associatedRows":["Depth","41M"],"associatedColumns":["Test Loss","8x8"],"associatedMergedColumns":[]},{"number":"4.18","isBolded":false,"associatedRows":["6","41M"],"associatedColumns":["Test Loss","32x32"],"associatedMergedColumns":[]},{"number":"48layers","isBolded":true,"associatedRows":["Depth","Params","Test Loss","Distribution of"],"associatedColumns":[],"associatedMergedColumns":[]},{"number":"4.30","isBolded":false,"associatedRows":["3","41M"],"associatedColumns":["Test Loss"],"associatedMergedColumns":[]},{"number":"12","isBolded":false,"associatedRows":["Depth","41M"],"associatedColumns":["Test Loss","32x32"],"associatedMergedColumns":[]},{"number":"3.96","isBolded":false,"associatedRows":["Depth","41M","6","4"],"associatedColumns":["Test Loss","1x1"],"associatedMergedColumns":[]},{"number":"10","isBolded":false,"associatedRows":["Depth","41M"],"associatedColumns":["Test Loss","8x8"],"associatedMergedColumns":[]},{"number":"12","isBolded":false,"associatedRows":[],"associatedColumns":["Test Loss","32x32"],"associatedMergedColumns":[]},{"number":"3.98","isBolded":false,"associatedRows":["6","41M","8","8"],"associatedColumns":["Test Loss","1x1"],"associatedMergedColumns":[]},{"number":"10","isBolded":false,"associatedRows":["6","41M"],"associatedColumns":["Test Loss","8x8"],"associatedMergedColumns":[]},{"number":"12","isBolded":false,"associatedRows":["Depth","41M"],"associatedColumns":["Test Loss","16x16"],"associatedMergedColumns":[]},{"number":"16","isBolded":false,"associatedRows":["Depth","41M"],"associatedColumns":["Test Loss","32x32"],"associatedMergedColumns":[]},{"number":"10","isBolded":false,"associatedRows":["6","41M"],"associatedColumns":["Test Loss","32x32"],"associatedMergedColumns":[]},{"number":"3.97","isBolded":false,"associatedRows":["Depth","41M","8","6"],"associatedColumns":["Test Loss","1x1"],"associatedMergedColumns":[]},{"number":"10","isBolded":false,"associatedRows":["6","41M"],"associatedColumns":["Test Loss","4x4"],"associatedMergedColumns":[]},{"number":"16","isBolded":false,"associatedRows":["Depth","41M"],"associatedColumns":["Test Loss","16x16"],"associatedMergedColumns":[]},{"number":"10","isBolded":false,"associatedRows":["Depth","41M"],"associatedColumns":["Test Loss","8x8"],"associatedMergedColumns":[]},{"number":"3.98","isBolded":false,"associatedRows":["Depth","41M"],"associatedColumns":["Test Loss","32x32"],"associatedMergedColumns":[]},{"number":"48","isBolded":false,"associatedRows":[],"associatedColumns":["Test Loss","32x32"],"associatedMergedColumns":[]},{"number":"14","isBolded":false,"associatedRows":["Depth","41M"],"associatedColumns":["Test Loss","16x16"],"associatedMergedColumns":[]},{"number":"10","isBolded":false,"associatedRows":["6","41M"],"associatedColumns":["Test Loss","16x16"],"associatedMergedColumns":[]},{"number":"3.95","isBolded":false,"associatedRows":["6","41M"],"associatedColumns":["Test Loss","32x32"],"associatedMergedColumns":[]},{"number":"4.06","isBolded":false,"associatedRows":["Depth","41M"],"associatedColumns":["Test Loss","32x32"],"associatedMergedColumns":[]},{"number":"14","isBolded":false,"associatedRows":["Depth","41M"],"associatedColumns":["Test Loss","32x32"],"associatedMergedColumns":[]},{"number":"24","isBolded":false,"associatedRows":[],"associatedColumns":["Test Loss","32x32"],"associatedMergedColumns":[]},{"number":"3.95","isBolded":false,"associatedRows":["Depth","41M","4","2"],"associatedColumns":["Test Loss","1x1"],"associatedMergedColumns":[]}]},{"caption":"Table 2: Our main results on standard benchmark datasets. Very deep VAEs outperform \nPixelCNN-based autoregressive models with fewer parameters while maintaining fast sampling. \n\"Depth\" refers to the number of stochastic layers for hierarchical VAEs (although BIVA and IAF-\nbased networks have additional statistical dependencies). Sampling refers to the number of network \nevaluations per sample, and D designates the dimensionality of the data. An asterisk (  *  ) denotes our \nestimate of parameters. Samples for ImageNet and CIFAR-10 are in the Appendix. \n\n","rows":["45","169M","125M","Glow ( Kingma \u0026 Dhariwal , 2018 )","IAF - VAE ( Kingma et al . , 2016 )","177M *","10","12","15","39M","59M","BIVA","31M","PixelCNN++ ( Salimans et al . , 2017 )","AR","1","Flow++","53M *","62","119M","Sparse Transformer","D","28","Very Deep VAE ( ours )","NVAE","131M","103M","268M","115M","VLAE ( Chen et al . , 2016 )","NVAE ( Vahdat \u0026 Kautz , 2020 )","150M","Sparse Transformer ( Child et al . , 2019 )","72","30","75","78","Flow++ ( Ho et al . , 2019 )","36","≤","152M","SPN ( Menick \u0026 Kalchbrenner , 2018 )","Flow","73M","BIVA ( Maaløe et al . , 2019 )","Gated PixelCNN","Image Transformer ( Parmar et al . , 2018 )","103M *","PixelSNAIL ( Chen et al . , 2017 )","VAE"],"columns":["NLL"],"mergedAllColumns":["ImageNet - 64","FFHQ - 1024 ( 8 bit )","CIFAR - 10","FFHQ - 256 ( 5 bit )","ImageNet - 32"],"numberCells":[{"number":"2.80","isBolded":true,"associatedRows":["Sparse Transformer ( Child et al . , 2019 )","AR","59M","12","D"],"associatedColumns":["NLL"],"associatedMergedColumns":["CIFAR - 10"]},{"number":"3.11","isBolded":false,"associatedRows":["IAF - VAE ( Kingma et al . , 2016 )","VAE","103M","12","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["CIFAR - 10"]},{"number":"3.08","isBolded":false,"associatedRows":["Flow++ ( Ho et al . , 2019 )","Flow","31M","12","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["CIFAR - 10"]},{"number":"0.61","isBolded":true,"associatedRows":["Very Deep VAE ( ours )","VAE","115M","62","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["FFHQ - 256 ( 5 bit )"]},{"number":"0.68","isBolded":false,"associatedRows":["NVAE","VAE","115M","36","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["FFHQ - 256 ( 5 bit )"]},{"number":"3.80","isBolded":true,"associatedRows":["Very Deep VAE ( ours )","VAE","119M","78","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["ImageNet - 32"]},{"number":"3.83","isBolded":false,"associatedRows":["Gated PixelCNN","AR","177M *","10","D"],"associatedColumns":["NLL"],"associatedMergedColumns":["ImageNet - 32"]},{"number":"2.85","isBolded":false,"associatedRows":["PixelSNAIL ( Chen et al . , 2017 )","AR","53M *","12","D"],"associatedColumns":["NLL"],"associatedMergedColumns":["CIFAR - 10"]},{"number":"3.08","isBolded":false,"associatedRows":["BIVA ( Maaløe et al . , 2019 )","VAE","103M","15","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["CIFAR - 10"]},{"number":"2.87","isBolded":true,"associatedRows":["Very Deep VAE ( ours )","VAE","39M","45","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["CIFAR - 10"]},{"number":"3.52","isBolded":false,"associatedRows":["SPN ( Menick \u0026 Kalchbrenner , 2018 )","AR","150M","78","D"],"associatedColumns":["NLL"],"associatedMergedColumns":["ImageNet - 64"]},{"number":"3.77","isBolded":true,"associatedRows":["Image Transformer ( Parmar et al . , 2018 )","AR","103M *","10","D"],"associatedColumns":["NLL"],"associatedMergedColumns":["ImageNet - 32"]},{"number":"3.69","isBolded":false,"associatedRows":["Flow++","Flow","73M","75","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["ImageNet - 64"]},{"number":"2.42","isBolded":true,"associatedRows":["Very Deep VAE ( ours )","VAE","115M","72","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["FFHQ - 1024 ( 8 bit )"]},{"number":"3.86","isBolded":false,"associatedRows":["Flow++","Flow","169M","28","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["ImageNet - 32"]},{"number":"2.95","isBolded":false,"associatedRows":["VLAE ( Chen et al . , 2016 )","VAE","103M","12","D","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["CIFAR - 10"]},{"number":"3.57","isBolded":false,"associatedRows":["Gated PixelCNN","AR","177M *","78","D"],"associatedColumns":["NLL"],"associatedMergedColumns":["ImageNet - 64"]},{"number":"3.92","isBolded":false,"associatedRows":["NVAE","VAE","268M","28","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["ImageNet - 32"]},{"number":"2.92","isBolded":false,"associatedRows":["PixelCNN++ ( Salimans et al . , 2017 )","AR","53M *","12","D"],"associatedColumns":["NLL"],"associatedMergedColumns":["CIFAR - 10"]},{"number":"3.81","isBolded":false,"associatedRows":["Glow ( Kingma \u0026 Dhariwal , 2018 )","Flow","152M","75","1"],"associatedColumns":["NLL"],"associatedMergedColumns":["ImageNet - 64"]},{"number":"2.91","isBolded":false,"associatedRows":["NVAE ( Vahdat \u0026 Kautz , 2020 )","VAE","131M","30","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["CIFAR - 10"]},{"number":"3.96","isBolded":false,"associatedRows":["BIVA","VAE","103M *","15","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["ImageNet - 32"]},{"number":"3.44","isBolded":true,"associatedRows":["Sparse Transformer","AR","152M","75","D"],"associatedColumns":["NLL"],"associatedMergedColumns":["ImageNet - 64"]},{"number":"3.52","isBolded":true,"associatedRows":["Very Deep VAE ( ours )","VAE","125M","75","1","≤"],"associatedColumns":["NLL"],"associatedMergedColumns":["ImageNet - 64"]}]},{"caption":"Table 3: Effects of scaling residual initialization on very deep VAEs. We trained networks with \nvarying depths for 80k iterations. Scaling the last layer in the residual block by 1 \n\n√ \n\nN results in \nhigher losses for shallower networks, but lower losses and greater stability for deeper networks. The \nnumber of updates which are skipped because the gradient norm would destabilize the network is \nsignificantly reduced with scaling. \n\n","rows":["45","13","15","48","Diverged","60","30","41","-","75","76"],"columns":["With scaling","Without scaling","Loss"],"mergedAllColumns":["0","1"],"numberCells":[{"number":"2.31","isBolded":false,"associatedRows":["45"],"associatedColumns":["Without scaling","Loss"],"associatedMergedColumns":["1"]},{"number":"2.29","isBolded":false,"associatedRows":["60","76"],"associatedColumns":["With scaling","Loss"],"associatedMergedColumns":["0"]},{"number":"2.38","isBolded":false,"associatedRows":["30","41"],"associatedColumns":["With scaling","Loss"],"associatedMergedColumns":["0"]},{"number":"2.30","isBolded":false,"associatedRows":["45","48"],"associatedColumns":["With scaling","Loss"],"associatedMergedColumns":["1"]},{"number":"2.50","isBolded":false,"associatedRows":["15"],"associatedColumns":["Without scaling","Loss"],"associatedMergedColumns":[]},{"number":"2.36","isBolded":false,"associatedRows":["30"],"associatedColumns":["Without scaling","Loss"],"associatedMergedColumns":["0"]},{"number":"2.51","isBolded":false,"associatedRows":["15","13"],"associatedColumns":["With scaling","Loss"],"associatedMergedColumns":[]},{"number":"2.28","isBolded":false,"associatedRows":["75","Diverged","-"],"associatedColumns":["With scaling","Loss"],"associatedMergedColumns":["1"]},{"number":"2.30","isBolded":false,"associatedRows":["60"],"associatedColumns":["Without scaling","Loss"],"associatedMergedColumns":["0"]}]},{"caption":"Table 4: Key hyperparameters for experiments. We detail here the main hyperparameters used in \ntraining. FFHQ-1024 has reduced hidden size for higher resolutions; see code for details. \n\n","rows":["2 x V100","Weight Decay","Learning rate","GPUs","Latent dim per layer","256","EMA rate","Num layers","6 days","128","Batch size","Training iterations","Bottleneck size","Training time"],"columns":["ImageNet - 64","CIFAR - 10","180","380","FFHQ - 1024","384","Adam","300","FFHQ - 256","400","500","512","128","Varies","ImageNet - 32"],"mergedAllColumns":[],"numberCells":[{"number":"0.00015","isBolded":false,"associatedRows":["EMA rate","2 x V100"],"associatedColumns":["FFHQ - 1024","Varies","Varies","Adam","500"],"associatedMergedColumns":[]},{"number":"0.0","isBolded":false,"associatedRows":["Weight Decay","2 x V100"],"associatedColumns":["ImageNet - 32","512","128","Adam","300"],"associatedMergedColumns":[]},{"number":"1.6M","isBolded":false,"associatedRows":["Training iterations","2 x V100"],"associatedColumns":["ImageNet - 64","512","128","Adam","380"],"associatedMergedColumns":[]},{"number":"16","isBolded":false,"associatedRows":["Latent dim per layer","2 x V100"],"associatedColumns":["FFHQ - 1024","Varies","Varies"],"associatedMergedColumns":[]},{"number":"16","isBolded":false,"associatedRows":["Latent dim per layer","2 x V100"],"associatedColumns":["ImageNet - 64","512","128"],"associatedMergedColumns":[]},{"number":"1.7M","isBolded":false,"associatedRows":["Training iterations","2 x V100"],"associatedColumns":["FFHQ - 256","512","128","Adam","180"],"associatedMergedColumns":[]},{"number":"32xV100","isBolded":false,"associatedRows":["GPUs","2 x V100"],"associatedColumns":["ImageNet - 64","512","128","Adam","380"],"associatedMergedColumns":[]},{"number":"72","isBolded":false,"associatedRows":["Num layers","2 x V100"],"associatedColumns":["FFHQ - 1024"],"associatedMergedColumns":[]},{"number":"0.00015","isBolded":false,"associatedRows":["Learning rate","2 x V100"],"associatedColumns":["ImageNet - 64","512","128"],"associatedMergedColumns":[]},{"number":"0.0","isBolded":false,"associatedRows":["Weight Decay","2 x V100"],"associatedColumns":["ImageNet - 64","512","128","Adam","380"],"associatedMergedColumns":[]},{"number":"1.1M","isBolded":false,"associatedRows":["Training iterations"],"associatedColumns":["CIFAR - 10","384","128","Adam","400"],"associatedMergedColumns":[]},{"number":"32xV100","isBolded":false,"associatedRows":["GPUs","2 x V100"],"associatedColumns":["ImageNet - 32","512","128","Adam","300"],"associatedMergedColumns":[]},{"number":"16","isBolded":false,"associatedRows":["Latent dim per layer"],"associatedColumns":["CIFAR - 10","384","128"],"associatedMergedColumns":[]},{"number":"0.00015","isBolded":false,"associatedRows":["Learning rate","2 x V100"],"associatedColumns":["ImageNet - 32","512","128"],"associatedMergedColumns":[]},{"number":"1.7M","isBolded":false,"associatedRows":["Training iterations","2 x V100"],"associatedColumns":["ImageNet - 32","512","128","Adam","300"],"associatedMergedColumns":[]},{"number":"78","isBolded":false,"associatedRows":["Num layers","2 x V100"],"associatedColumns":["ImageNet - 32"],"associatedMergedColumns":[]},{"number":"32xV100","isBolded":false,"associatedRows":["GPUs","2 x V100"],"associatedColumns":["FFHQ - 256","512","128","Adam","180"],"associatedMergedColumns":[]},{"number":"2.5weeks","isBolded":false,"associatedRows":["Training time","6 days"],"associatedColumns":["FFHQ - 256","512","128","Adam","180"],"associatedMergedColumns":[]},{"number":"32","isBolded":false,"associatedRows":["Batch size","2 x V100","256","128"],"associatedColumns":["FFHQ - 1024","Varies","Varies"],"associatedMergedColumns":[]},{"number":"75","isBolded":false,"associatedRows":["Num layers","2 x V100"],"associatedColumns":["ImageNet - 64"],"associatedMergedColumns":[]},{"number":"2.5weeks","isBolded":false,"associatedRows":["Training time","6 days"],"associatedColumns":["ImageNet - 64","512","128","Adam","380"],"associatedMergedColumns":[]},{"number":"2.5weeks","isBolded":false,"associatedRows":["Training time","6 days"],"associatedColumns":["FFHQ - 1024","Varies","Varies","Adam","500"],"associatedMergedColumns":[]},{"number":"45","isBolded":false,"associatedRows":["Num layers"],"associatedColumns":["CIFAR - 10"],"associatedMergedColumns":[]},{"number":"32","isBolded":false,"associatedRows":["Batch size"],"associatedColumns":["CIFAR - 10","384","128"],"associatedMergedColumns":[]},{"number":"0.01","isBolded":false,"associatedRows":["Weight Decay"],"associatedColumns":["CIFAR - 10","384","128","Adam","400"],"associatedMergedColumns":[]},{"number":"0.0","isBolded":false,"associatedRows":["Weight Decay","2 x V100"],"associatedColumns":["FFHQ - 1024","Varies","Varies","Adam","500"],"associatedMergedColumns":[]},{"number":"16","isBolded":false,"associatedRows":["Latent dim per layer","2 x V100"],"associatedColumns":["ImageNet - 32","512","128"],"associatedMergedColumns":[]},{"number":"0.0002","isBolded":false,"associatedRows":["Learning rate"],"associatedColumns":["CIFAR - 10","384","128"],"associatedMergedColumns":[]},{"number":"0.00015","isBolded":false,"associatedRows":["EMA rate","2 x V100"],"associatedColumns":["FFHQ - 256","512","128","Adam","180"],"associatedMergedColumns":[]},{"number":"96","isBolded":false,"associatedRows":["Bottleneck size"],"associatedColumns":["CIFAR - 10","384"],"associatedMergedColumns":[]},{"number":"0.00015","isBolded":false,"associatedRows":["EMA rate","2 x V100"],"associatedColumns":["ImageNet - 64","512","128","Adam","380"],"associatedMergedColumns":[]},{"number":"32","isBolded":false,"associatedRows":["Batch size","2 x V100","256","128"],"associatedColumns":["FFHQ - 256","512","128"],"associatedMergedColumns":[]},{"number":"0.00015","isBolded":false,"associatedRows":["Learning rate","2 x V100"],"associatedColumns":["FFHQ - 256","512","128"],"associatedMergedColumns":[]},{"number":"0.0002","isBolded":false,"associatedRows":["EMA rate"],"associatedColumns":["CIFAR - 10","384","128","Adam","400"],"associatedMergedColumns":[]},{"number":"0.00015","isBolded":false,"associatedRows":["EMA rate","2 x V100"],"associatedColumns":["ImageNet - 32","512","128","Adam","300"],"associatedMergedColumns":[]},{"number":"0.00007","isBolded":false,"associatedRows":["Learning rate","2 x V100"],"associatedColumns":["FFHQ - 1024","Varies","Varies"],"associatedMergedColumns":[]},{"number":"62","isBolded":false,"associatedRows":["Num layers","2 x V100"],"associatedColumns":["FFHQ - 256"],"associatedMergedColumns":[]},{"number":"1.7M","isBolded":false,"associatedRows":["Training iterations","2 x V100"],"associatedColumns":["FFHQ - 1024","Varies","Varies","Adam","500"],"associatedMergedColumns":[]},{"number":"2.5weeks","isBolded":false,"associatedRows":["Training time","6 days"],"associatedColumns":["ImageNet - 32","512","128","Adam","300"],"associatedMergedColumns":[]},{"number":"32xV100","isBolded":false,"associatedRows":["GPUs","2 x V100"],"associatedColumns":["FFHQ - 1024","Varies","Varies","Adam","500"],"associatedMergedColumns":[]},{"number":"16","isBolded":false,"associatedRows":["Latent dim per layer","2 x V100"],"associatedColumns":["FFHQ - 256","512","128"],"associatedMergedColumns":[]},{"number":"0.0","isBolded":false,"associatedRows":["Weight Decay","2 x V100"],"associatedColumns":["FFHQ - 256","512","128","Adam","180"],"associatedMergedColumns":[]}]}]