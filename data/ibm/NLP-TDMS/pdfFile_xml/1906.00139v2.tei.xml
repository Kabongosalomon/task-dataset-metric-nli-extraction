<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /nfs/home/kabenamualus/Research/task-dataset-metric-extraction/../grobid-0.6.0/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Region-specific Diffeomorphic Metric Mapping</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zhengyang</forename><surname>Shen</surname></persName>
							<email>zyshen@cs.unc.edu</email>
							<affiliation key="aff0">
								<orgName type="institution">UNC Chapel Hill</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">François-Xavier</forename><surname>Vialard</surname></persName>
							<email>francois-xavier.vialard@u-pem.fr</email>
							<affiliation key="aff1">
								<orgName type="institution">LIGM</orgName>
								<address>
									<country>UPEM</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Marc</forename><surname>Niethammer</surname></persName>
							<affiliation key="aff2">
								<orgName type="institution">UNC</orgName>
								<address>
									<settlement>Chapel Hill</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Region-specific Diffeomorphic Metric Mapping</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>

		<encodingDesc>
			<appInfo>
				<application version="0.6.0" ident="GROBID-SDO" when="2021-06-26T07:00+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid-sdo"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>We introduce a region-specific diffeomorphic metric mapping (RDMM) registration approach. RDMM is non-parametric, estimating spatio-temporal velocity fields which parameterize the sought-for spatial transformation. Regularization of these velocity fields is necessary. In contrast to existing non-parametric registration approaches using a fixed spatially-invariant regularization, for example, the large displacement diffeomorphic metric mapping (LDDMM) model, our approach allows for spatially-varying regularization which is advected via the estimated spatio-temporal velocity field. Hence, not only can our model capture large displacements, it does so with a spatio-temporal regularizer that keeps track of how regions deform, which is a more natural mathematical formulation. We explore a family of RDMM registration approaches: 1) a registration model where regions with separate regularizations are pre-defined (e.g., in an atlas space or for distinct foreground and background regions), 2) a registration model where a general spatially-varying regularizer is estimated, and 3) a registration model where the spatially-varying regularizer is obtained via an end-to-end trained deep learning (DL) model. We provide a variational derivation of RDMM, showing that the model can assure diffeomorphic transformations in the continuum, and that LDDMM is a particular instance of RDMM. To evaluate RDMM performance we experiment 1) on synthetic 2D data and 2) on two 3D datasets: knee magnetic resonance images (MRIs) of the Osteoarthritis Initiative (OAI) and computed tomography images (CT) of the lung. Results show that our framework achieves comparable performance to state-of-the-art image registration approaches, while providing additional information via a learned spatio-temporal regularizer. Further, our deep learning approach allows for very fast RDMM and LDDMM estimations. Code is available at https://github.com/uncbiag/registration.</p><p>Preprint. Under review.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Quantitative analysis of medical images frequently requires the estimation of spatial correspondences, i.e.image registration. For example, one may be interested in capturing knee cartilage changes over time, localized changes of brain structures, or how organs at risk move between planning and treatment for radiation treatment. Specifically, image registration seeks to estimate the spatial transformation between a source image and a target image, subject to a chosen transformation model.</p><p>Transformations can be parameterized via low-dimensional parametric models (e.g., an affine transformation), but more flexible models are required to capture subtle local deformations. Such registration models <ref type="bibr" target="#b2">[3,</ref><ref type="bibr" target="#b32">32]</ref> may have large numbers of parameters, e.g., a large number of B-spline control points <ref type="bibr" target="#b30">[30]</ref> or may even be non-parametric where vector fields are estimated <ref type="bibr" target="#b4">[5,</ref><ref type="bibr" target="#b21">22]</ref>. Spatial regularity can be achieved by appropriate constraints on displacement fields <ref type="bibr" target="#b13">[14]</ref> or by parameterizing the transformation via integration of a sufficiently regular stationary or time-dependent velocity field <ref type="bibr" target="#b4">[5,</ref><ref type="bibr" target="#b14">15,</ref><ref type="bibr" target="#b38">38,</ref><ref type="bibr" target="#b7">8,</ref><ref type="bibr" target="#b41">41]</ref>. Given sufficient regularization, diffeomorphic transformations can be assured in the continuum. A popular approach based on time-dependent velocity fields is LDDMM <ref type="bibr" target="#b4">[5,</ref><ref type="bibr" target="#b14">15]</ref>.</p><p>Optimal LDDMM solutions are geodesics and minimize a geodesic distance. Consequentially, one may directly optimize over a geodesic's initial conditions in a shooting approach <ref type="bibr" target="#b40">[40]</ref>.</p><p>Most existing non-parametric image registration approaches use spatially-invariant regularizers. However, this may not be realistic. E.g., when registering inhale to exhale images of a lung one expects large deformations of the lung, but not of the surrounding tissue. Hence, a spatially-varying regularization would be more appropriate. As the regularizer encodes the deformation model this then allows anticipating different levels of deformation at different image locations. <ref type="figure">Figure 1</ref>: RDMM registration example. The goal is to register the dark blue area with high fidelity (i.e., allowing large local deformations), while assuring small deformations in the cyan area. Initially (t = 0), a spatially-varying regularizer (fifth column) is specified in the source image space, where dark blue indicates small regularization and yellow large regularization. Specifically, regularizer values indicate effective local standard deviations of a local multi-Gaussian regularizer. Since the transformation map and the regularizer are both advected according to the estimated velocity field, the shape of the regularizer follows the shape of the deforming dark blue region and is of the same shape as the region of interest in the target space at the final time (t = 1) (as can be seen in the second and the last columns). Furthermore, objects inside the dark blue region are indeed aligned well, whereas objects in the cyan region were not strongly deformed due to the larger regularization there.</p><p>While spatially-varying regularizers may be used in LDDMM variants <ref type="bibr" target="#b31">[31]</ref> existing approaches do not allow for time-varying spatially-varying regularizers. However, such regularizers would be natural for large displacement as they can move with a deforming image. Hence, we propose a family of registration approaches with spatio-temporal regularizers based on advecting spatially-varying regularizers via an estimated spatio-temporal velocity field. Specifically, we extend LDDMM theory, where the original LDDMM model becomes a special case. In doing so, our entire model, including the spatio-temporal regularizer is expressed via the initial conditions of a partial differential equation. We propose three different approaches based on this model: 1) A model for which the regularizer is specified region-by-region. This would, for example, be natural when registering a labeled atlas image to a target image, as illustrated in <ref type="figure">Fig. 1</ref>. 2) A model in which the regularizer is estimated jointly with the spatio-temporal velocity fields. 3) A deep learning model which predicts the regularizer and the initial velocity field, thereby resulting in a very fast registration approach.</p><p>Related Work Only limited work <ref type="bibr" target="#b25">[26,</ref><ref type="bibr" target="#b26">27,</ref><ref type="bibr" target="#b36">36,</ref><ref type="bibr" target="#b39">39]</ref> on spatially-varying regularizers exists. The most related work <ref type="bibr" target="#b22">[23]</ref> learns a spatially-varying regularizer for a stationary velocity field registration model. In <ref type="bibr" target="#b22">[23]</ref> both the velocity field and the regularizer are assumed to be constant in time. In contrast, both are time-dependent in RDMM. Spatially-varying regularization has also been addressed from a Bayesian view in <ref type="bibr" target="#b34">[34]</ref> by putting priors on B-spline transformation parameters. However, metric estimation in <ref type="bibr" target="#b34">[34]</ref> is in a fixed atlas-space, whereas RDMM addresses general pairwise image registration.</p><p>Contributions: 1) We propose RDMM, a new registration model for large diffeomorphic deformations with a spatio-temporal regularizer capable of following deforming objects and thereby providing a more natural representation of deformations than existing non-parametric models, such as LDDMM.</p><p>2) Via a variational formulation we derive shooting equations that allow specifying RDMM solutions entirely based on their initial conditions: an initial momentum field and an initial spatially-varying regularizer. 3) We prove that diffeomorphisms can be obtained for RDMM in the continuum for sufficiently regular regularizers. 4) We explore an entire new family of registration models based on RDMM and provide optimization-based and very fast deep-learning-based approaches to estimate the initial conditions of these registration models. 5) We demonstrate the utility of our approach via experiments on synthetic data and on two 3D medical image datasets.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Standard LDDMM Model</head><p>LDDMM <ref type="bibr" target="#b4">[5]</ref> is a non-parametric registration approach based on principles from fluid mechanics. It is based on the estimation of a spatio-temporal velocity field v(t, x) from which the sought-for spatial transformation ϕ can be computed via integration of ∂ t ϕ(t, x) = v(t, ϕ(t, x)) . For appropriately regularized velocity fields <ref type="bibr" target="#b12">[13]</ref>, diffeomorphic transformations can be guaranteed. The optimization problem underlying LDDMM for images can be written as (∇ being the gradient; ·, · indicating the inner product)</p><formula xml:id="formula_0">v * = argmin v 1 2 1 0 v(t) 2 L dt + Sim(I(1), I 1 ), s.t. ∂ t I + ∇I, v = 0; I(0) = I 0 . (2.1)</formula><p>Here, the goal is to register the source image I 0 to the target image I 1 in unit time. Sim(A, B) is a similarity measure between images, often sum of squared differences, normalized cross correlation, or mutual information. Furthermore, we note that I(1, y) = I 0 • ϕ −1 (1, y), where ϕ −1 denotes the inverse of ϕ in the target image space. The evolution of this map can be expressed as</p><formula xml:id="formula_1">∂ t ϕ −1 + Dϕ −1 v = 0 , (2.2)</formula><p>where D denotes the Jacobian. Equivalently, in Eq. (2.1), we directly advect the image <ref type="bibr" target="#b14">[15,</ref><ref type="bibr" target="#b40">40]</ref> via ∂ t I + ∇I, v = 0. To assure smooth transformations, LDDMM penalizes non-smooth velocity fields via the norm v 2 L = Lv, v , where L is a differential operator. At optimality of Eq. (2.1) the Euler-Lagrange equations are (div denoting the divergence) ∂ t I+ ∇I, v = 0, I(0) = I 0 ; ∂ t λ+div(λv) = 0, λ(1) = δ δI <ref type="bibr" target="#b0">(1)</ref> Sim(I(1), I 1 ) = 0; v = L −1 (λ∇I).</p><p>(2.3) Here, λ is the adjoint variable to I, also known as the scalar momentum <ref type="bibr" target="#b14">[15,</ref><ref type="bibr" target="#b40">40]</ref>. As L −1 is a smoother it is often chosen as a convolution, i.e., v = K (λ∇I). Note that m(t, x) := λ∇I is the vector-valued momentum and thus v = K m. One can directly optimize over v solving Eq. (2.3) <ref type="bibr" target="#b4">[5]</ref> or regard Eq. (2.3) as a constraint defining a geodesic path <ref type="bibr" target="#b40">[40]</ref> and optimize over all such solutions subject to a penalty on the initial scalar momentum as well as the similarity measure. Alternatively, one can express 1 these equations entirely with respect to the vector-valued momentum, m, resulting in the Euler-Poincaré equation for diffeomorphisms (EPDiff) <ref type="bibr" target="#b44">[44]</ref>:</p><formula xml:id="formula_2">∂ t m + div(v)m + Dv T (m) + Dm(v) = 0, m(0) = m 0 , v = K m ,<label>(2.4)</label></formula><p>which defines the evolution of the spatio-temporal velocity field based on the initial condition, m 0 , of the momentum, from which the transformation ϕ can be computed using Eq. (2.2). Both (2.3) and (2.4) can be used to implement shooting-based LDDMM <ref type="bibr" target="#b40">[40,</ref><ref type="bibr" target="#b35">35]</ref>. As LDDMM preserves the momentum, v 2 L is constant over time and hence a shooting formulation can be written as  <ref type="bibr" target="#b0">(1)</ref>.</p><formula xml:id="formula_3">m(0) * = argmin m(0) 1 2 v(0) 2 L + Sim(I(1), I 1 ),<label>(2.</label></formula><p>A shooting-formulation has multiple benefits: 1) it allows for a compact representation of ϕ via its initial conditions; 2) as the optimization is w.r.t. the initial conditions, a solution is a geodesic by construction; 3) these initial conditions can be predicted via deep-learning, resulting in very fast registration algorithms which inherit the theoretical properties of LDDMM <ref type="bibr" target="#b43">[43,</ref><ref type="bibr" target="#b42">42]</ref>. We therefore use this formulation as the starting point for RDMM in Sec 3.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Region-Specific Diffeomorphic Metric Mapping (RDMM)</head><p>In standard LDDMM approaches, the regularizer L (equivalently the kernel K) is spatially invariant. While recent work introduced spatially-varying metrics in LDDMM, for stationary velocity fields, or for displacement-regularized registration <ref type="bibr" target="#b26">[27,</ref><ref type="bibr" target="#b31">31,</ref><ref type="bibr" target="#b22">23,</ref><ref type="bibr" target="#b25">26]</ref>, all of these approaches use a temporally fixed regularizer. Hereafter, we generalize LDDMM by advecting a spatially-varying regularizer via the estimated spatio-temporal velocity field. Standard LDDMM is a special case of our model.</p><p>Following <ref type="bibr" target="#b22">[23]</ref>, we introduce (V i ) i=0,...,N −1 a finite family of reproducing kernel Hilbert spaces (RKHS) which are defined by the pre-defined Gaussian kernels K σi with σ 0 &lt; . . . &lt; σ N −1 . We use a partition of unity w i (x, t), i = 0, . . . , N − 1, on the image domain. As we want the kernel K σi to be active on the region determined by w i we introduce the vector field v =</p><formula xml:id="formula_4">N −1 i=0 w i ν i for ν i ∈ V i .</formula><p>On this new space of vector fields, there exists a natural RKHS structure defined by</p><formula xml:id="formula_5">v 2 L := inf N −1 i=0 ν i 2 Vi | v = N −1 i=0 w i ν i , (3.1) whose kernel is K = N −1 i=0 w i K σi w i . Thus the velocity reads (see suppl. 7.1 for the derivation) v = K m def. = N −1 i=0 w i K σi (w i m), w i ≥ 0 ,<label>(3.2)</label></formula><p>which can capture multi-scale aspects of deformation <ref type="bibr" target="#b27">[28]</ref>. In LDDMM, the weights are constant and pre-defined. Here, we allow spatially-dependent weights w i (x). In particular (see formulation below), we advect them via, v(t, x) thereby making them spatio-temporal, i.e., w i (t, x). In this setup, weights only need to be specified at initial time t = 0. As the Gaussian kernels are fixed convolutions can still be efficiently computed in the Fourier domain.</p><p>We prove (see suppl. 7.4 for the proof) that, for sufficiently smooth weights w i , the velocity field is bounded and its flow is a diffeomorphism. Following <ref type="bibr" target="#b22">[23]</ref>, to assure the smoothness of the initial weights we instead optimize over initial pre-weights,</p><formula xml:id="formula_6">h i (0, x) ≥ 0, s.t. w i (0, x) = G σ h i (0, x),</formula><p>where G σ is a fixed Gaussian with a small standard deviation, σ. In addition, we constrain subject to the constraints</p><formula xml:id="formula_7">∂ t I + ∇I, v = 0, I(0) = I 0 ; ∂ t h i + ∇h i , v = 0, h i (0) = (h i ) 0 ; (3.4) ν i = K σi (w i m); v = N −1 i=0 w i ν i ; w i = G σ h i .</formula><p>As for LDDMM, we can compute the optimality conditions for Eq. (3.3) which we use for shooting.</p><p>Theorem 1 (Image-based RDMM optimality conditions). With the adjoints γ i (for h i ) and λ (for I) and the momentum m := λ∇I + N −1 i=0 γ i ∇h i the optimality conditions for (3.3) are:</p><formula xml:id="formula_8">∂ t I + ∇I, v = 0, I(0) = I 0 ; ∂ t λ + div(λv) = 0, − λ(1) + δ δI(1)</formula><p>Sim(I(1), I 1 ) = 0; (3.5)</p><formula xml:id="formula_9">∂ t h i + ∇h i , v = 0, h i (0) = (h i ) 0 ; (3.6) ∂ t γ i + div(γ i v) = G σ (m · ν i ), γ i (0) + δ δh i (0) Reg({h i (0)}) = 0 . (3.7)</formula><p>subject to  <ref type="formula">(1)</ref>). They are:</p><formula xml:id="formula_10">ν i = K σi (w i m); v = N −1 i=0 w i ν i ; w i = G σ h i .<label>(3.</label></formula><formula xml:id="formula_11">∂ t ϕ −1 + Dϕ −1 v = 0, ϕ −1 (0, x) = x , (3.9) ∂ t m + div(v)m + Dv T (m) + Dm(v) = N −1 i=0 G σ (m · ν i )∇h i , m(0) = m 0 , (3.10) where h i (t, x) = h i (0, x) • ϕ(t,</formula><p>x) −1 and subject to the constraints of Eq. (3.8) which define the relationship between the velocity and the momentum.</p><p>For spatially constant pre-weights, we recover EPDiff from the momentum-based RDMM optimality conditions. Instead of advecting h i via ϕ(t, x) −1 , we can alternatively advect the pre-weights directly,</p><formula xml:id="formula_12">as ∂ t h i + ∇h i , v = 0, h i (0) = (h i ) 0 .</formula><p>For the image-based and the momentum-based formulations, the velocity field v is obtained by smoothing the momentum, v =</p><formula xml:id="formula_13">N −1 i=0 w i K σi (w i m).</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Regularization of the Regularizer</head><p>Given the standard deviations σ 0 &lt; . . . &lt; σ N −1 of Eq. (3.2), assigning larger weights to the Gaussians with larger standard deviation will result in smoother (i.e., more regular) and therefore simpler transformations. To encourage choosing simpler transformations we follow <ref type="bibr" target="#b22">[23]</ref>, where a simple optimal mass transport (OMT) penalty on the weights is used. Such an OMT penalty is sensible as the non-negative weights, {w i }, sum to one and can therefore be considered a discrete probability distribution. The chosen OMT penalty is designed to measure differences from the probability distribution assigning all weight to the Gaussian with the largest standard deviation, i.e., w N −1 = 1 and all other weights being zero. Specifically, the OMT penalty of <ref type="bibr" target="#b22">[23]</ref> </p><formula xml:id="formula_14">is log σ N −1 σ0 −s N −1 i=0 w i log σ N −1 σi s</formula><p>, where s is a chosen power. To make the penalty more consistent with penalizing weights for a standard multi-Gaussian regularizer (as our regularizer contains effectively the weights squared) we do not penalize the weights directly, but instead penalize their squares using the same form of OMT penalty. Further, as the regularization only affects the initial conditions for the pre-weights, the evolution equations for the optimality conditions (i.e., the modified EPDiff equation) do not change. Additional regularizers, such as total variation terms as proposed in <ref type="bibr" target="#b22">[23]</ref>, are possible and easy to integrate into our RDMM framework as they only affect initial conditions. For simplicity, we focus on regularizing via OMT.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Shooting Formulation</head><p>As energy is conserved (see suppl. 7.3 for the proof) the momentum-based shooting formulation becomes </p><formula xml:id="formula_15">m(0) * , {h i (0) * } = argmin m(0),{hi(0)} 1 2 v(0) 2 L + Sim(I(1), I 1 ) + Reg({h i (0)}) ,<label>(3.</label></formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Learning Framework</head><p>The parameters for RDMM, i.e., the initial momentum and the initial pre-weights, can be obtained by numerical optimization, either over the momentum and the pre-weights or only over the momentum if the pre-weights are prescribed. Just as for the LDDMM model, such a numerical optimization is computationally costly. Consequentially, various deep-learning (DL) approaches have been proposed to instead predict displacements <ref type="bibr" target="#b3">[4,</ref><ref type="bibr" target="#b5">6]</ref>, stationary velocity <ref type="bibr" target="#b29">[29]</ref> or momentum fields <ref type="bibr" target="#b43">[43,</ref><ref type="bibr" target="#b22">23]</ref>. Supervised <ref type="bibr" target="#b43">[43,</ref><ref type="bibr" target="#b42">42]</ref> and unsupervised <ref type="bibr" target="#b15">[16,</ref><ref type="bibr" target="#b10">11,</ref><ref type="bibr" target="#b17">18,</ref><ref type="bibr" target="#b3">4,</ref><ref type="bibr" target="#b9">10]</ref> DL registration approaches exist. All of them are fast as only a regression solution needs to be evaluated at test time and no further numerical optimization is necessary. Additionally, such DL models benefit from learning over an entire population instead of relying only on information from given image-pairs.</p><p>Most non-parametric registration approaches are not invariant to affine transformations based on the chosen regularizers. Hence, for such non-parametric methods, affine registration is typically performed first as a pre-registration step to account for large, global displacements or rotations. Similarly, we make use of a two-step learning framework ( <ref type="figure">Fig. 2 (left)</ref>) learning affine transformations <ref type="figure">Figure 2</ref>: Illustration of the learning framework (left) and its non-parametric registration component (right). A multi-step affine-network first predicts the affine transformation map <ref type="bibr" target="#b33">[33]</ref> followed by an iterable non-parametric registration to estimate the final transformation map. The LDDMM component uses one network to generate the initial momentum. RDMM also uses a second network to predict the initial regularizer pre-weights. We integrate the RDMM evolution equations at lowresolution (based on the predicted initial conditions) to save memory. The final transformation map is obtained via upsampling. See suppl. 7.6 for the detailed structure of the LDDMM/RDMM units. and subsequent non-parametric deformations separately. For the affine part, a multi-step affine network is used to predict the affine transformation following <ref type="bibr" target="#b33">[33]</ref>. For the non-parametric part, we use two different deep learning approaches, illustrated in the right part of <ref type="figure">Fig. 2</ref>, to predict 1) the LDDMM initial momentum, m 0 , in Eq. (2.5) and 2) the RDMM initial momentum, m 0 , and the pre-weights, {h i (0) * }, in Eq. (3.11). Overall, including the affine part, we use two networks for LDDMM prediction and three networks for RDMM prediction.</p><p>We use low-resolution maps and map compositions for the momentum and the pre-weight networks. This reduces computational cost significantly. The final transformation map is obtained via upsampling, which is reasonable as we assume smooth transformations. We use 3D UNets <ref type="bibr" target="#b8">[9]</ref> for momentum and pre-weight prediction. Both the affine and the non-parametric networks can be iterated to refine the prediction results: i.e. the input source image and the initial map are replaced with the currently warped image and the transformation map respectively for the next iteration.</p><p>During training of the non-parametric part, the gradient is first backpropagated through the differentiable interpolation operator, then through the LDDMM/RDMM unit, followed by the momentum generation network and the pre-weight network.</p><p>Inverse Consistency: For the DL approaches we follow <ref type="bibr" target="#b33">[33]</ref> and compute bidirectional (source to target denoted as st and target to source denoted as ts ) registration losses and an additional symmetry loss,</p><formula xml:id="formula_16">(ϕ st ) −1 • (ϕ ts ) −1 − id 2 2 ,</formula><p>where id refers to the identity map. This encourages symmetric consistency.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Experimental Results and Setup</head><p>Datasets: To demonstrate the behavior of RDMM, we evaluate the model on three datasets: 1) a synthetic dataset for illustration, 2) a 3D computed tomography dataset (CT) of a lung, and 3) a large 3D magnetic resonance imaging (MRI) dataset of the knee from the Osteoarthritis Initiative (OAI). The synthetic dataset consists of three types of shapes (rectangles, triangles, and ellipses). There is one foreground object in each image with two objects inside and at most five objects outside. Each source image object has a counterpart in the target image; the shift, scale, and rotations are random. We generated 40 image pairs of size 200 2 for evaluation. <ref type="figure">Fig. 1</ref> shows example synthetic images. The lung dataset consists of 49 inspiration/expiration image pairs with lung segmentations. Each image is of size 160 3 . We register from the expiration phase to the inspiration phase for all 49 pairs. The OAI dataset consists of 176 manually labeled MRI from 88 patients (2 longitudinal scans per patient) and 22,950 unlabeled MR images from 2,444 patients. Labels are available for femoral and tibial cartilage. We divide the patients into training (2,800 pairs), validation (50 pairs) and testing groups (300 pairs), with the same evaluation settings as for the cross-subject experiments in <ref type="bibr" target="#b33">[33]</ref>.</p><p>Deformation models: Affine registration is performed before each LDDMM/RDMM registration.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Affine model:</head><p>We implemented a multi-scale affine model solved via numerical optimization and a multi-step deep neural network to predict the affine transformation parameters.</p><p>Family of non-parametric models: We implemented both optimization and deep-learning versions of a family of non-parametric registration methods: a vector-momentum based stationary velocity field model (vSVF) (v(x), w = const), LDDMM (v(t, x), w = const), and RDMM (v(t, x), w(t, x)). We use the dopri5 solver using the adjoint sensitivity method <ref type="bibr" target="#b6">[7]</ref> to integrate the evolution equations in time. For solutions based on numerical optimization, we use a multi-scale strategy with L-BGFS <ref type="bibr" target="#b18">[19]</ref> as the optimizer. For the deep learning models, we compute solutions for a low-resolution map (factor of 0.5) which is then upsampled. We use Adam <ref type="bibr" target="#b16">[17]</ref> for optimization.</p><p>Image similarity measure: We use multi-kernel Localized Normalized Cross Correlation (mk-LNCC) <ref type="bibr" target="#b33">[33]</ref>. mk-LNCC computes localized normalized cross correlation (NCC) with different window sizes and combines these measures via a weighted sum.</p><p>Weight visualization: To illustrate the behavior of the RDMM model, we visualize the estimated standard deviations, i.e.the square root of the local variance σ 2 (x) =</p><formula xml:id="formula_17">N −1 i=0 w 2 i (x)σ 2 i .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Estimation approaches:</head><p>To illustrate different aspects of our approach we perform three types of RDMM registrations: 1) registration with a pre-defined regularizer (Sec. 5.1), 2) registration with simultaneous optimization of the regularizer, via optimization of the initial momentum and pre-weights (Sec. 5.2), and 3) registration via deep learning predicting the initial momentum and regularizer pre-weights (Sec. 5.3). Detailed settings for all approaches are in the suppl. 7.8.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Registration with a pre-defined regularizer</head><p>To illustrate the base capabilities of our models, we prescribe an initial spatially-varying regularizer in the source image space. We show experimental results for pair-wise registration of the synthetic data as well as for the 3D lung volumes. <ref type="figure">Fig. 1</ref> shows the registration result for an example synthetic image pair. We use small regularization in the blue area and large regularization in the surrounding area. As expected, most of the deformations occur inside the blue area as the regularizer is more permissive there. We also observe that the regularizer is indeed advected with the image. For the real lung image data we use a small regularizer inside the lung (as specified by the given lung mask) and a large regularizer in the surrounding tissue. <ref type="figure" target="#fig_2">Fig. 3</ref> shows that most of the deformations are indeed inside the lung area while the deformation outside the lung is highly regularized as desired. We evaluate the Dice score between the warped lung and the target lung, achieving 95.22% on average (over all inhalation/exhalation pairs). <ref type="figure" target="#fig_2">Fig. 3</ref> also shows the determinant of the Jacobian of the transformation map J ϕ −1 (x) := |Dϕ −1 (x)| (defined in target space): the lung region shows small values (illustrating expansion) while other region are either volume preserved (close to 1) or compressed (bigger than 1). Overall the deformations are smooth. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Registration with an optimized regularizer</head><p>In contrast to the experiments in Sec. 5.1, we jointly estimate the initial momentum and the initial regularizer pre-weights for pairwise registration. We use the synthetic data and the knee MRIs. <ref type="figure" target="#fig_3">Fig. 4</ref> shows that the registration warped every object in the source image to the corresponding object in the target image. The visualization of the initial regularizer shows that low regularization is  Optimization Methods -------Demons <ref type="bibr" target="#b38">[38,</ref><ref type="bibr" target="#b37">37]</ref> 63.47 (9.52) 0.56 114 SyN <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b0">1]</ref> 65.71 (15.01) 0 1330 NiftyReg-NMI <ref type="bibr" target="#b24">[25,</ref><ref type="bibr" target="#b19">20,</ref><ref type="bibr" target="#b30">30,</ref><ref type="bibr" target="#b20">21]</ref> 59.65 <ref type="bibr">(7.</ref>  That low regularization values are localized is sensible as the OMT regularizer prefers spatially sparse solutions (in the sense of sparsely assigning low levels of regularity). If the desired deformation model is piecewise constant our RDMM model could readily be combined with a total variation penalty as in <ref type="bibr" target="#b22">[23]</ref>. <ref type="figure" target="#fig_4">Fig. 5</ref> compares average Dice scores for all objects for vSVF, LDDMM and RDMM separately. They all achieve high and comparable performance indicating good registration quality. But only RDMM provides additional information about local regularity.</p><p>We further evaluate RDMM on 300 images pairs from the OAI dataset. The optimization methods section of Tab. 6 compares registration performance for different optimization-based algorithms. RDMM achieves high performance. While RDMM is in theory diffeomorphic, we observe some foldings, whereas no such foldings appear for LDDMM and SVF. This is likely due to inaccuracies when discretizing the evolution equations and when discretizing the determinant of the Jacobian. Further, RDMM may locally exhibit stronger deformations than LDDMM or vSVF, especially when the local regularization (via OMT) is small, making it numerically more challenging. Most of the folds appear at the image boundary (and are hence likely due to boundary discretization artifacts) or due to anatomical inconsistency in the source and target images, where large deformations may be estimated.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3">Registration with a learnt regularizer via deep learning</head><p>Finally, we evaluate our learning framework for non-parametric registration approaches on the OAI dataset. For vSVF, we follow <ref type="bibr" target="#b33">[33]</ref> to predict the momentum. We implement the same approach for LDDMM, where the vSVF inference unit is replaced by one for LDDMM (i.e., instead of advecting via a stationary velocity field we integrate EPDiff). Similarly, for RDMM, the inference unit is replaced by the evolution equation for RDMM and we use an additional network to predict the regularizer pre-weights. <ref type="figure" target="#fig_5">Fig. 6</ref> shows the results. The non-parametric DL models achieve comparable <ref type="figure">Figure 7</ref>: Illustration of RDMM registration results on the OAI dataset. "* s" and "* b" refer to the regularizer with σ in G σ set to 0.04 and 0.06 respectively; "learn *" and "opt *" refer to a learnt regularizer and an optimized one respectively; "Jaco" refers to the absolute value of the determinant of the Jacobian; "init_w" refers to the initial weight map of the regularizer (as visualized via σ(x)).</p><p>The first four columns refer to registration results in image space.</p><p>performance to their optimization counterparts, but are much faster, while learning-based RDMM simultaneously predicts the initial regularizer which captures aspects of the knee anatomy. <ref type="figure">Fig. 7</ref> shows the determinant of the Jacobian of the transformation map. It is overall smooth and folds are much less frequent than for the corresponding optimization approach, because the DL model penalizes transformation asymmetry. <ref type="figure">Fig. 7</ref> also clearly illustrates the benefit of training the DL model based on a large image dataset: compared with the optimization approach (which only works on individual image pairs), the initial regularizer predicted by the deep network captures anatomically meaningful information much better: the bone (femur and tibia) and the surrounding tissue show large regularity.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Conclusion and Future Work</head><p>We introduced RDMM, a generalization of LDDMM registration which allows for spatially-varying regularizers advected with a deforming image. In RDMM, both the estimated velocity field and the estimated regularizer are time-and spatially-varying. We used a variational approach to derive shooting equations which generalize EPDiff and allow the parameterization of RDMM using only the initial momentum and regularizer pre-weights. We also prove that diffeomorphic transformation can be obtained for RDMM with sufficiently regular regularizers. Experiments with pre-defined, optimized, and learnt regularizers show that RDMM is flexible and its solutions can be estimated quickly via deep learning. Future work could focus on numerical aspects and explore different initial constraints, such as totalvariation constraints, depending on the desired deformation model. Indeed, a promising avenue of research consists in learning regularizers which include more physical/mechanical a-priori information in the deformation model. For instance, a possible first step in this direction consists in parameterizing non-isotropic kernels to favor deformations in particular directions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">Supplementary Material</head><p>This supplementary material provides additional details illustrating the proposed approach. We start by deriving the form of the smoothing kernel for the RDMM model in Sec. 7.1. Based on this kernel form we can then detail the derivation of the RDMM optimality conditions in Sec. 7.2. In Sec. 7.3, we prove that the regularization energy is conserved over time, which allows formulating our RDMM shooting strategy based on initial conditions only. Sec. 7.4 details the good theoretical behavior of our model. Sec. 7.5 describes the optimization/training strategy with regard to the the initial pre-weight regularization. Sec. 7.6 visualizes the inference process of the LDDMM/RDMM method. Sec. 7.7 analyzes the behavior of the OMT term. Lastly, Sec. 7.8 details the settings of our experiments.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.1">Variational Derivation of the Smoothing Kernel</head><p>The derivation of our RDMM model makes use of a smoothing kernel of the form K = N −1 i=0 w i K σi w i . This kernel form is a direct consequence of the definition of our variational definition of the smoothing kernel.</p><p>Recall that similar to <ref type="bibr" target="#b22">[23]</ref> we define</p><formula xml:id="formula_18">v 2 L := inf N −1 i=0 ν i 2 Vi | v = N −1 i=0 w i ν i , (7.1)</formula><p>for a given velocity field v. To compute an explicit form of the norm v 2 L we need to solve the constrained optimization problem of this definition. Specifically, we introduce the vector-valued Lagrange multiplier m. Thus the Lagrangian, L, becomes 2</p><formula xml:id="formula_19">L({ν i }, m) = N −1 i=0 1 2 ν i 2 Vi − m, w i ν i − v = N −1 i=0 1 2 L i ν i , ν i − m, w i ν i − v . (7.2)</formula><p>The variation of the Lagrangian is</p><formula xml:id="formula_20">δL({ν i }, m; {δν i }, δm) = N −1 i=0 L i ν i , δν i − δm, w i ν i − v − m, w i δν i . (7.3)</formula><p>By collecting all the terms, the optimality conditions (i.e., where the variation vanishes) are</p><formula xml:id="formula_21">L i ν i = w i m, ∀i and v = N −1 i=0 w i ν i . (7.4)</formula><p>Hence, we can write the norm v(t) 2 L in the following form :</p><formula xml:id="formula_22">v 2 L = N −1 i=0 L i ν * i , ν * i = N −1 i=0 w i m, L −1 i w i m = N −1 i=0 m, w i K σi (w i m) . (7.5)</formula><p>Consequentially, the associated kernel is K =</p><formula xml:id="formula_23">N −1 i=0 w i K σi w i .</formula><p>Assuming the kernel can be written as a convolution, we can therefore express the velocity as:</p><formula xml:id="formula_24">v = N −1 i=0 w i ν i = N −1 i=0 w i K σi (w i m) .</formula><p>(7.6)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.2">Optimality Conditions</head><p>In this section we derive the RDMM optimality conditions. Both for the image-based and the momentum-based cases. Recall that the overall registration energy of RDMM can be written as:</p><formula xml:id="formula_25">E(v, I, {h i }) = 1 2 1 0 v(t) 2</formula><p>L dt + Sim(I(1), I 1 ) + Reg({h i (0)}) (7.7) <ref type="bibr" target="#b1">2</ref> We multiply the objective function by 1 2 for convenience. This does not change the solution.</p><p>under the constraints 3</p><formula xml:id="formula_26">             I t + ∇I, v = 0, I(0) = I 0 , (h i ) t + ∇h i , v = 0, h i (0) = (h i ) 0 , w i = G σ h i , ν i = K σi (w i m), v = N −1 i=0 w i ν i . (7.8)</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Proof of Thm. (1)</head><p>We compute the variations of the Lagrangian, L to the energy (i.e., where constraints are added via Lagrangian multipliers) with respect to v, λ, I, {h i } and {γ i }:</p><formula xml:id="formula_27">δL = ∂ ∂ L (v + dv, I + dI, {h i + dh i }, λ + dλ, {γ i + dγ i )}| =0 = 1 0 1 2 δ( v(t) 2 L ) − dλ, I t + (DI)v − λ, dI t + (DdI)v + (DI)dv − N −1 i=0 { dγ i , h it + (Dh i )v + γ i , dh it + (Ddh i )v + (Dh i )dv } dt + δ δI(1) Sim(I(1), I 1 ), dI(1) + N −1 i=0 δ δh i (0) Reg({h i (0)}), dh i (0) . (7.9)</formula><p>We use </p><formula xml:id="formula_28">γ i , (Ddh i )v = −div(γ i v), dh i + ∂Ω dh i γ i v · dS = −div(γ i v), dh i . (7.13)</formula><p>Now, Eq. (7.9) reads</p><formula xml:id="formula_29">δE = 1 0 1 2 δ( v(t) 2 L ) − dλ, I t + (DI)v + λ t + div(λv), dI + N −1 i=0 {− dγ i , h it + (Dh i )v + γ it + div(γ i v), dh i } − λ∇I + N −1 i=0 γ i ∇h i , dv dt − λ, dI 1 0 − N −1 i=0 γ i , dh i 1 0 + δ δI(1) Sim(I(1), I 1 ), dI(1) + N −1 i=0 δ δh i (0) Reg({h i (0)}), dh i (0) . (7.14)</formula><p>We first collect dI(1) and dh i (0) to obtain the final condition on λ and the initial condition on γ:</p><p>−λ(1) + δ δI(1) Sim(I(1), I 1 ) = 0, γ i (0) + δ δhi(0) Reg({h i (0)}) = 0 . Next, we work on</p><formula xml:id="formula_30">1 0 1 2 δ( v(t) 2 L ) dt. Remember, we have v = K m def. = N −1 i=0 w i ν i , where ν i = K σi (w i m), w i ≥ 0, thus 1 0 1 2 δ( v(t) 2 L ) dt = 1 0 1 2 dm, v + 1 2 m, N −1 i=0 w i dν i + ν i dw i dt . (7.16)</formula><p>Note that for radially symmetric kernels (such as Gaussian kernels)</p><formula xml:id="formula_31">K = K, K * a, b = K * b K * a, b = ∞ x=−∞ ∞ y=−∞ K(x − y)a(y) b(x)dx = ∞ y=−∞ a(y) ∞ x=−∞ K(x − y)b(x)dxdy = ∞ y=−∞ a(y) ∞ x=−∞ K(y − x) K(x):K(−x) b(x)dxdy = ∞ x=−∞ a(x) ∞ y=−∞ K(x − y)b(y)dydx = a, K * b . (7.17)</formula><p>Thus, we can get Next, we decompose the λ∇I + N −1 i=0 γ i ∇h i , dv terms. We define the momentum, m = λ∇I +</p><formula xml:id="formula_32">1 2 ν i dw i + w i dν i , m = 1 2 dw i K σi (w i m) + w i K σi (dw i m + w i dm), m = 1 2 m T K σi (w i m), dw i + 1 2 w i m, K σi (dw i m) + 1 2 w i m, K σi (w i dm) = 1 2 m T K σi (w i m), dw i + 1 2 m T K σi (w i m), dw i + 1 2 w i K σi (w i m), dm = G σ (m T ν i ), dh i + 1 2 w i ν i , dm .</formula><formula xml:id="formula_33">N −1 i=0 γ i ∇h i . λ∇I + N −1 i=0 γ i ∇h i , dv = m, N −1 i=0 dw i K σi (w i m) + w i K σi (dw i m + w i dm) = N −1 i=0 m T K σi (w i m), dw i + m T K σi * (w i m), dw i + w i K σi (w i m), dm = N −1 i=0 G σ [m T K σi (w i m) + m T K σi (w i m)], dh i + w i K σi (w i m), dm = N −1 i=0 2 G σ (m T ν i ), dh i + w i ν i , dm .</formula><p>Now, we can collect the variation dh i for h i and dm for m and obtain the optimality conditions</p><formula xml:id="formula_34">−G σ (m T ν i ) + γ it + div(γ i v) = 0, (7.20) v − N −1 i=0 w i ν i = 0 . (7.21)</formula><p>Finally, we get the optimality conditions for image-based RDMM derived from Eq. (7.7) and Eq. (7.8):</p><formula xml:id="formula_35">                 I t + ∇I, v = 0, I(0) = I 0 , h it + ∇h i , v = 0, h i (0) = (h i ) 0 , λ t + div(λv) = 0 , γ it + div(γ i v) = G σ (m · ν i ) , −λ(1) + δ δI(1) Sim(I(1), I 1 ) = 0 , γ i (0) + δ δhi(0) Reg({h i (0)}) = 0 , (7.22) where ν i = K σi (w i m) and m = λ∇I + N −1 i=0 γ i ∇h i .</formula><p>Proof of Thm.</p><p>(2) We now derive the optimality conditions for the momentum-based formulation of RDMM. We start by taking the time derivative of the momentum and obtain</p><formula xml:id="formula_36">−m t = −(λ∇I) t − ( N −1 i=0 ∇h i γ i ) t (7.23) = −λ t ∇I − λ∇I t − N −1 i=0 {γ it ∇h i + γ i ∇(h it )} . (7.24)</formula><p>By substituting the time derivatives λ t , I t , γ it , and h it from Eq. (7.22) we obtain</p><formula xml:id="formula_37">−m t = div(λv)∇I + λ∇(∇I T v) + N −1 i=0 div(γ i v) − G σ (m T ν i ) ∇h i + γ i ∇(∇h T i v) . (7.25)</formula><p>Using the following two relations,</p><formula xml:id="formula_38">div(λv) = ∇λ T v + λdiv(v) and ∇(∇I T v) = HIv + (Dv) T ∇I (7.26)</formula><p>where D denotes the Jacobian and H the Hessian, we can rewrite Eq. (7.25) as −m t = ((∇λ) T v + λdiv(v))∇I + λ(HIv + (Dv) T ∇I) (7.27)</p><formula xml:id="formula_39">+ N −1 i=0 (∇γ i ) T v + γ i div(v) − G σ (m T ν i ) ∇h i + γ i (Hh i v + (Dv) T ∇h i (7.28) = (λ∇I + N −1 i=0 γ i ∇h i )div(v) + (Dv) T [λ∇I + N −1 i=0 γ i ∇h i ] + (∇λ T v)∇I (7.29) + λHIv + N −1 i=0 (∇γ i ) T v ∇h i + γ i Hh i v − G σ (m T ν i )∇h i . (7.30)</formula><p>Noticing that D(λ∇I)v = λHIv + ∇λ T v∇I (7.31) we can write</p><formula xml:id="formula_40">(∇λ T v)∇I + λHIv + N −1 i=0 ((∇γ i ) T v)∇h i + γ i Hh i v (7.32) = D(λ∇I)v + N −1 i=0 D(γ i ∇h i )v = (Dm)v . (7.33)</formula><p>Finally, we get</p><formula xml:id="formula_41">−m t = mdiv(v) + (Dv) T m + (Dm)v − N −1 i=0 G σ (m T ν i )∇h i ,<label>(7.34)</label></formula><p>which gives the result.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.3">Energy Conservation</head><p>To formulate a shooting-based solution we would like to avoid integrating v 2 L over time. We here show that this quantity is conserved. Hence, 1 0 v 2 L dt = v(0) 2 L , which allows us to write our shooting equations only with respect to initial conditions subject to the momentum-based evolution equations of RDMM.</p><p>Recall that the energy is preserved by the EPDiff equation since it can alternatively be written as</p><formula xml:id="formula_42">∂ t m + ad * v m = 0 ,<label>(7.35)</label></formula><p>where ad * is the adjoint of ad v w := dv(w) − dw(v). It implies that</p><formula xml:id="formula_43">d dt m, K m = −2 ad * v m, K m = m, ad v v = 0 , since ad v v = 0.</formula><p>In fact, there is more than conservation of the energy, since the momentum is actually advected along the flow. Now, formula (3.9) can be shortened as ∂ t m+ad * v m = i G σ (m T ν i )∇h i and it implies that, denoting the kernel K(w i ) to shorten the notations,</p><formula xml:id="formula_44">d dt m, K(w i ) m = −2 ad * v m, K(w i ) m + 2 i G σ (m T ν i )∇h i , v + 2 m, i ∂ t w i ν i = 2 i G σ (mν i )∇h i , v + 2 m, i (∂ t w i )ν i = 0</formula><p>since the first term vanishes as for the standard EPDiff equation and the two other terms cancel each other since</p><formula xml:id="formula_45">∂ t w i = −G σ ∇h i · v and v = i G σi (w i m).</formula><p>Here we assumed the kernel to be symmetric in writing this equation but the result holds in general, the equations being simply modified with the transpose kernel.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.4">Mathematical properties</head><p>In this section, we prove that given (ν i ) i=0,...,N −1 , there exists a solution ϕ(t) solving Equations (7.7) and <ref type="bibr">(7.8)</ref> at least until a time T &gt; 0 which could be less than 1. The notations · k,∞ or · C k denote the sup norm of C k maps. Theorem 3. Let V N −1 ⊂ . . . ⊂ V 0 and suppose for every ν k ∈ V k , ν k V k ≤ const ν k V1 ≤ const ν k 2,∞ . Given initial weights (h i (t = 0)) N −1 i=0 ∈ L 2 and time dependent vector fields ν i (t) ∈ V i , there exists a unique solution ϕ(t) to Equations (3) until time 1.</p><p>Proof. The first step consists in proving that there exists a solution locally in time. To this end, the proof follows a fixed point argument on the space C 0 ([0, 1], Diff C 1 (Ω)), i.e.the space of continuous curves in Diff C 1 (Ω), for the map T (ϕ) := Fl(v) <ref type="bibr">(7.36)</ref> where v is defined as v[ϕ] := <ref type="figure">ϕ(t, x)</ref>). The existence of the flow associated with v[ϕ] is ensured by standard arguments provided that the Lipschitz constant of v[ϕ] is bounded. It is the case since G σ (x, y) h i (ϕ −1 (t, y)) has a Lipschitz constant bounded by</p><formula xml:id="formula_46">N −1 i=0 G σ h i (ϕ −1 (t, y))ν i (t,</formula><formula xml:id="formula_47">sup x∈Ω |∂ 1 G σ (x, y)| since |h i (ϕ −1 (t, y))| ≤ 1. This gives v[ϕ] 1,∞ ≤ N −1</formula><p>i=0 M ν i 1,∞ and the constant M does not depend on ϕ. A similar inequality holds for the sup norm on the derivatives up to order k provided each space V i continuously embeds in C k .</p><p>One has the inequality T (ϕ)(t) 2,∞ ≤ e t 0 v[ϕ] 2,∞ ds (7.37) and therefore, T (ϕ)(t) 2,∞ is bounded a priori by a positive constant which does not depend on ϕ. Using Gronwall's lemma <ref type="bibr" target="#b5">(6)</ref>, one has also</p><formula xml:id="formula_48">T (ϕ)(t) − T (ψ)(t) 1,∞ ≤ √ t v[ϕ] − w[ψ] L 2 ([0,t],C 1 ) e t 0 (1+ ϕ 1,∞ ) v C 2 ds .<label>(7.38)</label></formula><p>Moreover, by a change of variable y = ϕ(t, x) we have G σ h i (ϕ −1 (t, y)) = G σ (x, ϕ(t, y)) (Jac(ϕ(t, y))h i (y)) (7.39) and therefore</p><formula xml:id="formula_49">G σ h i (ϕ −1 (t, y))ν i − G σ h i (ψ −1 (t, y))ν i C 1 ≤ M ϕ − ψ C 1 ν i C 1 . (7.40) Thus, we deduce the inequality v[ϕ] − w[ψ] L 2 ([0,t],C 1 ) ≤ M sup s∈[0,t] ψ(s) − ϕ(s) C 1 ,<label>(7.41)</label></formula><p>therefore, the map T is a contraction for a time T small enough. Using Equation <ref type="bibr">(7.37)</ref>, it is easily seen that this existence can be applied on [T, 2T ] and iterating this argument shows existence until time t = 1.</p><p>Theorem 4. The variational problem (7.7) under the constraints of Equations (7.8) has a solution.</p><p>Proof. The direct method of calculus of variations can be applied here, see Sect. 7.2. The sum of squared norms are lower semicontinuous; The penalty term as well as the constraints are weakly closed for the weak convergence on (ν i ).</p><p>Lemma 5. Let u, v ∈ L 2 ([0, 1], C 2 ) and let ϕ, ψ be their associated flows. The following estimates hold,</p><formula xml:id="formula_50">ϕ(t) C 2 ≤ e t 0 v(s) C 2 ds ,<label>(7.42)</label></formula><p>and</p><formula xml:id="formula_51">ϕ(t) − ψ(t) C 1 ≤ √ tM u − v L 2 ([0,t],C 1 ) e t 0 (1+ ϕ 1,∞) v C 2 ds . (7.43)</formula><p>where M is a constant that bounds ϕ 1,∞ .</p><p>Proof. Use Gronwall's lemma <ref type="bibr" target="#b5">(6)</ref> recalled below on the following inequality coming from the flow equation</p><formula xml:id="formula_52">ϕ(t) − ψ(t) 1,∞ ≤ t 0 du • ϕ(t) · dϕ(t) − dw • ψ(t) · dψ(t) 0,∞ ds (7.44) ≤ t 0 u − v 1,∞ ϕ 1,∞ + v 2,∞ ϕ 1,∞ ϕ − ψ 0,∞ + dv 1,∞ ϕ − ψ 1,∞ ds (7.45) ≤ t 0 u − v 1,∞ ϕ 1,∞ + (1 + ϕ 1,∞ ) v 2,∞ ϕ − ψ 1,∞ ds . (7.46)</formula><p>Recall that Gronwall's lemma is Hence, instead of computing the advection equation, we update {h i (t)} by interpolating the initial pre-weights {h i (0)} via the current transformation map ϕ −1 (t), which is more computationally efficient and avoids numerical dissipation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.5">Initial Pre-weight Regularization</head><p>The initial regularization term Reg({h i (0)}) determines the behavior of the initial regularizer. In our experiments, </p><formula xml:id="formula_53">Reg({h i (0)}, T ) = λ OMT (T )OM T ({h i (0)}) + λ Range (T )Range({h i (0)}) ,<label>(7.</label></formula><formula xml:id="formula_54">OM T = log σ N −1 σ 0 −s N −1 i=0 w i log σ N −1 σ i s (7.51)</formula><p>where s is the chosen power and</p><formula xml:id="formula_55">Range = G σ (h(0)) − w 0 2 2 (7.52)</formula><p>where w 0 is the pre-defined initial weight. The range loss penalizes differences between the initial weight, w(0), from the pre-defined one, w 0 .</p><p>At the beginning of the optimization/training, it is difficult to jointly optimize over the momentum and the pre-weights. Hence, we constrain the pre-weights by introducing the Range loss that penalizes the difference between the optimized and pre-defined pre-weights. Besides, as we prefer well-regularized (i.e., smooth) transformation, we use the OMT loss to penalize weight assignments to Gaussians with small standard deviations. To solve the original model, the influence of the range penalty needs to diminish while the influence of the OMT term need to increase during training. In practice, we introduce epoch-dependent decay factors:</p><formula xml:id="formula_56">λ T = K K + e T /K , λ Range := C Range λ T , λ OMT = C OMT (1 − λ T ),<label>(7.53)</label></formula><p>where C Range and C OMT are pre-defined constants, K controls the decay rate, and T indicates the iteration/epoch. <ref type="figure">Fig. 8</ref> shows the flow charts for LDDMM and RDMM. Additionally, for RDMM with a pre-defined regularizer, we define {h i (0)} in the source image space, as foreground and background are easier to specify there. For RDMM with an optimized/learnt regularizer we define {h i (0)} in the pre-aligned image space, since the goal is to find the optimal initial conditions that determine the geodesic path based on the RDMM shooting equations; specifically, we take ϕ −1 (0) = id as the input, and the final output composes the initial map and the transformation map, ϕ −1 (1).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.6">LDDMM/RDMM Unit</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.7">Analysis of the OMT term</head><p>This section illustrates the behavior of the OMT term to obtain regular solutions. To understand the behavior of the OMT term, we do some simple analysis. We assume 0 &lt; σ 0 &lt; σ 1 &lt; · · · &lt; σ N −1 <ref type="bibr">(7.54)</ref> where σ i are the standard deviations of the Gaussians. In general, we desire</p><formula xml:id="formula_57">c 0 &gt; c 1 &gt; · · · &gt; c N −1 , (7.55)</formula><p>where c i are the associated costs of assigning a weight to i-th Gaussian. That is, we assume that it gets progressively cheaper to assign to Gaussians with larger standard deviation. However, we do not assume that this is the case in the following derivations. Our OMT penalty term is then of the form</p><formula xml:id="formula_58">f (w) = N −1 i=0 c i w i = c w (7.56) with constraints N −1 i=0 w i − 1 = 1 w − 1 = 0 and w i ≥ 0 . (7.57)</formula><p>To study this term, assume that we have a given target standard deviationσ that we wish to explain via a multi-Gaussian. This results in the constraint</p><formula xml:id="formula_59">N −1 i=0 σ 2 i w i −σ 2 = v w −σ 2 = 0 . (7.58)</formula><p>This optimization problem is linear in the multi-Gaussian weights, w, and consequentially constitutes the following linear program</p><formula xml:id="formula_60">min w f (w) s.t.    1 w − 1 = 0, v w −σ 2 = 0, w i ≥ 0 . (7.59)</formula><p>The Lagrangian of this problem is</p><formula xml:id="formula_61">L(w, λ, γ 1 , γ 2 ) = f (w) − λ w − γ 1 (1 w − 1) − γ 2 (v w −σ 2 ) ,<label>(7.60)</label></formula><p>which results following KKT conditions <ref type="bibr" target="#b23">[24]</ref> c − λ − γ 1 1 − γ 2 v = 0, (7.61) 1 w − 1 = 0, (7.62) v w −σ 2 = 0, (7.63) w ≥ 0, (7.64) λ ≥ 0, (7.65) λ i w i = 0, ∀ i .</p><p>(7.66)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.7.1">Solution on a simplex edge</head><p>Assume a solution candidate for the KKT conditions (Eqs. (7.61)-(7.66)) that only has two zero weights w k &gt; 0, w l &gt; 0, w i = 0 ∀i / ∈ {k, l}, σ k &lt; σ l . (7.67)</p><p>Then, we know w k + w l = 1, σ 2 k w k + σ 2 l w l =σ 2 , λ k = λ l = 0 . (7.68)</p><p>Using Eq. (7.68), we can directly solve for w k and w l and obtain</p><formula xml:id="formula_62">w k = σ 2 l −σ 2 σ 2 l − σ 2 k , w l =σ 2 − σ 2 k σ 2 l − σ 2 k .</formula><p>(7.69) Substituting Eq. (7.84), we can solve for λ i and obtain λ i = c i − c j + γ 2 (σ 2 j − σ 2 i ) . (7.86)</p><p>As all the Lagrangian multipliers, λ, are (by the KKT conditions) required to be non-negative, we obtain the condition c i − c j + γ 2 (σ 2 j − σ 2 i ) ≥ 0 . (7.87)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.7.4">Summary</head><p>In summary, to assure that a solution exists either 1) based on the two Gaussians closest to the desired varianceσ 2 (i.e., a simplex edge) or 2) selecting exactly one of the Gaussians (a simplex vertex), it is desirable to pick a penalty function based on costs from a strictly convex function c = h(σ 2 ). Based on our choice for the OMT penalty: For 0 &lt; x &lt; σ 2 N −1 and r ≥ 1, the second derivative is positive and hence h(x) is strictly convex.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.8">Experimental settings</head><p>For all experiments, we normalize the intensities of each image such that the 0.1th percentile and the 99.9th percentile are mapped to 0, 1 and clamp values that are smaller to 0 and larger to 1 to avoid outliers. We also assume that spatial coordinates of images are in [0, 1] d , where d is the spatial dimension. This makes the interpretation of the standard deviations of the regularizers straightforward.</p><p>Non-parametric family For numerical optimization solutions, we use three image scales {0.25, 0.5 and 1.0}. We use L-BGFS as the optimizer. For the deep learning models, we train the multistep affine network first and then train the non-parametric network with the affine network fixed. For all methods, we use a multi-kernel Gaussian regularizer with standard deviations σ i = {0.05, 0.1, 0.15, 0.2, 0.25}. For both vSVF and LDDMM, we use fixed corresponding weights w 2 0 = {0.067, 0.133, 0.2, 0.267, 0.333}, which is also set as the initial value for the range loss in RDMM.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Baseline methods</head><p>For the numerical optimization approaches, we compare with three public registration tools: NiftyReg <ref type="bibr" target="#b24">[25,</ref><ref type="bibr" target="#b19">20,</ref><ref type="bibr" target="#b30">30,</ref><ref type="bibr" target="#b20">21]</ref>, SyN <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b0">1]</ref> and Demons <ref type="bibr" target="#b38">[38,</ref><ref type="bibr" target="#b37">37]</ref>. Besides, we also compare with two recent deep-learning approaches: VoxelMorph <ref type="bibr" target="#b9">[10]</ref> and AVSM (vSVF-net) <ref type="bibr" target="#b33">[33]</ref>. For a fair comparison, we take the same experimental settings as in <ref type="bibr" target="#b33">[33]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Registration with a pre-defined regularizer</head><p>For the synthetic registration experiments, we use a multi-kernel Gaussian regularizer with standard deviations σ i = {0.03, 0.06, 0.09, 0.3} with initial pre-weights h 2 0 = {0.2, 0.5, 0.3, 0.0} (fixed during the optimization) for the foreground (the dark blue region) and h 2 0 = {0, 0, 0, 1} for the background (the cyan region). The standard deviation for G σ , to smooth the pre-weights, is set to 0.02. For each image scale, we compute 60 registration iterations. For the lung registration we use σ i = {0.04, 0.06, 0.08, 0.2} for the multi-Gaussian regularizer with initial pre-weights h 2 0 = {0.1, 0.4, 0.5, 0} for the foreground (i.e.the lung) and h 2 0 = {0, 0, 0, 1} everywhere outside the lung. We set σ in G σ to 0.05. For each image scale, we compute 60 registration iterations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Registration with an optimized regularizer</head><p>For the synthetic registration experiment, we use σ i = {0.02, 0.04, 0.06, 0.08} for the multi-Gaussian regularizer and the initial pre-weights h 2 0 = {0.1, 0.3, 0.3, 0.3}. These initial value are set at the beginning of the optimization. They are the same for vSVF, LDDMM and RDMM. C Range and C OMT are set to 10 and 0.05 respectively; K is set to 10; σ in G σ is set to 0.05. For image scale {0.25, 0.5 and 1.0}, we compute {100, 100 and 400} iterations, respectively. For the knee MRI registration of the OAI dataset, we use σ i = {0.05, 0.1, 0.15, 0.2, 0.25} for the multi-Gaussian regularizer with the initial pre-weights h 2 0 = {0.067, 0.133, 0.2, 0.267, 0.333} for all non-parametric registration models. C Range and C OMT are set to 1 and 0.25 respectively; K is set to 6; σ in G σ is set to 0.06. For each image scale, we compute 60 registration iterations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Registration with a learnt regularizer</head><p>For the deep learning approaches, the settings are the same as for numerical optimization, as described above. Besides, we include an additional inverse consistency loss, with the scale factor set to 1e-4, for vSVF, LDDMM and RDMM to regularize the deformation.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>N − 1 i=0 h 2 i 2 L</head><label>122</label><figDesc>(0, x) to locally sum to one. The optimization problem for our RDMM model then becomes v * , {h * i } = argmin dt + Sim(I(1), I 1 ) + Reg({h i (0)}) , (3.3)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><label></label><figDesc><ref type="bibr" target="#b10">11)</ref> subject to the evolution equations of Thm. 2. Similarly, the shooting formulation can use the image-based evolution equations of Thm. 1 where optimization would be over λ(0) instead of m(0).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 3 :</head><label>3</label><figDesc>RDMM lung registration result with a pre-defined regularizer. Lung images at expiration (source) are registered to the corresponding inspiration (target) images. Last column: Inside the lung a regularizer with small standard deviation (σ i = {0.04, 0.06, 0.08} , h 2 0 = {0.1, 0.4, 0.5}) and outside the lung with large standard deviation is used (σ i = {0.2}, h 2 0 = {1.0}). Deformations are largely inside the lung, the surrounding tissue is well regularized as expected. Columns 1 to 3 show results in image space while columns 4 to 6 refer to the results in label space. The second to last column shows the determinant of the Jacobian of the spatial transformation, ϕ −1 .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 4 :</head><label>4</label><figDesc>Illustration of the RDMM registration results with an optimized regularizer on the synthetic dataset. All objects are warped from the source image space to the target image space. The last two columns show the regularizer (σ(x)) at t = 0 and t = 1 respectively.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 5 :</head><label>5</label><figDesc>Average Dice scores for all objects. Left to right: SVF, LD-DMM and RDMM.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 6 :</head><label>6</label><figDesc>Comparison of registration methods for cross-subject registrations on the OAI dataset based on Dice scores. -opt and -net refer to optimization-and DL-based methods respectively. For all DL methods, we report performance after two-step refinement. Folds refers to the absolute value of the sum of the determinant of the Jacobian in the folding area (i.e., where the determinant of the Jacobian is negative); Time refers to the average registration time for a single image pair. assigned close to object edges making them locally deformable. The visualizations of the regularizer at the initial time point (t = 0) and the final time point (t = 1) show that it deforms with the image.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>1 0λ, dI t dt = 1 0γ i , dh it dt = 1 0</head><label>111</label><figDesc>−λ t , dI dt + λ, dI 1 0 . (7.10)According to Green's theorem and assuming v vanishes on the boundary, we getλ, (DdI)v = −div(λv), dI + ∂Ω dIλv · dS = −div(λv), dI . −γ it , dh i dt + γ i , dh i</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>G</head><label></label><figDesc>σ (m T ν i ), dh i dt .(7.19)    </figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Lemma 6 .Figure 8 :</head><label>68</label><figDesc>Let r be a nonnegative function on R such that r(t) ≤ c(t) + t 0 α(s)r(s) ds (7.47)for given positive functions α and c. Then,r(t) ≤ c(t) + t 0 α(s)c(s)e | t 0 α(s) ds| ds ,(7.48)and if c is a constant, a further simplified formula isr(t) ≤ ce | t 0 α(s) ds| .(7.49) Flow chart of LDDMM (left) and our RDMM model (right). LDDMM solves EPDiff and advects the transformation map, whereas in RDMM a modified EPDiff equation is solved combined with an advection of the transformation map and the pre-weights for the regularizer. Note that transformation map ϕ −1 and the pre-weights {h i } are both advected according to the velocity field.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head></head><label></label><figDesc>Theorem 2 (Momentum-based RDMM optimality conditions). The RDMM optimality conditions of Thm. (1) can be written entirely w.r.t. the momentum (as defined in Thm</figDesc><table><row><cell>8)</cell></row></table><note></note></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1">Thm. (2) in suppl. 7.2 provides a more generalized derivation.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="3">In this section, to simplify the notation, we denote the partial derivative ∂t by only the subscript t.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="4">We will show in the remainder of this section that for costs defined via a convex function, g, c = g(σ 2 ), this is indeed a solution of the KKT equations. This is consistent with known optimal mass transport theory, where for convex costs the optimal mass transport in 1D is a monotone rearrangement<ref type="bibr" target="#b11">[12]</ref>.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Acknowledgements Research reported in this work was supported by the National Institutes of Health (NIH) and the National Science Foundation (NSF) under award numbers NSF EECS-1711776 and NIH 1R01AR072013. The content is solely the responsibility of the authors and does not necessarily represent the official views of the NIH or the NSF. We would also like to thank Dr. Raúl San José Estépar for providing the lung data.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Note that these weights are independent of the costs c i 4 .</p><p>Both weights are required to be non-negative, i.e. w k ≥ 0, w l ≥ 0. From this condition, we obtain w k = σ 2 l −σ 2 σ 2 l − σ 2 k ≥ 0 (7.70) ⇔ σ 2 l −σ 2 ≥ 0 (7.71) ⇔σ 2 ≤ σ 2 l (7.72) and</p><p>and finally that the desired variance needs to be between the variances of k and l, i.e., σ 2 k ≤σ 2 ≤ σ 2 l . Since λ k = λ l = 0, we further get from Eq. (7.61) that</p><p>which we can solve for γ 1 and γ 2 to obtain</p><p>For arbitrary i / ∈ {l, k} the Lagrangian multipliers are then</p><p>As g(σ 2 k ) = c k and g(σ 2 l ) = c l , this is simply a line that passes through the points (σ 2 k , c k ) and (σ 2 l , c l ) and this condition states that for a solution candidate edge (k, l) the costs for all i / ∈ {k, l} are on or above this line. If the costs are defined via a function c = h(σ 2 ), then, if h is a convex function (and remembering the condition σ 2 k ≤σ 2 ≤ σ 2 l ), the optimal solution of this linear program will be on the edge (k * , l * ) most tightly bracketingσ 2 , i.e.,</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.7.2">Solution on a simplex vertex</head><p>Assume thatσ 2 = σ 2 j , i.e., the desired variance coincides with the variances of one of the Gaussians. Then w j = 1 and w i = 0, ∀i = j. Furthermore, we have λ j = 0 from which follows</p><p>For the remaining N − 1 variables i = j, it needs to hold that</p><p>Now, for a vertex j to be a solution, this condition needs to be true for all i &lt; j &lt; k. Graphically, we can take any two points (σ 2 i , c i ) and (σ 2 k , c k ) and draw a line between them. If (σ 2 k , k ) is below these lines for all pairs (i, k) such that i &lt; k &lt; j, then there is a vertex solution, otherwise the solution is on an edge (for non-degenerate c i ). This condition is always fulfilled for convex functions c = h(σ 2 ).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.7.3">Solution on a simplex face</head><p>We can also ask if it is possible that a solution is on a face of the simplex. Consider the case of three non-zero weights w k &gt; 0, w l &gt; 0, w m &gt; 0. In this case, we have w k + w l + w m = 1 , (7.93) λ k = λ l = λ m = 0 , (7.94)</p><p>Furthermore, to fulfill the KKT conditions, the following equation system needs to hold (and similarly for more than three non-zero weights):</p><p>For more than two non-zero weights this is an overdetermined system. Hence, a solution can only be on a face if this system has a solution. In that case, this means that</p><p>In other words, this is only possible if c = h(σ 2 ) is at least piecewise linear. Specifically, if c = h(σ 2 ) is a strictly convex function, a solution can only be found on simplex edges or vertices based on the conditions in the two previous sections.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Symmetric diffeomorphic image registration with cross-correlation: evaluating automated labeling of elderly and neurodegenerative brain</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">B</forename><surname>Avants</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">L</forename><surname>Epstein</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Grossman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">C</forename><surname>Gee</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical image analysis</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="26" to="41" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Advanced normalization tools (ANTS)</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">B</forename><surname>Avants</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Tustison</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Song</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Insight j</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page" from="1" to="35" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Multiresolution elastic matching</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Bajcsy</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Kovačič</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">CVGIP</title>
		<imprint>
			<biblScope unit="volume">46</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="21" />
			<date type="published" when="1989" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">An unsupervised learning model for deformable medical image registration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Balakrishnan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Zhao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">R</forename><surname>Sabuncu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Guttag</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">V</forename><surname>Dalca</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">CVPR</title>
		<imprint>
			<date type="published" when="2018" />
			<biblScope unit="page" from="9252" to="9260" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Computing large deformation metric mappings via geodesic flows of diffeomorphisms</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">F</forename><surname>Beg</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">I</forename><surname>Miller</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Trouvé</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Younes</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IJCV</title>
		<imprint>
			<biblScope unit="volume">61</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="139" to="157" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Deformable image registration using a cue-aware deep regression network</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Cao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Q</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P.-T</forename><surname>Yap</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Shen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Biomedical Engineering</title>
		<imprint>
			<biblScope unit="volume">65</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="1900" to="1911" />
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Neural ordinary differential equations</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">Q</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Rubanova</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Bettencourt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">K</forename><surname>Duvenaud</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Advances in Neural Information Processing Systems</title>
		<imprint>
			<date type="published" when="2018" />
			<biblScope unit="page" from="6571" to="6583" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Large displacement optical flow from nearest neighbor fields</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Jin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Cohen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Wu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">CVPR</title>
		<imprint>
			<date type="published" when="2013" />
			<biblScope unit="page" from="2443" to="2450" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">3D U-Net: learning dense volumetric segmentation from sparse annotation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ö</forename><surname>Çiçek</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Abdulkadir</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">S</forename><surname>Lienkamp</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Brox</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">O</forename><surname>Ronneberger</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International conference on medical image computing and computer-assisted intervention</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2016" />
			<biblScope unit="page" from="424" to="432" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title level="m" type="main">Unsupervised learning for fast probabilistic diffeomorphic registration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">V</forename><surname>Dalca</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Balakrishnan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Guttag</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">R</forename><surname>Sabuncu</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2018" />
			<publisher>MICCAI</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">End-to-end unsupervised deformable image registration with a convolutional neural network</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">D</forename><surname>De Vos</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><forename type="middle">F</forename><surname>Berendsen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">A</forename><surname>Viergever</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Staring</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Išgum</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">DLMIA</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2017" />
			<biblScope unit="page" from="204" to="212" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Local matching indicators for transport problems with concave costs</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Delon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Salomon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Sobolevski</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM Journal on Discrete Mathematics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="801" to="827" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Variational problems on flows of diffeomorphisms for image matching</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Dupuis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">U</forename><surname>Grenander</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">I</forename><surname>Miller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Quarterly of applied mathematics</title>
		<imprint>
			<biblScope unit="page" from="587" to="600" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Image registration with guaranteed displacement regularity</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Haber</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Modersitzki</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">International Journal of Computer Vision</title>
		<imprint>
			<biblScope unit="volume">71</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="361" to="372" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">An optimal control approach for deformable registration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">L</forename><surname>Hart</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Zach</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Niethammer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">CVPR</title>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2009" />
			<biblScope unit="page" from="9" to="16" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Spatial transformer networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Jaderberg</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Simonyan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Zisserman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">NIPS</title>
		<imprint>
			<date type="published" when="2015" />
			<biblScope unit="page" from="2017" to="2025" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
		<title level="m" type="main">Adam: A method for stochastic optimization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">P</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Ba</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2014" />
			<publisher>ICLR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<monogr>
		<title level="m" type="main">Non-rigid image registration using fully convolutional networks with deep selfsupervision. ISBI</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Fan</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">On the limited memory BFGS method for large scale optimization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">C</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Mathematical programming</title>
		<imprint>
			<date type="published" when="1989" />
			<biblScope unit="volume">45</biblScope>
			<biblScope unit="page" from="503" to="528" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Global image registration using a symmetric block-matching approach</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Modat</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">M</forename><surname>Cash</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Daga</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">P</forename><surname>Winston</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">S</forename><surname>Duncan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Ourselin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Medical Imaging</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page">24003</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<monogr>
		<title level="m" type="main">Fast free-form deformation using graphics processing units. Computer methods and programs in biomedicine</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Modat</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">R</forename><surname>Ridgway</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><forename type="middle">A</forename><surname>Taylor</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Lehmann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Barnes</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">J</forename><surname>Hawkes</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">C</forename><surname>Fox</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Ourselin</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2010" />
			<biblScope unit="volume">98</biblScope>
			<biblScope unit="page" from="278" to="284" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<monogr>
		<title level="m" type="main">Numerical methods for image registration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Modersitzki</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2004" />
			<publisher>Oxford University Press on Demand</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<monogr>
		<title level="m" type="main">Metric learning for image registration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Niethammer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Kwitt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F.-X</forename><surname>Vialard</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2019" />
			<publisher>CVPR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<title level="m" type="main">Numerical optimization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Nocedal</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Wright</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2006" />
			<publisher>Springer Science &amp; Business Media</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Reconstructing a 3D structure from serial histological sections</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Ourselin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Roche</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Subsol</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Pennec</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Ayache</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Image and vision computing</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="issue">1-2</biblScope>
			<biblScope unit="page" from="25" to="31" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">A locally adaptive regularization based on anisotropic diffusion for deformable image registration of sliding organs</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">F</forename><surname>Pace</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">R</forename><surname>Aylward</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Niethammer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE transactions on medical imaging</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="2114" to="2126" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Piecewise-diffeomorphic image registration: Application to the motion estimation between 3D CT lung images with sliding conditions</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Risser</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F.-X</forename><surname>Vialard</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><forename type="middle">Y</forename><surname>Baluwala</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">A</forename><surname>Schnabel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical image analysis</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="182" to="193" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">Simultaneous fine and coarse diffeomorphic registration: application to atrophy measurement in Alzheimer&apos;s disease</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Risser</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F.-X</forename><surname>Vialard</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Wolz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">D</forename><surname>Holm</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Rueckert</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">MICCAI</title>
		<imprint>
			<biblScope unit="page" from="610" to="617" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Springer</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">SVF-Net: Learning deformable image registration using shape matching</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M.-M</forename><surname>Rohé</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Datar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Heimann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Sermesant</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Pennec</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">MICCAI</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2017" />
			<biblScope unit="page" from="266" to="274" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">Nonrigid registration using free-form deformations: application to breast MR images</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Rueckert</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">I</forename><surname>Sonoda</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Hayes</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">L</forename><surname>Hill</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">O</forename><surname>Leach</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">J</forename><surname>Hawkes</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">TMI</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="712" to="721" />
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Left-invariant metrics for diffeomorphic image registration with spatially-varying regularisation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Schmah</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Risser</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F.-X</forename><surname>Vialard</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Medical Image Computing and Computer-Assisted Intervention</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2013" />
			<biblScope unit="page" from="203" to="210" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">HAMMER: hierarchical attribute matching mechanism for elastic registration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Shen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Davatzikos</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">TMI</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="1421" to="1439" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<monogr>
		<title level="m" type="main">Networks for joint affine and non-parametric image registration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Shen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Han</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Niethammer</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2019" />
			<publisher>CVPR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">Probabilistic non-linear registration with spatially adaptive regularisation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><forename type="middle">J</forename><surname>Simpson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">J</forename><surname>Cardoso</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Modat</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">M</forename><surname>Cash</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">W</forename><surname>Woolrich</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">L</forename><surname>Andersson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">A</forename><surname>Schnabel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Ourselin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">D N</forename><surname>Initiative</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical image analysis</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="203" to="216" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title level="a" type="main">A vector momenta formulation of diffeomorphisms for improved geodesic regression and atlas construction</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Singh</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Hinkle</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Joshi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">T</forename><surname>Fletcher</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">2013 IEEE 10th International Symposium on Biomedical Imaging</title>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2013" />
			<biblScope unit="page" from="1219" to="1222" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title level="a" type="main">Grid powered nonlinear image registration with locally adaptive regularization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Stefanescu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Pennec</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Ayache</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical image analysis</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="325" to="342" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title level="a" type="main">Symmetric log-domain diffeomorphic registration: A demons-based approach</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Vercauteren</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Pennec</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Perchant</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Ayache</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">MICCAI</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2008" />
			<biblScope unit="page" from="754" to="761" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title level="a" type="main">Diffeomorphic demons: Efficient non-parametric image registration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Vercauteren</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Pennec</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Perchant</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Ayache</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">NeuroImage</title>
		<imprint>
			<biblScope unit="volume">45</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="61" to="72" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<analytic>
		<title level="a" type="main">Spatially-varying metric learning for diffeomorphic image registration: A variational framework</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F.-X</forename><surname>Vialard</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Risser</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Medical Image Computing and Computer-Assisted Intervention</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2014" />
			<biblScope unit="page" from="227" to="234" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<analytic>
		<title level="a" type="main">Diffeomorphic 3D image registration via geodesic shooting using an efficient adjoint calculation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F.-X</forename><surname>Vialard</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Risser</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Rueckert</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">J</forename><surname>Cotter</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">International Journal of Computer Vision</title>
		<imprint>
			<biblScope unit="volume">97</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="229" to="241" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<analytic>
		<title level="a" type="main">Efficient sparse-to-dense optical flow estimation using a learned basis and layers</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Wulff</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">J</forename><surname>Black</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">CVPR</title>
		<imprint>
			<date type="published" when="2015" />
			<biblScope unit="page" from="120" to="130" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b42">
	<analytic>
		<title level="a" type="main">Fast predictive image registration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Kwitt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Niethammer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">DLMIA</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2016" />
			<biblScope unit="page" from="48" to="57" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b43">
	<analytic>
		<title level="a" type="main">Quicksilver: Fast predictive image registration-a deep learning approach</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Kwitt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Styner</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Niethammer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">NeuroImage</title>
		<imprint>
			<biblScope unit="volume">158</biblScope>
			<biblScope unit="page" from="378" to="396" />
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b44">
	<analytic>
		<title level="a" type="main">Evolutions equations in computational anatomy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Younes</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Arrate</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">I</forename><surname>Miller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">NeuroImage</title>
		<imprint>
			<biblScope unit="volume">45</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="40" to="50" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
