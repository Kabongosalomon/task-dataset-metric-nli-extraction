<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /nfs/home/kabenamualus/Research/task-dataset-metric-extraction/../grobid-0.6.0/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">WIDE-MINIMA DENSITY HYPOTHESIS AND THE EXPLORE-EXPLOIT LEARNING RATE SCHEDULE</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nikhil</forename><surname>Iyer</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Thejas</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nipun</forename><surname>Kwatra</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ramachandran</forename><surname>Ramjee</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Muthian</forename><surname>Sivathanu</surname></persName>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="institution">Microsoft Research</orgName>
								<address>
									<country key="IN">India</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<address>
									<country>Atlassian India</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff2">
								<orgName type="institution">Microsoft Research</orgName>
								<address>
									<country key="IN">India</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff3">
								<orgName type="institution">Microsoft Research</orgName>
								<address>
									<country key="IN">India</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff4">
								<orgName type="institution">Microsoft Research</orgName>
								<address>
									<country key="IN">India</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">WIDE-MINIMA DENSITY HYPOTHESIS AND THE EXPLORE-EXPLOIT LEARNING RATE SCHEDULE</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>

		<encodingDesc>
			<appInfo>
				<application version="0.6.0" ident="GROBID-SDO" when="2021-06-26T07:15+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid-sdo"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Several papers argue that wide minima generalize better than narrow minima. In this paper, through detailed experiments that not only corroborate the generalization properties of wide minima, we also provide empirical evidence for a new hypothesis that the density of wide minima is likely lower than the density of narrow minima. Further, motivated by this hypothesis, we design a novel explore-exploit learning rate schedule. On a variety of image and natural language datasets, compared to their original hand-tuned learning rate baselines, we show that our explore-exploit schedule can result in either up to 0.84% higher absolute accuracy using the original training budget or up to 57% reduced training time while achieving the original reported accuracy. For example, we achieve state-of-the-art (SOTA) accuracy for IWSLT'14 (DE-EN) and WMT'14 (DE-EN) datasets by just modifying the learning rate schedule of a high performing model.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>One of the fascinating properties of deep neural networks (DNNs) is their ability to generalize well, i.e., deliver high accuracy on the unseen test dataset. It is well-known that the learning rate (LR) schedules play an important role in the generalization performance <ref type="bibr" target="#b16">(Keskar et al., 2016;</ref><ref type="bibr">Wu et al., 2018;</ref><ref type="bibr" target="#b9">Goyal et al., 2017)</ref>. In this paper, we study the question, what are the key properties of a learning rate schedule that help DNNs generalize well during training?</p><p>We start with a series of experiments training Resnet18 on Cifar-10 over 200 epochs. We vary the number of epochs trained at a high LR of 0.1, called the explore epochs, from 0 to 100 and divide up the remaining epochs equally for training with LRs of 0.01 and 0.001. Note that the training loss typically stagnates around 50 epochs with 0.1 LR. Despite that, we find that as the number of explore epochs increase to 100, the average test accuracy also increases. We also find that the minima found in higher test accuracy runs are wider than the minima from lower test accuracy runs, corroborating past work on wide-minima and generalization <ref type="bibr" target="#b16">(Keskar et al., 2016;</ref><ref type="bibr" target="#b12">Hochreiter &amp; Schmidhuber, 1997;</ref><ref type="bibr" target="#b13">Jastrzebski et al., 2017;</ref><ref type="bibr">Wang et al., 2018)</ref>. Moreover, what was particularly surprising was that, even when using fewer explore epochs, a few runs out of many trials still resulted in high test accuracies! Thus, we not only find that an initial exploration phase with a high learning rate is essential to the good generalization of DNNs, but that this exploration phase needs to be run for sufficient time, even if the training loss stagnates much earlier. Further, we find that, even when the exploration phase is not given sufficient time, a few runs still see high test accuracy values.</p><p>To explain these observations, we hypothesize that, in the DNN loss landscape, the density of narrow minima is significantly higher than that of wide minima. A large learning rate can escape narrow minima easily (as the optimizer can jump out of them with large steps). However, once it reaches a wide minima, it is likely to get stuck in it (if the "width" of the wide minima is large compared to the step size). With fewer explore epochs, a large learning rate might still get lucky occasionally in finding a wide minima but invariably finds only a narrower minima due to their higher density. As the explore duration increase, the probability of eventually landing in a wide minima also increase. Thus, a minimum duration of explore is necessary to land in a wide minimum with high probability.</p><p>Heuristic-based LR decay schemes such as cosine decay <ref type="bibr" target="#b22">(Loshchilov &amp; Hutter, 2016)</ref> implicitly maintain a higher LR for longer than schemes like linear decay. Thus, the hypothesis also explains cosine decay's better generalization compared to linear decay. Moreover, the hypothesis enables a principled learning rate schedule design that explicitly accounts for the requisite explore duration.</p><p>Motivated by the hypothesis, we design a novel Explore-Exploit learning rate schedule, where the initial explore phase optimizes at a high learning rate in order to arrive in the vicinity of a wide minimum. This is followed by an exploit phase which descends to the bottom of this wide minimum. We give explore phase enough time so that the probability of landing in a wide minima is high. For the exploit phase, we experimented with multiple schemes, and found a simple, parameterless, linear decay to zero to be effective. Thus, our proposed learning rate schedule optimizes at a constant high learning rate for some minimum time, followed by a linear decay to zero. We call this learning rate schedule the Knee schedule.</p><p>We extensively evaluate the Knee schedule across a wide range of models and datasets, ranging from NLP (BERT pre-training, Transformer on  and ) to CNNs (ImageNet on ResNet-50, Cifar-10 on ResNet18), and spanning multiple optimizers: SGD Momentum, Adam, RAdam, and LAMB. In all cases, Knee schedule improves the test accuracy of state-of-the-art hand-tuned learning rate schedules, when trained using the original training budget. The explore duration is a hyper-parameter in Knee schedule but even if we set the explore duration to a fixed 50% fraction of total training budget, we find that it still outperforms prior schemes.</p><p>We also experimented with reducing the training budget, and found that Knee schedule can achieve the same accuracy as the baseline under significantly reduced training budgets. For the BERT LARGE pretraining,  and ImageNet experiments, we are able to train in 33%, 57% and 44% less training budget, respectively, for the same test accuracy. This corresponds to significant savings in GPU compute, e.g. savings of over 1000 V100 GPU-hours for BERT LARGE pretraining.</p><p>The main contributions of our work are: 1. A hypothesis of lower density of wide minima in the DNN loss landscape, backed by extensive experiments, that explains why a high learning rate needs to be maintained for sufficient duration to achieve good generalization. 2. The hypothesis also explains the good performance of heuristic-based schemes such as cosine decay, and promotes a principled design of learning rate decay schemes. 3. Motivated by the hypothesis, we design an Explore-Exploit learning rate schedule called Knee schedule that outperforms prior heuristic-based learning rate schedules, including achieving state-of-the-art results in  and  datasets.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">WIDE-MINIMA DENSITY HYPOTHESIS</head><p>Many popular learning rate (LR) schedules, such as the step decay schedules for image datasets, start the training with high LR, and then reduce the LR periodically. For example, consider the case of Cifar-10 on Resnet-18, trained using a typical step LR schedule of 0.1, 0.01, 0.001 for 100, 50, 50 epochs each. In many such schedules, even though training loss stagnates after several epochs of high LR, one still needs to continue training at high LR in order to get good generalization.</p><p>For example, <ref type="figure">Figure 1</ref> shows the training loss for Cifar-10 on Resnet-18, trained with a fixed LR of 0.1 (orange curve), compared to a model trained via a step schedule with LR reduced at epoch 50 (blue curve). As can be seen from the figure, the training loss stagnates after ≈ 50 epochs for the orange curve, and locally it makes sense to reduce the learning rate to decrease the loss. However, as shown in <ref type="table" target="#tab_0">Table 1</ref>, generalization is directly correlated with duration of training at high LR, with the highest test accuracy achieved when the high LR is used for 100 epochs, well past the point where training loss stagnates.</p><p>To understand the above phenomena, we perform another experiment. We train Cifar-10 on Resnet-18 for 200 epochs, using a high LR of 0.1 for only 30 epochs and then use LR of 0.01 and 0.001 for 85 epochs each. We repeat this training 50 times with different random weight initializations. On Training Loss vs Epochs <ref type="figure">Figure 1</ref>: Training loss for Cifar-10 on Resnet-18. Orange plot uses a fixed LR of 0.1, while in blue plot, the LR is reduced from 0.1 to 0.01 at epoch 50. An intuitive explanation of why high LRs are necessary to locate wide minima then follows: a large LR can escape narrow minima "valleys" easily (as the optimizer can jump out of them with large steps). However, once it reaches a wide minima "valley", it is likely to get stuck in it (if the "width" of the wide valley is large compared to the step size). For example, see <ref type="bibr">Wu et al. (2018)</ref> for a result showing that large LRs are unstable at narrow minima and thus don't converge to them. Thus the optimizer, when running at a high LR, jumps from one narrow minimum region to another, until it lands in a wide minimum region where it then gets stuck. Now, the probability of an optimization step landing in a wide minima is a direct function of the proportion of wide minima compared to that of narrow minima. Thus, if our hypothesis is true, i.e., wide minima are much fewer than narrow minima, this probability is very low, and the optimizer needs to take a lot of steps to have a high probability of eventually landing in a wide minimum. This explains the observation in <ref type="table" target="#tab_0">Table 1</ref>, where the average accuracy continues to improve as we increase the number of high LR training steps. The hypothesis also explains why very few (just 1) of the 50 runs trained at 0.1 LR for 30epochs also managed to attain high accuracy -they just got lucky probabilistically and landed in a wide minimum even with a shorter duration.</p><p>To validate this hypothesis further, we run experiments similar to the one in <ref type="table" target="#tab_0">Table 1</ref>. Specifically, we train Cifar-10 on Resnet-18 model for 200 epochs using a standard step schedule with LR of 0.1, 0.01, 0.001. We vary the number of epochs trained using the high LR of 0.1, called the explore epochs, from 30 to 100 epochs, and divide up the rest of the training equally between 0.01 and 0.001. For each experimental setting, we conduct 50 random trials and plot the distributions of final test accuracy and the minima sharpness as defined by the metric in <ref type="bibr" target="#b16">Keskar et al. (2016)</ref>. If our hypothesis is true, then the more you explore, the higher the probability of landing (and getting stuck) in a wide minima region, which should cause the distribution to tighten and move towards wider minima (lower sharpness), as the number of explore steps increase. This is exactly what is observed in <ref type="figure">Figure 2</ref>. Also since wide minima correlate with higher test accuracy, we should see the test accuracy distribution move towards higher accuracy and sharpen, as the number of explore steps increase. This is confirmed as well in <ref type="figure">Figure 3</ref>.</p><p>Finally, to verify whether explore at high LR is essential, we train Cifar-10 for 10,000 epochs at a fixed lower LR of 0.001. The training converged but the final test accuracy was only 93.9. Thus, even training 50x longer at low LR is not sufficient, adding more evidence to the hypothesis.</p><p>Multi-scale. Given the importance of explore at high LR, a natural question that may arise is whether explore is necessary at smaller LR as well. To answer this, we train the same network for a total of 200 epochs with an initial high LR of 0.1 for 100 epochs, but now we vary the number of epochs trained with the LR of 0.01 (we call this finer-scale explore), and train with LR of 0.001 for the remaining epochs. As can be seen from  find that finer-scale explore also plays a role similar to the initial explore in determining the final test accuracy. This indicates that our hypothesis about density of wide/narrow regions indeed holds at multiple scales.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">EXPLORE-EXPLOIT LEARNING RATE SCHEDULE</head><p>Given that we need to explore at multiple scales for good generalization, how do we go about designing a good learning rate schedule? The search space of the varying learning rate steps and their respective explore duration is enormous.</p><p>Fortunately, since the explore at the initial scale is searching over the entire loss surface while explore at finer-scales is confined to exploring only the wide-minima region identified by the initial explore, the former is more crucial. In our experiments as well, we found that the initial portion of training is much more sensitive to exploration and needs a substantial number of explore steps, while after this initial phase, several decay schemes worked equally well. This is similar to the observations in <ref type="bibr" target="#b8">(Golatkar et al., 2019)</ref> where the authors found that regularization such as weightdecay and data augmentation mattered significantly only during the initial phase of training.</p><p>The above observations motivate our Explore-Exploit learning rate schedule, where the explore phase first optimizes at a high learning rate for some minimum time in order to land in the vicinity of a wide minima. We should give the explore phase enough time (a hyper-parameter), so that the probability of landing in a wide minima is high. After the explore phase, we know with a high probability, that the optimizer is in the vicinity of a wide region. We now start the exploit phase to descend to the bottom of this wide region while progressively decreasing the learning rate. Any smoothly decaying learning rate schedule can be thought of as doing micro explore-exploit at progressively reduced scales. A steady descent would allow more explore duration at all scales, while a fast descent would explore less at higher learning rates. We experimented with multiple schedules for the exploit phase, and found a simple linear decay to zero, that does not require any hyper-parameter, to be effective in all the models/datasets we tried. We call our proposed learning rate schedule which starts at a constant high learning rate for some minimum time, followed by a linear decay to zero, the Knee schedule.</p><p>Note that any learning rate decay scheme incorporates an implicit explore during the initial part, where the learning rate stays high enough. To evaluate the benefit of an explicit explore phase, we compare Knee schedule against several decay schemes such as linear and cosine. Interestingly, the results depend on the length of training. For long budget experiments, simple decay schemes perform comparable to Knee schedule in some experiments, since the implicit explore duration is also large, helping these schemes achieve good generalization. However for short budget experiments, these schemes perform significantly worse than Knee schedule, since the implicit explore duration is much shorter. See <ref type="table" target="#tab_8">Table 6</ref> and 7 for the comparison.</p><p>Warmup. Some optimizers such as Adam use an initial warmup phase to slowly increase the learning rate. However, as shown in <ref type="bibr" target="#b21">Liu et al. (2019)</ref>, learning rate warmup is needed mainly to reduce variance during initial training stages and can be eliminated with an optimizer such as RAdam.</p><p>Learning rate warmup is also used for large-batch training <ref type="bibr" target="#b9">(Goyal et al., 2017)</ref>. Here, warmup is necessary since the learning rate is scaled to a very large value to compensate for the large batch size. This warmup is complementary and can be incorporated into Knee schedule. For example, we do this for BERT LARGE pretraining experiment where a large 16k batch size was used.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">EXPERIMENTS</head><p>We have done multiple experiments in section 2 to validate our hypothesis. We do further hypothesis validation on a text dataset. This is discussed in Section A of supplementary material.</p><p>We now extensively evaluate the effectiveness of Knee schedule on multiple models and datasets, across various optimizers including SGD Momentum, Adam (Kingma &amp; Ba, 2014a), RAdam <ref type="bibr" target="#b21">(Liu et al., 2019)</ref>  For all settings we compare Knee schedule against the original hand-tuned learning rate baseline for the corresponding model and dataset, showing an improvement in test accuracy in all cases. We also show that Knee schedule can achieve the same accuracy as the baseline with a much reduced training budget (e.g. 44% less for ImageNet). Further, we also run our experiments with other common LR schedules such as linear decay, cosine decay, one-cycle (Smith, 2018). See <ref type="table" target="#tab_8">Table 6</ref> and <ref type="table" target="#tab_9">Table 7</ref> for a comparison of all LR schedules on the original budget and shorter budgets, respectively.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">IMAGENET IMAGE CLASSIFICATION ON RESNET-50</head><p>We train ImageNet dataset <ref type="bibr" target="#b26">(Russakovsky et al., 2015)</ref> on Resnet-50 network <ref type="bibr" target="#b11">(He et al., 2016)</ref> with the SGD Momentum optimizer. For baseline runs, we used the standard hand-tuned step learning rate schedule of 10 −1 , 10 −2 , 10 −3 for 30 epochs each. For Knee schedule we used a seed LR of 0.1 (same as baseline). We trained with the original budget of 90 epochs as well as with a reduced budget of 50 epochs. We used 30 and 20 explore epochs for the two runs, respectively. <ref type="table" target="#tab_4">Table 3</ref> shows the training loss and test accuracies for our experiments. Knee schedule comfortably beats the test accuracy of baseline in the full budget run (with absolute gains of 0.8% and 0.4% in top-1 and top-5 accuracy, respectively), while meeting the baseline accuracy even with a much shorter budget. The fact that the baseline schedule takes almost 80% more training time than Knee schedule for the same test accuracy, shows the effectiveness of our Explore-Exploit scheme. See <ref type="figure">Figure 5</ref> in Appendix for training curves. We train Cifar-10 dataset <ref type="bibr" target="#b19">(Krizhevsky et al., 2009</ref>) on Resnet-18 network <ref type="bibr" target="#b11">(He et al., 2016)</ref> with the SGD Momentum optimizer. For baseline, we used the hand-tuned step learning rate schedule of 10 −1 , 10 −2 , 10 −3 for 100, 50, 50 epochs, respectively. With Knee schedule, we train the network with the original budget of 200 epochs, as well as a reduced budget of 150 epochs. We used 100 explore epochs for both runs, and a seed learning rate of 0.1 (same as baseline). <ref type="table" target="#tab_8">Table 6</ref> and <ref type="table" target="#tab_9">Table 7</ref> shows the test accuracy for the full and reduced budget runs. Knee schedule beats the test accuracy of baseline in the full budget run, while meeting the baseline test accuracy in 25% less budget. See <ref type="table" target="#tab_0">Table 10</ref>, <ref type="figure" target="#fig_4">figure 6</ref> in Appendix for detailed comparisons of training loss, test accuracy, and LR.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">BERT LARGE PRE-TRAINING</head><p>We now evaluate Knee schedule on a few NLP tasks. In the first task, we pre-train the BERT LARGE model <ref type="bibr" target="#b5">(Devlin et al., 2018)</ref> on the Wikipedia+BooksCorpus dataset with LAMB (You et al., 2019) optimizer using a batch-size of 16k.</p><p>Since large batch training requires learning rate warmup (see <ref type="bibr" target="#b9">Goyal et al. (2017)</ref>), we incorporate it into the Knee schedule by first doing a warmup followed by the explore-exploit phases. We used an explore of 50% steps for both phases of BERT training. For baseline, we use the warmup + linear decay schedule <ref type="bibr">(You et al., 2019;</ref><ref type="bibr" target="#b5">Devlin et al., 2018)</ref>. The pre-trained models are evaluated on the SQuAD v1.1 <ref type="bibr" target="#b25">(Rajpurkar et al., 2016)</ref> dataset by fine-tuning on the dataset for 2 epochs. We pretrain the model on both the full budget, as well as with 33% less budget. See <ref type="table" target="#tab_5">Table 4</ref> for the results. For the full budget run, Knee schedule improves the baseline by 0.2%, while for the reduced budget we achieved similar fine-tuning accuracy as baseline. The baseline schedule achieves a much lower accuracy with shorter budget training, showing the efficacy of Knee schedule. BERT pre-training is extremely compute expensive and takes around 47 hours on 64 V100 GPUs (3008 V100 GPU-hrs) on cloud VMs. The reduced budget amounts to a saving of approximately 1002 V100 GPU-hours! WMT'14 (EN-DE): The baseline schedule uses a linear decay for 70 epochs <ref type="bibr" target="#b21">(Liu et al., 2019)</ref>.</p><p>With Knee schedule, we trained with the original budget of 70 epochs, as well as a reduced budget of 30 epochs. We used 50 and 25 explore epochs for the two runs, respectively and a seed learning rate of 3e − 4 for both Knee schedule and baseline. In all cases we use the model checkpoint with least loss on the validation set for computing BLEU scores on the test set.   <ref type="table" target="#tab_0">Table 11</ref> in Appendix. See <ref type="figure">Figure 8</ref> and <ref type="figure">Figure 9</ref> in Appendix for training curves.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.5">STATE OF THE ART RESULTS</head><p>To further demonstrate the effectiveness of Knee schedule, we took a recent high performing model, MAT <ref type="bibr" target="#b7">(Fan et al., 2020)</ref>, which had shown very high accuracy on the IWSLT'14 (DE-EN) dataset with a BLEU score of 36.22 trained with inverse square root LR schedule. We simply retrained the model with Knee schedule, and achieved a new SOTA BLEU score of 36.6 (a 0.38 point increase).</p><p>We also trained the model with WMT'14 (DE-EN) dataset and again achieved a SOTA BLEU score of 31.9 with Knee schedule, compared to the baseline score of 31.34 which uses the inverse square root LR schedule. See Section B.5, <ref type="table" target="#tab_0">Table 12</ref>, <ref type="table" target="#tab_0">Table 13</ref> and <ref type="figure">Figure 10</ref> in Appendix for more details.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.6">COMPARISON WITH OTHER LEARNING SCHEDULES</head><p>We also ran all our experiments with multiple other learning rate schedules -one-cycle (Smith, 2018), cosine decay <ref type="bibr" target="#b22">(Loshchilov &amp; Hutter, 2016)</ref> and linear decay. See section E in supplementary material for details of these learning rate schedules, and a detailed performance comparison. Note that in Knee schedule, the explore duration is a hyperparameter. To avoid tuning this hyperparameter, we also experimented with a fixed 50% explore duration for the full budget runs. <ref type="table" target="#tab_8">Table 6</ref> shows the test accuracies of the various experiments on all schedules, when trained with the original budget; while <ref type="table" target="#tab_9">Table 7</ref> shows the results when trained with a reduced budget. As shown, for the full budget runs, Knee schedule improves on the test accuracies on all experiments. Even the fixed 50% explore Knee schedule outperforms all the other baselines. Also noteworthy is that Knee schedule is able to achieve the same test accuracies as the baseline's full budget runs with a much lower training budget, saving precious GPU cycles. We also demonstrate that the delta in accuracy between Knee schedule and other decay schemes is non-trivial by computing the number of epochs needed by each scheme to reach the target BLEU scores for WMT'14 and IWSLT'14. As shown in <ref type="table" target="#tab_10">Table 8</ref>, Knee schedule is highly efficient compared to say Cosine Decay which takes 100% more training time to achieve the same accuracy for WMT'14.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">RELATED WORK</head><p>Generalization. There has been a lot of work on understanding the generalization characteristics of DNNs. <ref type="bibr" target="#b15">Kawaguchi (2016)</ref> found that DNNs have many local minima, but all local minima were also the global minima. It has been observed by several authors that wide minima generalize better than narrow minima <ref type="bibr" target="#b0">(Arora et al., 2018;</ref><ref type="bibr" target="#b12">Hochreiter &amp; Schmidhuber, 1997;</ref><ref type="bibr" target="#b16">Keskar et al., 2016;</ref><ref type="bibr" target="#b13">Jastrzebski et al., 2017;</ref><ref type="bibr">Wang et al., 2018)</ref> but there have been other works questioning this hypothesis as well <ref type="bibr" target="#b6">(Dinh et al., 2017;</ref><ref type="bibr" target="#b8">Golatkar et al., 2019;</ref><ref type="bibr" target="#b10">Guiroy et al., 2019;</ref><ref type="bibr" target="#b14">Jastrzebski et al., 2019;</ref><ref type="bibr">Yoshida &amp; Miyato, 2017)</ref>.   <ref type="bibr" target="#b16">Keskar et al. (2016)</ref> found that small batch SGD generalizes better and lands in wider minima than large batch SGD. However, recent work has been able to generalize quite well even with very large batch sizes <ref type="bibr" target="#b9">(Goyal et al., 2017;</ref><ref type="bibr" target="#b23">McCandlish et al., 2018;</ref><ref type="bibr" target="#b27">Shallue et al., 2018)</ref>, by scaling the learning rate linearly as a function of the batch size. <ref type="bibr" target="#b14">Jastrzebski et al. (2019)</ref> analyze how batch size and learning rate influence the curvature of not only the SGD endpoint but also the whole trajectory. They found that small batch or large step SGD have similar characteristics, and yield smaller and earlier peak of spectral norm as well as smaller largest eigenvalue. <ref type="bibr" target="#b4">Chaudhari et al. (2019)</ref>;  propose methods to drive the optimizer to wide minima. <ref type="bibr">Wang et al. (2018)</ref> analytically show that generalization of a model is related to the Hessian and propose a new metric for the generalization capability of a model that is unaffected by model reparameterization of <ref type="bibr" target="#b6">Dinh et al. (2017)</ref>. <ref type="bibr">Yoshida &amp; Miyato (2017)</ref> argue that regularizing the spectral norm of the weights of the neural network help them generalize better. On the other hand, <ref type="bibr" target="#b0">Arora et al. (2018)</ref> derive generalization bounds by showing that networks with low stable rank (high spectral norm) generalize better. <ref type="bibr" target="#b10">Guiroy et al. (2019)</ref> looks at generalization in gradient-based meta-learning and they show experimentally that generalization and wide minima are not always correlated.</p><p>Lower density of wide minima. Wu et al. <ref type="formula">(2018)</ref> compares the sharpness of minima obtained by full-batch gradient descent (GD) with different learning rates for small neural networks on Fashion-MNIST and Cifar10 datasets. They find that GD with a given learning rate finds the theoretically sharpest feasible minima for that learning rate. Thus, in the presence of several flatter minimas, GD with lower learning rates does not find them, leading to the conjecture that density of sharper minima is perhaps larger than density of wider minima.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">CONCLUSIONS</head><p>In this paper, we make an observation that an initial explore phase with a high learning rate is essential for good generalization of DNNs. Further, we find that a minimum explore duration is required even if the training loss stops improving much earlier. We explain this observation via our hypothesis that in the DNN loss landscape, the density of wide minima is significantly lower than that of narrow minima. Motivated by this hypothesis, we present an Explore-Exploit based learning rate schedule, called the Knee schedule. We do extensive evaluation of Knee schedule on multiple models and datasets. In all experiments, the Knee schedule outperforms prior hand-tuned </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A HYPOTHESIS VALIDATION</head><p>For validating our hypothesis on the density of wide minima vs narrow minima, we did multiple experiments, most of which were discussed in section 2 of the main paper. To summarize, in figures 2, 3 of the main paper, we showed that for Cifar-10 on Resnet-18, as the number of explore steps increase, the distribution of minima width and test accuracy sharpens and shifts towards wider minima and better accuracy, respectively. This behaviour is predictable from our hypothesis as increasing explore steps increases the probability of landing in a wide region. From the same argument, the average accuracy should increase as the number of explore steps increase, which is confirmed in <ref type="table" target="#tab_0">Table 1</ref> of the main paper. Our hypothesis also predicts that even at low explore epochs, although the probability of landing in a wide region is low, it is non zero. Thus, out of many trials with low number of explore epochs, a few runs could still yield high test accuracy. This is what we observe in <ref type="figure">Figure 3</ref>(b) of the main paper, where 1 out of 50 trials for the 30 explore runs obtains an accuracy more than 95.24 even though the average accuracy for 30 explore is 94.81!. We do a similar experiments on the IWSLT'14 German to English dataset <ref type="bibr" target="#b3">(Cettolo et al., 2014)</ref> trained on Transformer networks <ref type="bibr">(Vaswani et al., 2017)</ref> to demonstrate that our hypothesis holds even on a completely different NLP dataset and network architecture. We train with the Knee schedule for a total budget of 50 epochs, but keep varying the number of explore epochs. As shown in <ref type="table" target="#tab_11">Table 9</ref>, the test BLEU score increases as we increase the number of explore epochs. Further, we found that among multiple trials, a 20 epoch explore run had a high BLEU score of 35.29, suggesting that the run got lucky. Thus, these results on the IWSLT'14 (DE-EN) dataset add more evidence to the wide-minima density hypothesis.</p><p>Also, see section D and <ref type="table" target="#tab_0">Table 17</ref> for a sensitivity analysis of the Knee schedule on the starting learning rate. Interestingly, we found that the optimal explore duration varies inversely with the starting LR. Since a bigger learning rate has higher probability of escaping narrow minima compared to a lower learning rate, it would, on an average, require fewer steps to land in a wide minima. Thus, larger learning rates can explore faster. This observation is thus consistent with our hypothesis and further corroborates it.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B EXPERIMENT DETAILS</head><p>In this section we describe the implementation and other details of each experiment. For the smaller datasets -Cifar-10 and IWSLT'14 (DE-EN), we also provide the detailed training loss, test accuracy table which we skipped in the main paper. We also discuss an additional experiment, where we finetune a pretrained BERT BASE network on the SQuAD-v1.1 dataset.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B.1 IMAGENET IMAGE CLASSIFICATION ON RESNET-50</head><p>We train ImageNet <ref type="bibr" target="#b26">Russakovsky et al. (2015)</ref> on Resnet-50 <ref type="bibr" target="#b11">He et al. (2016)</ref>, which has 25 million parameters, with a batch size of 256 and a seed learning rate of 0.1. Random cropping and random horizontal flipping augmentations were applied to the training dataset. We use SGD optimizer with momentum of 0.9 and weight decay of 1e-4 1 . For knee schedule, we choose explore as 30 epochs for the full budget and 20 epochs for the short budget. <ref type="figure">Figure 5</ref> shows the training loss, test accuracy and learning rate curves during training.</p><p>B.2 CIFAR-10 IMAGE CLASSIFICATION ON  For this experiment, we use a batch size of 128 and a seed learning rate of 0.1 with ResNet-18He et al. <ref type="formula">(2016)</ref> which has around 11 million parameters. SGD optimizer is used with momentum of 0.9 and weight decay of 5e-4 2 . Random cropping and random horizontal flipping augmentations were applied to the training dataset. For knee schedule, we choose 100 epochs as explore for short and full budget runs. <ref type="table" target="#tab_0">Table 10</ref> shows the training loss and test accuracies for the various runs. <ref type="figure" target="#fig_4">Figure 6</ref> shows the training loss, test accuracy and learning rate curves during training. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B.3 BERT LARGE PRE-TRAINING</head><p>We pre-train BERT using the LAMB optimizer 3 . BERT LARGE has around 330 million parameters and the pre-training is divided into two phases with different sequence lengths. The first phase consists of 90% steps with sequence length of 128 and the second phase consists of the remaining 10% steps with sequence length of 512 <ref type="bibr" target="#b5">Devlin et al. (2018)</ref>. We used a batch size of 16384 in both phases of training. We train the model on a shortened training budget of 2/3rd the original steps (20854 instead of 31250 steps) and on the full budget (31250 steps). For Knee schedule, we explore for 50% of the phase budget after performing warmup for 10% of the phase steps. Please refer to <ref type="figure">Figure 7</ref> for the training loss and learning rate curves of the short budget runs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B.4 MACHINE TRANSLATION ON TRANSFORMER NETWORK WITH WMT'14(EN-DE) AND IWSLT'14(DE-EN)</head><p>We use the default implementation provided by the fairseq package <ref type="bibr" target="#b24">Ott et al. (2019)</ref>  For Knee schedule, we choose explore of 25 epochs for short budget runs and 50 epochs for full budget runs. Please see <ref type="figure">Figure 8</ref> for training perplexity, validation perplexity and learning rate curves.</p><p>For IWSLT'14 we use the same configuration as WMT'14, except for a dropout of 0.3 following Fairseq's out-of-box implementation. Each training batch contains approximately 4000 tokens. For Knee schedule, we choose explore as 30 epochs for short budget runs and 40 epochs for full budget runs. <ref type="table" target="#tab_0">Table 11</ref> shows the training loss and test accuracies for the various runs. <ref type="figure">Figure 9</ref> shows the training perplexity, validation perplexity and learning rate curves. We use the default implementation provided by the authors of <ref type="bibr" target="#b7">Fan et al. (2020)</ref> 5 . The MAT model is trained in two phases. A smaller model is trained in the first phase, which is used to initialize a larger model of the second phase. Adam optimizer with β 1 of 0.9 and β 2 of 0.98 is used for both phases.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>IWSLT'14 (DE-EN):</head><p>For the baseline run with IWSLT'14 (DE-EN) dataset, we follow the exact instructions provided by the authors in their code repository -each phase is trained for 200 epochs, using an inverse square root LR schedule with warmup of 4000 steps and a peak LR of 5e −4 . For the run with Knee schedule we simply replace the learning rate schedule, keeping everything else unchanged. We used the same warmup of 4000 steps, and explored at 5e −4 LR till 100 epochs followed by the linear decay exploit phase. <ref type="table" target="#tab_0">Table 12</ref> shows the train loss and test accuracies for the various runs. Please see <ref type="figure">Figure 10</ref> for detailed plots. WMT'14 (DE-EN): We follow the instructions provided in <ref type="bibr" target="#b7">Fan et al. (2020)</ref> to preprocess the train and test datasets. For baseline, we train each phase for 70 epochs, using an inverse square root LR schedule with warmup of 4000 steps and a peak LR of 5e −4 . For the run with Knee schedule we simply replace the learning rate schedule, keeping everything else unchanged. We used the same warmup of 4000 steps, and explored at 5e −4 LR for 35 epochs followed by the linear decay exploit phase. <ref type="table" target="#tab_0">Table 13</ref> shows the train loss and test accuracies for the various runs. We also evaluate Knee schedule on the task of fine-tuning BERT BASE model <ref type="bibr" target="#b5">Devlin et al. (2018)</ref> on SQuAD v1.1 <ref type="bibr" target="#b25">Rajpurkar et al. (2016)</ref> with the Adam Kingma &amp; Ba (2014b) optimizer 6 . BERT fine-tuning is prone to overfitting because of the huge model size compared to the small fine-tuning dataset, and is typically run for only a few epochs. For baseline we use the linear decay schedule mentioned in <ref type="bibr" target="#b5">Devlin et al. (2018)</ref>. We use a seed learning rate of 3e −5 and train for 2 epochs. For Knee schedule, we train the network with 1 explore epoch with the same seed learning rate of 3e −5 . <ref type="table" target="#tab_0">Table 14</ref> shows our results over 3 runs. We achieve a mean EM score of 81.4, compared to baseline's 80.9, a 0.5% absolute improvement. We don't do a short budget run for this example, as the full budget is just 2 epochs. Please refer to <ref type="figure">Figure 11</ref> for the training loss, test accuracy and learning rate curves. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C MINIMA SHARPNESS</head><p>Our hypothesis predicts that a higher explore should help the optimizer in finding a wider minimum, which in turn helps generalization. For quantitative evaluation, we used two different metrics for measuring the minima width, and evaluate the effect of explore on the width of the converged minima.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C.1 KESKAR'S SHARPNESS METRIC KESKAR ET AL. (2016)</head><p>In our first evaluation we used the sharpness metric proposed in Keskar et al. (2016) (see Metric 2.1 in section 2.2.2 of the paper). This metric was used to compute the histograms in <ref type="figure">Figure 2</ref> of the main paper as well. We use an of 1e-4, and A is chosen to be the identity matrix. The maximization problem is solved by applying 1000 iterations of projected gradient ascent. We compute this metric for the Cifar-10 on Resnet-18 experiments for different number of explore epochs. As shown in <ref type="table" target="#tab_0">Table 15</ref>, the average sharpness of the minima decreases as we increase the number of explore epochs, as predicted by our hypothesis. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C.2 FISHER SCORE</head><p>The maximum Eigen value of the Fisher Information Matrix (FIM) is another metric used to measure the maximum curvature of the loss landscape (see <ref type="bibr">Sokol &amp; Park (2018)</ref>). We used an unbiased estimate of the true Fisher matrix (see <ref type="bibr" target="#b20">Kunstner et al. (2019)</ref>) using 10 unbiased samples per training data. <ref type="table" target="#tab_0">Table 16</ref> shows the average FIM scores for the Cifar-10 experiments with different explores. As shown, the FIM score decreases as the number of explore epochs increases, indicating that higher explore leads to wider minimum with a lower curvature. This is in line with the prediction from our hypothesis. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D LEARNING RATE SENSITIVITY</head><p>We performed sensitivity analysis of the starting learning rate, referred to as the seed learning rate, for Knee schedule. We trained the Cifar-10 dataset on Resnet-18 with the Knee schedule for a shortened budget of 150 epochs, starting at different seed LRs. For each experiment, we do a simple linear search to find the best explore duration. The test accuracies and optimal explore duration for the different seed LR choices is shown in <ref type="table" target="#tab_0">Table 17</ref>. As shown, the seed learning rate can impact the final accuracy, but Knee schedule is not highly sensitive to it. In fact, we can achieve the target accuracy of 95.1 with multiple seed learning rates of 0.05, 0.075, 0.0875 and 0.115, as compared to the original seed learning rate of 0.1, by tuning the number of explore epochs.</p><p>Another interesting observation is that the optimal explore duration varies inversely with the seed LR. Since a bigger learning rate has higher probability of escaping narrow minima compared to a lower learning rate, it would, on an average, require fewer steps to land in a wide minima. Thus, larger learning rates can explore faster, and spend more time in the exploit phase to go deeper in the wide minimum. This observation is thus consistent with our hypothesis and further corroborates it.</p><p>We also note that by tuning both seed LR and explore duration, we can achieve the twin objectives of achieving a higher accuracy, as well as a shorter training time -e.g. here we are able to achieve an accuracy of 95.34 in 150 epochs (seed LR 0.075), compared to 95.1 achieved by the baseline schedule in 200 epochs. In this section we compare Knee schedule against more learning rate schedules -one-cycle, linear decay and cosine decay.</p><p>One-Cycle: The one-cycle learning rate schedule was proposed in Smith (2018) (also see Smith <ref type="formula">(2017)</ref>). This schedule first chooses a maximum learning rate based on an LR Range test. The LR  <ref type="figure">Figure 4</ref>: LR Range test for selecting the maximum learning rate. A good choice is the learning rate is a bit before the minima in a region where the loss is still decreasing. range test starts from a small learning rate and keeps increasing the learning rate until the loss starts exploding (see <ref type="figure">figure 4</ref>). Smith (2018) suggests that the maximum learning rate should be chosen to be bit before the minima, in a region where the loss is still decreasing. There is some subjectivity in making this choice, although some blogs and libraries 7 suggest using a learning rate one order lower than the one at minima. We go with this choice for all our runs.</p><p>Once the maximum learning rate is chosen, the one-cycle schedule proceeds as follows. The learning rate starts at a specified fraction 8 of the maximum learning rate and is increased linearly to the maximum learning rate for 45 percent of the training budget and then decreased linearly for the remaining 45. For the final 10 percent, the learning rate is reduced by a large factor (we chose a factor of 10). We used an opensource implementation 9 for our experiments.</p><p>Linear Decay: The linear decay learning rate schedule simply decays the learning rate linearly to zero starting from a seed LR.  <ref type="figure">Figure 4a</ref> shows the LR range test for Cifar-10 with the Resnet-18 network. The minima occurs around learning rate of 0.09, and we choose 9e − 3 as the maximum learning rate for the One-Cycle runs. For linear, cosine decay schedules we start with a seed learning rate of 0.1 as used in the standard baselines. The training loss and test accuracy for the various schedules are shown in <ref type="table" target="#tab_0">Table 18</ref> for the full budget runs (200 epochs), and in <ref type="table" target="#tab_0">Table 19</ref> for the short budget runs (150 epochs).  E.2 IMAGENET <ref type="figure">Figure 4d</ref> shows the LR range test for ImageNet with the Resnet-50 network. The minima occurs around learning rate of 2.16, and we choose 0.216 as the maximum learning rate for One-Cycle runs. For linear, cosine decay schedules we start with a seed learning rate of 0.1 as used in the standard baselines. The training loss and test accuracy for the various schedules are shown in <ref type="table" target="#tab_1">Table 20</ref> for the full budget runs (90 epochs), and in <ref type="table" target="#tab_0">Table 21</ref> for the short budget runs (50 epochs).   <ref type="table" target="#tab_1">Table 22</ref> for the full budget runs (70 epochs), and in <ref type="table" target="#tab_1">Table 23</ref> for the short budget runs (30 epochs).   <ref type="figure">Figure 4b</ref> shows the LR range test for IWSLT on the transformer networks. The minima occurs near 2.5e-3. For the maximum learning rate, we choose 2.5e-4 for the default one-cycle policy. For linear, cosine decay schedules we start with a seed learning rate of 3e-4 as used in the standard baselines The training, validation perplexity and BLEU scores for the various schedules are shown in <ref type="table" target="#tab_1">Table 24</ref> for the full budget runs (50 epochs), and in <ref type="table" target="#tab_1">Table 25</ref> for the short budget runs (35 epochs). We choose 1e-5 as the maximum learning rate for One-Cycle runs as the minima occurs close to 1e-4 . For linear, cosine decays we start with a seed learning rate of 3e-5 as used in standard baselines. <ref type="table" target="#tab_1">Table 26</ref> show the average training loss, average test EM and F1 scores for the various schedules. We did not do a short budget training for this dataset, as the full budget is just 2 epochs.   Learning Rate vs Epochs <ref type="figure">Figure 7</ref>: BERT LARGE pretraining for batch size of 16k with LAMB optimizer for the short budget runs. Shown are the training loss and learning rate as a function of steps, for the baseline scheme short budget (orange) vs the Knee schedule scheme short budget (blue). The plot is split into 2 parts to give a clear picture of the two phases of training <ref type="bibr" target="#b5">Devlin et al. (2018)</ref>. Note that even though the training loss curves look similar for the two runs, we see a significant gap in F1 score obtained when we fine-tune the model checkpoints on SQuAD-v1.1 <ref type="bibr" target="#b25">Rajpurkar et al. (2016)</ref>. See <ref type="table" target="#tab_1">Table 27</ref>   <ref type="table" target="#tab_1">Table 27</ref>: SQuAD fine-tuning on BERT LARGE . We report F1 scores for 3 different trials as well as the maximum and average values. Learning Rate vs Epochs <ref type="figure">Figure 11</ref>: SQuAD-v1.1 fine-tuning on BERT BASE trained with Adam. Shown are the training loss, test EM score, and learning rate as a function of epochs, for the baseline scheme (orange) vs the Knee schedule scheme (blue). The plot is split into 2 parts to permit higher fidelity in the y-axis range. It is clear that with Knee schedule the network starts to overfit after the 2nd epoch, where the testing loss continues to go down, but generalization suffers. We saw similar behavior with different seeds, and thus need to train with Knee schedule for only 2 epochs.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2 :Figure 3 :</head><label>23</label><figDesc>Histogram of minima sharpness<ref type="bibr" target="#b16">(Keskar et al., 2016)</ref> for 50 random trials of Cifar-10 on Resnet-18. Each figure shows histograms for runs with different number of explore epochs. The distribution moves toward lower sharpness and tightens as the number of explore epochs increase.94.0 94.2 94.4 94.6 94.8 95.0 95.2 95.4 Histogram of test accuracy for 50 random trials of Cifar-10 on Resnet-18. Each figure shows histograms for runs with different number of explore epochs. The distribution moves toward higher test accuracy and sharpens as the number of explore epochs increase.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><label></label><figDesc>4 . We train WMT'14 (EN-DE) dataset on the Transformer BASE Vaswani et al. (2017) model which has around 86 million parameters and use the RAdam Liu et al. (2019) optimizer with β 1 of 0.9 and β 2 of 0.999. Label smoothed cross entropy was used as the objective function with an uncertainty of 0.1. A dropout of 0.1, clipping norm of 25 and weight decay of 1e-4 is used. Each training batch contains approximately 30000 tokens.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 6 :</head><label>6</label><figDesc>Cifar-10 on Resnet-18 trained with Momentum. Shown are the training loss, test accuracy and learning rate as a function of epochs, for the baseline scheme (orange) vs the Knee schedule scheme (blue). The plot is split into 3 parts to permit higher fidelity in the y-axis range.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 8 :Figure 9 :Figure 10 :</head><label>8910</label><figDesc>WMT'14 (EN-DE) on Transformer BASE network trained with RAdam. Shown are the training perplexity, validation perplexity and learning rate as a function of epochs, for the baseline scheme (orange) vs the Knee schedule scheme (blue). The plot is split into 3 parts to permit higher fidelity in the y-axis range. IWSLT'14 (DE-EN) on Transformer BASE network trained with RAdam. Shown are the training perplexity, validation perplexity and learning rate as a function of epochs, for the baseline scheme (orange) vs the Knee schedule scheme (blue). The plot is split into 3 parts to permit higher fidelity in the y-axis range. IWSLT'14 (DE-EN) on MAT network trained with Adam. Shown are the training perplexity, validation perplexity and learning rate as a function of epochs, for the baseline scheme (orange) vs the Knee schedule scheme (blue). MAT training involves two training phases with 200 epochs each, shown in separate columns above.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 1 :</head><label>1</label><figDesc>Cifar-10 on Resnet-18 trained for 200 epochs with Momentum. An LR of 0.1 is used for the explore epochs. Half the remaining epochs are trained at 0.01 and the other half at 0.001. Reported results are average over 4 runs.</figDesc><table><row><cell>Epochs at</cell><cell>Test Accuracy</cell><cell>Train Loss</cell></row><row><cell>0.1 LR</cell><cell cols="2">Avg. (Std. Dev) Avg. (Std. Dev.)</cell></row><row><cell>0</cell><cell>94.34 (0.13)</cell><cell>0.0017 (8e-5)</cell></row><row><cell>30</cell><cell>94.81 (0.15)</cell><cell>0.0017 (8e-5)</cell></row><row><cell>40</cell><cell>94.91 (0.14)</cell><cell>0.0018 (9e-5)</cell></row><row><cell>60</cell><cell>95.01 (0.14)</cell><cell>0.0018 (1e-4)</cell></row><row><cell>80</cell><cell>95.05 (0.15)</cell><cell>0.0019 (1e-4)</cell></row><row><cell>100</cell><cell>95.10 (0.14)</cell><cell>0.0021 (1e-4)</cell></row></table><note>Hypothesis. To explain the above observations, i.e., using a high learning rate for short duration results in low average test accuracy with rare occurrences of high test accuracy, while using the same high learning rate for long duration achieves high average test accuracy, we introduce a new hypoth- esis. We hypothesize that, in the DNN loss landscape, the density of narrow minima is significantly higher than that of wide minima.</note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 2</head><label>2</label><figDesc></figDesc><table /><note>, although the final training loss remains similar, we</note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 2</head><label>2</label><figDesc></figDesc><table><row><cell cols="4">: Cifar-10 on Resnet-18 trained for 200 epochs. An LR of 0.1 is used for the first 100 epochs.</cell></row><row><cell cols="4">We then vary the number of epochs trained with LR of 0.01 (called finer-scale explore), and train</cell></row><row><cell cols="4">the remaining epochs with an LR of 0.001. We report averages values over 3 runs.</cell></row><row><cell cols="4">Explore Epochs (Finer-scale) Test Accuracy Training Loss Sharpness</cell></row><row><cell>10</cell><cell>94.78</cell><cell>0.0031</cell><cell>5.48</cell></row><row><cell>20</cell><cell>94.91</cell><cell>0.0026</cell><cell>4.47</cell></row><row><cell>30</cell><cell>95.00</cell><cell>0.0023</cell><cell>4.02</cell></row><row><cell>40</cell><cell>95.02</cell><cell>0.0021</cell><cell>3.91</cell></row><row><cell>50</cell><cell>95.10</cell><cell>0.0021</cell><cell>3.54</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head>Table 3 :</head><label>3</label><figDesc>ImageNet on Resnet-50 results. We report mean (stddev) over 3 runs.</figDesc><table><row><cell>LR Schedule</cell><cell cols="4">Test Top 1 Acc. Test Top 5 Acc. Training Loss Training Epochs</cell></row><row><cell>Baseline</cell><cell>75.87 (0.035)</cell><cell>92.90 (0.015)</cell><cell>0.74 (1e-3)</cell><cell>90</cell></row><row><cell>Knee</cell><cell>76.71 (0.097)</cell><cell>93.32 (0.031)</cell><cell>0.79 (1e-3)</cell><cell>90</cell></row><row><cell>Knee (short budget)</cell><cell>75.92 (0.11)</cell><cell>92.90 (0.085)</cell><cell>0.90 (3e-3)</cell><cell>50</cell></row><row><cell cols="3">4.2 CIFAR-10 IMAGE CLASSIFICATION ON RESNET-18</cell><cell></cell><cell></cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5"><head>Table 4 :</head><label>4</label><figDesc>BERT LARGE results. We report the pre-training train loss, and the test F1 accuracy on SQuAD v1.1 after fine-tuning. See figure 7 in Appendix for training curves. MACHINE TRANSLATION ON TRANSFORMER NETWORK WITH WMT'14 AND IWSLT In the second NLP task, we train the Transformer (base model) (Vaswani et al., 2017) on the IWSLT'14 (De-En)<ref type="bibr" target="#b3">(Cettolo et al., 2014)</ref> and WMT'14 (En-De)<ref type="bibr" target="#b2">(Bojar et al., 2014)</ref> datasets with the RAdam<ref type="bibr" target="#b21">(Liu et al., 2019)</ref> optimizer.</figDesc><table><row><cell>LR Schedule</cell><cell cols="3">F1 score on SQuAD v1.1 Training loss Total Training Steps</cell></row><row><cell>Knee</cell><cell>91.51</cell><cell>1.248</cell><cell>31250</cell></row><row><cell>Baseline (You et al., 2019)</cell><cell>91.34</cell><cell>-</cell><cell>31250</cell></row><row><cell>Baseline (short budget)</cell><cell>90.64</cell><cell>1.336</cell><cell>20854</cell></row><row><cell>Knee (short budget)</cell><cell>91.29</cell><cell>1.275</cell><cell>20854</cell></row><row><cell>4.4</cell><cell></cell><cell></cell><cell></cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6"><head>Table 5</head><label>5</label><figDesc>shows the training loss and test accuracy averaged over 3 runs. Knee schedule improves the test BLEU score of baseline in the full budget run by 0.24 points. In the shorter budget run, Knee schedule matches the test accuracy of the baseline while taking 57% less training time (a saving of 80 V100 GPU-hours!)</figDesc><table /><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7"><head>Table 5 :</head><label>5</label><figDesc>Results for WMT'14 (EN-DE) on Transformer networks. The test BLEU scores are computed on the checkpoint with the best validation perplexity. We report mean (stdev) over 3 runs. The baseline schedule uses a linear decay for 50 epochs<ref type="bibr" target="#b21">(Liu et al., 2019)</ref>. With Knee schedule, we trained with the original budget of 50 epochs, as well as a reduced budget of 35 epochs. We used 40 and 30 explore epochs for the two runs, respectively and a seed LR of 3e − 4 for both Knee schedule and baseline. In all cases we use the model checkpoint with least loss on the validation set for computing BLEU scores on the test set.Table 6and 7 show the average test accuracy for full and reduced budget runs. Knee schedule improves the baseline test BLEU score by 0.56 points in the full budget run. In the shorter budget run, Knee schedule matches the test accuracy of the baseline schedule while taking 30% less training time. Also see</figDesc><table><row><cell>LR Schedule</cell><cell cols="4">Test BLEU Score Train Perplexity Validation Perplexity Training Epochs</cell></row><row><cell>Baseline</cell><cell>27.29 (0.06)</cell><cell>3.87 (0.017)</cell><cell>4.89 (0.02)</cell><cell>70</cell></row><row><cell>Knee</cell><cell>27.53 (0.12)</cell><cell>3.89 (0.017)</cell><cell>4.87 (0.006)</cell><cell>70</cell></row><row><cell>Knee (short budget)</cell><cell>27.28 (0.17)</cell><cell>4.31 (0.02)</cell><cell>4.92 (0.007)</cell><cell>30</cell></row><row><cell>IWSLT'14 (DE-EN):</cell><cell></cell><cell></cell><cell></cell><cell></cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_8"><head>Table 6 :</head><label>6</label><figDesc>We report the top-1 accuracy for ImageNet and Cifar-10, BLEU score for IWSLT'14 and WMT'14 and F1 score for BERT on SQuAD. All values are averaged over multiple runs.</figDesc><table><row><cell>Experiment</cell><cell>Training Budget (epochs)</cell><cell>Knee Schedule</cell><cell>Knee Schedule (Fixed 50% explore)</cell><cell cols="2">Baseline One-Cycle</cell><cell>Cosine Decay</cell><cell>Linear Decay</cell></row><row><cell>ImageNet</cell><cell>90</cell><cell>76.71</cell><cell>76.58</cell><cell>75.87</cell><cell>75.39</cell><cell>76.41</cell><cell>76.54</cell></row><row><cell>Cifar-10</cell><cell>200</cell><cell>95.26</cell><cell>95.26</cell><cell>95.10</cell><cell>94.09</cell><cell>95.23</cell><cell>95.18</cell></row><row><cell>IWSLT</cell><cell>50</cell><cell>35.53</cell><cell>35.23</cell><cell>34.97</cell><cell>34.77</cell><cell>35.21</cell><cell>34.97</cell></row><row><cell>WMT'14</cell><cell>70</cell><cell>27.53</cell><cell>27.41</cell><cell>27.29</cell><cell>27.19</cell><cell>27.35</cell><cell>27.29</cell></row><row><cell cols="2">BERTLARGE 31250 (iters)</cell><cell>91.51</cell><cell>91.51</cell><cell>91.34</cell><cell>-</cell><cell>-</cell><cell>91.34</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_9"><head>Table 7 :</head><label>7</label><figDesc>Shorter budget training: Test accuracy on all learning rate schedules tried in this paper, but trained with a shortened budget. We report same metrics asTable 6. Knee schedule achieves the same accuracy as baseline schedules in much lower budget, saving precious GPU-hours.</figDesc><table><row><cell cols="2">Experiment Shortened Training</cell><cell>Knee</cell><cell cols="3">One-Cycle Cosine Linear</cell><cell>Saving</cell></row><row><cell></cell><cell>Budget (epochs)</cell><cell>Schedule</cell><cell></cell><cell cols="3">Decay Decay ( V100 GPU-hours)</cell></row><row><cell>ImageNet</cell><cell>50</cell><cell>75.92</cell><cell>75.36</cell><cell>75.71</cell><cell>75.82</cell><cell>27</cell></row><row><cell>Cifar-10</cell><cell>150</cell><cell>95.14</cell><cell>93.84</cell><cell>95.06</cell><cell>95.02</cell><cell>0.25</cell></row><row><cell>IWSLT</cell><cell>35</cell><cell>35.08</cell><cell>34.43</cell><cell>34.46</cell><cell>34.16</cell><cell>0.75</cell></row><row><cell>WMT'14</cell><cell>30</cell><cell>27.28</cell><cell>26.80</cell><cell>26.95</cell><cell>26.77</cell><cell>80</cell></row><row><cell>BERTLARGE</cell><cell>20854 (iterations)</cell><cell>91.29</cell><cell>-</cell><cell>-</cell><cell>90.64</cell><cell>1002</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_10"><head>Table 8 :</head><label>8</label><figDesc>Epochs required by different LR schedules to reach the target accuracy. Experiment Target BLEU Score Knee schedule Cosine Decay Linear Decay achieving SOTA test accuracies, when trained with the original training budget, and achieves the same test accuracy as the baseline when trained with a much shorter budget. 7 ACKNOWLEDGEMENT We would like to thank Sanjith Athlur for his help in setting up VM cluster for large training runs and Harshay Shah for helpful discussions. Piotr A Sokol and Il Memming Park. Information geometry of orthogonal initializations and training. arXiv preprint arXiv:1810.03785, 2018. Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. Attention is all you need. In Advances in neural information processing systems, pp. 5998-6008, 2017. Huan Wang, Nitish Shirish Keskar, Caiming Xiong, and Richard Socher. Identifying generalization properties in neural networks. arXiv preprint arXiv:1809.07402, 2018. Lei Wu, Chao Ma, and E Weinan. How sgd selects the global minima in over-parameterized learning: A dynamical stability perspective. In Advances in Neural Information Processing Systems, pp. 8279-8288, 2018. Yuichi Yoshida and Takeru Miyato. Spectral norm regularization for improving the generalizability of deep learning. arXiv preprint arXiv:1705.10941, 2017.</figDesc><table><row><cell>IWSLT</cell><cell>35.08</cell><cell>35</cell><cell>45</cell><cell>60</cell></row><row><cell>WMT'14</cell><cell>27.28</cell><cell>30</cell><cell>60</cell><cell>70</cell></row><row><cell>baselines, including</cell><cell></cell><cell></cell><cell></cell><cell></cell></row></table><note>Yang You, Jing Li, Sashank Reddi, Jonathan Hseu, Sanjiv Kumar, Srinadh Bhojanapalli, Xiaodan Song, James Demmel, Kurt Keutzer, and Cho-Jui Hsieh. Large batch optimization for deep learning: Training bert in 76 minutes. In International Conference on Learning Representations, 2019.</note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_11"><head>Table 9 :</head><label>9</label><figDesc>IWSLT'14 (DE-EN) on the Transformer network trained with the Knee schedule. The explore duration is varied, while keeping the total training budget fixed at 50 epochs. We report averages over 3 runs.</figDesc><table><row><cell cols="3">Explore Epochs Test BLEU score Training Perplexity</cell></row><row><cell>5</cell><cell>34.93</cell><cell>3.29</cell></row><row><cell>10</cell><cell>35.02</cell><cell>3.22</cell></row><row><cell>15</cell><cell>35.08</cell><cell>3.11</cell></row><row><cell>20</cell><cell>35.10</cell><cell>3.08</cell></row><row><cell>25</cell><cell>35.23</cell><cell>3.02</cell></row><row><cell>30</cell><cell>35.28</cell><cell>2.99</cell></row><row><cell>40</cell><cell>35.53</cell><cell>3.00</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_12"><head>Table 10</head><label>10</label><figDesc></figDesc><table><row><cell cols="4">: Training loss and Test accuracy for Cifar-10 on Resnet-18. We report mean (stddev) over</cell></row><row><cell>7 runs.</cell><cell></cell><cell></cell><cell></cell></row><row><cell>LR Schedule</cell><cell cols="3">Test Accuracy Training Loss Training Epochs</cell></row><row><cell>Baseline</cell><cell>95.10 (0.14)</cell><cell>0.002 (1e-4)</cell><cell>200 epochs</cell></row><row><cell>Knee</cell><cell>95.26 (0.11)</cell><cell>0.002 (1e-4)</cell><cell>200 epochs</cell></row><row><cell>Knee (short budget)</cell><cell>95.14 (0.18)</cell><cell>0.004 (3e-4)</cell><cell>150 epochs</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_13"><head>Table 11 :</head><label>11</label><figDesc>Training, validation perplexity and test BLEU scores for IWSLT on Transformer networks. The test BLEU scores are computed on the checkpoint with the best validation perplexity. We report the mean and standard deviation over 3 runs.</figDesc><table><row><cell>LR Schedule</cell><cell>Test BLEU Score</cell><cell>Train Perplexity</cell><cell>Validation Perplexity</cell><cell>Training Epochs</cell></row><row><cell>Baseline</cell><cell cols="3">34.97 (0.035) 3.36 (0.001) 4.91 (0.035)</cell><cell>50</cell></row><row><cell>Knee</cell><cell>35.53 (0.06)</cell><cell>3.00 (0.044)</cell><cell>4.86 (0.02)</cell><cell>50</cell></row><row><cell>Knee (short budget)</cell><cell>35.08 (0.12)</cell><cell cols="2">3.58 (0.049) 4.90 (0.063)</cell><cell>35</cell></row><row><cell cols="5">B.5 STATE OF THE ART RESULTS USING THE MAT MODEL WITH IWSLT'14 (DE-EN) AND</cell></row><row><cell cols="2">WMT'14 (DE-EN) DATASETS</cell><cell></cell><cell></cell><cell></cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_14"><head>Table 12 :</head><label>12</label><figDesc>Training, validation perplexity and test BLEU scores for IWSLT'14 DE-EN on MAT. The test BLEU scores are computed on the checkpoint with the best validation perplexity. Results are averaged over 3 runs.</figDesc><table><row><cell>LR Schedule</cell><cell>Test BLEU Score</cell><cell>Train Perplexity</cell><cell>Validation Perplexity</cell><cell>Training Epochs</cell></row><row><cell>Baseline (inv. sqrt)</cell><cell>36.20 (0.02)</cell><cell cols="3">3.87 ( 0.009) 4.58 (0.009) 200 + 200 (each phase)</cell></row><row><cell>Knee schedule</cell><cell cols="4">36.59 (0.017) 3.74 (0.012) 4.45 ( 0.009) 200 + 200 (each phase)</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_15"><head>Table 13 :</head><label>13</label><figDesc>Training, validation perplexity and test BLEU scores for WMT'14 DE-EN on MAT. The test BLEU scores are computed on the checkpoint with the best validation perplexity.</figDesc><table><row><cell>LR Schedule</cell><cell>Test BLEU Score</cell><cell cols="2">Train Perplexity Perplexity Validation</cell><cell>Training Epochs</cell></row><row><cell>Baseline (inv. sqrt)</cell><cell>31.34</cell><cell>4.78</cell><cell>4.75</cell><cell>70 + 70 (each phase)</cell></row><row><cell>Knee schedule</cell><cell>31.90</cell><cell>4.67</cell><cell>4.68</cell><cell>70 + 70 (each phase)</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_16"><head>Table 14 :</head><label>14</label><figDesc>SQuAD fine-tuning on BERT BASE . We report the average training loss, and average test EM, F1 scores over 3 runs.</figDesc><table><row><cell>LR Schedule</cell><cell>EM</cell><cell>F1</cell><cell>Train Loss</cell><cell>Training Epochs</cell></row><row><cell>Baseline</cell><cell cols="3">80.89 (0.15) 88.38 (0.032) 1.0003 (0.004)</cell><cell>2</cell></row><row><cell cols="3">Knee schedule 81.38 (0.02) 88.66 (0.045)</cell><cell>1.003 (0.002)</cell><cell>2</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_17"><head>Table 15 :</head><label>15</label><figDesc>Keskar's sharpness metric for Cifar-10 on Resnet-18 trained for 200 epochs with Momentum. An LR of 0.1 is used for the explore epochs. Half the remaining epochs are trained at 0.01 and the other half at 0.001. We report the average sharpness over 50 different trials.</figDesc><table><row><cell cols="2">Explore Epochs Sharpness</cell></row><row><cell>0</cell><cell>10.56</cell></row><row><cell>30</cell><cell>5.43</cell></row><row><cell>60</cell><cell>3.86</cell></row><row><cell>100</cell><cell>3.54</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_18"><head>Table 16 :</head><label>16</label><figDesc>FIM Score for Cifar-10 on Resnet-18 trained for 200 epochs with Momentum. A LR of 0.1 is used for the explore epochs. Half the remaining epochs are trained at 0.01 and the other half at 0.001. We report the average FIM score over 10 different trials.</figDesc><table><row><cell cols="2">Explore Epochs FIM score</cell></row><row><cell>0</cell><cell>0.051</cell></row><row><cell>30</cell><cell>0.046</cell></row><row><cell>60</cell><cell>0.043</cell></row><row><cell>100</cell><cell>0.042</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_19"><head>Table 17 :</head><label>17</label><figDesc>Seed LR sensitivity analysis. Cifar-10 on Resnet-18 trained for 150 epochs with Knee schedule. We vary the seed LR and explore epochs to get the best test accuracy for the particular setting. We report averages over 3 runs.</figDesc><table><row><cell cols="3">Seed LR Test Accuracy Optimal Explore Epochs</cell></row><row><cell>0.03</cell><cell>95.07</cell><cell>120</cell></row><row><cell>0.05</cell><cell>95.12</cell><cell>120</cell></row><row><cell>0.0625</cell><cell>95.15</cell><cell>120</cell></row><row><cell>0.075</cell><cell>95.34</cell><cell>100</cell></row><row><cell>0.0875</cell><cell>95.22</cell><cell>100</cell></row><row><cell>0.1</cell><cell>95.14</cell><cell>100</cell></row><row><cell>0.115</cell><cell>95.20</cell><cell>60</cell></row><row><cell>0.125</cell><cell>95.06</cell><cell>60</cell></row><row><cell>0.15</cell><cell>95.04</cell><cell>30</cell></row><row><cell cols="3">E COMPARISONS WITH MORE BASELINE LEARNING RATE SCHEDULES</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_20"><head></head><label></label><figDesc>Cosine Decay: The cosine decay learning rate schedule decays the learning rate to zero following a cosine curve, starting from a seed LR. See e.g. https://towardsdatascience.com/finding-good-learning-rate-and-the-one-cycle-policy-71 and https://sgugger.github.io/how-do-you-find-a-good-learning-rate.html. Also see https://docs.fast.ai/callbacks.lr_finder.html and https://docs.fast. ai/callbacks.one_cycle.html 8 See div factor in https://docs.fast.ai/callbacks.one_cycle.html. We chose the fraction to be 0.1 in our experiments.</figDesc><table><row><cell>E.1 CIFAR-10</cell></row><row><cell>https://github.com/nachiket273/One_Cycle_Policy</cell></row></table><note>79</note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_21"><head>Table 18 :</head><label>18</label><figDesc>Cifar-10 on Resnet-18 full budget training (200 epochs): Training loss and Test accuracy for more learning rate schedules. We report the mean and standard deviation over 7 runs.</figDesc><table><row><cell>LR Schedule</cell><cell>Test Accuracy</cell><cell>Train Loss</cell></row><row><cell>One-Cycle</cell><cell>94.08 (0.07)</cell><cell>0.0041 (6e-5)</cell></row><row><cell>Cosine Decay</cell><cell>95.23 (0.11)</cell><cell>0.0023 (9e-5)</cell></row><row><cell>Linear Decay</cell><cell>95.18 (0.15)</cell><cell>0.0018 (7e-5)</cell></row><row><cell>Knee schedule</cell><cell>95.26 (0.11)</cell><cell>0.0023 (1e-4)</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_22"><head>Table 19</head><label>19</label><figDesc></figDesc><table><row><cell cols="3">: Cifar-10 on Resnet-18 short budget training (150 epochs): Training loss and Test accuracy</cell></row><row><cell cols="3">for more learning rate schedules. We report the mean and standard deviation over 7 runs.</cell></row><row><cell>LR Schedule</cell><cell>Test Accuracy</cell><cell>Train Loss</cell></row><row><cell>One-Cycle</cell><cell cols="2">93.84 (0.082) 0.0052 (7e-5)</cell></row><row><cell>Cosine Decay</cell><cell>95.06 (0.16)</cell><cell>0.0030 (2e-4)</cell></row><row><cell>Linear Decay</cell><cell>95.02 (0.10)</cell><cell>0.0021 (1e-4)</cell></row><row><cell>Knee schedule</cell><cell>95.14 (0.18)</cell><cell>0.0044 (3e-4)</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_23"><head>Table 20</head><label>20</label><figDesc></figDesc><table><row><cell cols="4">: ImageNet with ResNet-50 full budget training (90 epochs): Training loss, Test Top-1 and</cell></row><row><cell cols="4">Test Top-5 for more learning rate schedules. We report the mean and standard deviation over 3 runs.</cell></row><row><cell>LR Schedule</cell><cell>Test Top-1</cell><cell>Test Top-5</cell><cell>Train Loss (av)</cell></row><row><cell>One Cycle</cell><cell cols="2">75.39 (0.137) 92.56 (0.040)</cell><cell>0.96 (0.003)</cell></row><row><cell cols="3">Cosine Decay 76.41 (0.212) 93.28 (0.066)</cell><cell>0.80 (0.002)</cell></row><row><cell>Linear decay</cell><cell cols="2">76.54 (0.155) 93.21 (0.051)</cell><cell>0.75 (0.001)</cell></row><row><cell cols="3">Knee schedule 76.71 (0.097) 93.32 (0.031)</cell><cell>0.79 (0.001)</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_24"><head>Table 21</head><label>21</label><figDesc>the LR range test for WMT'14 EN-DE on the transformer networks. The minima occurs near 1.25e-3. For the maximum learning rate, we choose 2.5e-4 for the default one-cycle policy. For linear, cosine decay schedules we start with a seed learning rate of 3e-4 as used in the standard baselines The training, validation perplexity and BLEU scores for the various schedules are shown in</figDesc><table><row><cell cols="4">: ImageNet with ResNet-50 short budget training (50 epochs): Training loss, Test Top-1</cell></row><row><cell cols="4">and Test Top-5 for more learning rate schedules. We report the mean and standard deviation over 3</cell></row><row><cell>runs.</cell><cell></cell><cell></cell><cell></cell></row><row><cell>LR Schedule</cell><cell>Test Top-1</cell><cell>Test Top-5</cell><cell>Train Loss (av)</cell></row><row><cell>One Cycle</cell><cell cols="2">75.36 (0.096) 92.53 (0.079)</cell><cell>1.033 (0.004)</cell></row><row><cell cols="3">Cosine Decay 75.71 (0.116) 92.81 (0.033)</cell><cell>0.96 (0.002)</cell></row><row><cell>Linear decay</cell><cell cols="2">75.82 (0.080) 92.84 (0.036)</cell><cell>0.91 (0.002)</cell></row><row><cell>Knee schedule</cell><cell>75.92 (0.11)</cell><cell>92.90 (0.085)</cell><cell>0.90 (0.003)</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_25"><head>Table 22</head><label>22</label><figDesc></figDesc><table><row><cell cols="4">: WMT'14 (EN-DE) on Transformer networks full budget training (70 epochs): Training,</cell></row><row><cell cols="4">validation perplexity and test BLEU scores for more learning rate schedules. The test BLEU scores</cell></row><row><cell cols="4">are computed on the checkpoint with the best validation perplexity. We report the mean and standard</cell></row><row><cell>deviation over 3 runs.</cell><cell></cell><cell></cell><cell></cell></row><row><cell>LR Schedule</cell><cell>Test BLEU Score</cell><cell>Train ppl</cell><cell>Validation ppl</cell></row><row><cell>One-Cycle</cell><cell>27.19 (0.081)</cell><cell>3.96 (0.014)</cell><cell>4.95 (0.013)</cell></row><row><cell>Cosine Decay</cell><cell>27.35 (0.09)</cell><cell>3.87 (0.011)</cell><cell>4.91 (0.008)</cell></row><row><cell>Linear Decay</cell><cell>27.29 (0.06)</cell><cell>3.87 (0.017)</cell><cell>4.89 (0.02)</cell></row><row><cell>Knee schedule</cell><cell>27.53 (0.12)</cell><cell>3.89 (0.017)</cell><cell>4.87 (0.006)</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_26"><head>Table 23 :</head><label>23</label><figDesc> on Transformer networks short budget training (30 epochs): Training, validation perplexity and test BLEU scores for more learning rate schedules. The test BLEU scores are computed on the checkpoint with the best validation perplexity. We report the mean and standard deviation over 3 runs.</figDesc><table><row><cell>LR Schedule</cell><cell>Test BLEU Score</cell><cell>Train ppl</cell><cell>Validation ppl</cell></row><row><cell>One-Cycle</cell><cell>26.80 (0.2)</cell><cell>4.38 (0.017)</cell><cell>5.02 (0.007)</cell></row><row><cell>Cosine Decay</cell><cell>26.95 (0.23)</cell><cell>4.32 (0.013)</cell><cell>4.99 (0.011)</cell></row><row><cell>Linear Decay</cell><cell>26.77 (0.12)</cell><cell>4.36 (0.092)</cell><cell>5.02 (0.01)</cell></row><row><cell>Knee schedule</cell><cell>27.28 (0.17)</cell><cell>4.31 (0.02)</cell><cell>4.92 (0.007)</cell></row><row><cell>E.4 IWSLT'14 DE-EN</cell><cell></cell><cell></cell><cell></cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_27"><head>Table 24 :</head><label>24</label><figDesc>IWSLT'14 (DE-EN) on Transformer networks full budget training (50 epochs): Training, validation perplexity and test BLEU scores for more learning rate schedules. The test BLEU scores are computed on the checkpoint with the best validation perplexity. We report the mean and standard deviation over 3 runs.</figDesc><table><row><cell>LR Schedule</cell><cell>Test BLEU Score</cell><cell>Train ppl</cell><cell>Validation ppl</cell></row><row><cell>One-Cycle</cell><cell>34.77 (0.064)</cell><cell>3.68 (0.009)</cell><cell>4.97 (0.010)</cell></row><row><cell>Cosine Decay</cell><cell>35.21 (0.063)</cell><cell>3.08 (0.004)</cell><cell>4.88 (0.014)</cell></row><row><cell>Linear Decay</cell><cell>34.97 (0.035)</cell><cell>3.36 (0.001)</cell><cell>4.92 (0.035)</cell></row><row><cell>Knee schedule</cell><cell>35.53 (0.06)</cell><cell>3.00 (0.044)</cell><cell>4.86 (0.02)</cell></row><row><cell cols="2">E.5 SQUAD-V1.1 FINETUNING WITH BERT BASE</cell><cell></cell><cell></cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_28"><head>Table 25 :</head><label>25</label><figDesc> on Transformer networks short budget training (35 epochs): Training, validation perplexity and test BLEU scores for more learning rate schedules. The test BLEU scores are computed on the checkpoint with the best validation perplexity. We report the mean and standard deviation over 3 runs.</figDesc><table><row><cell>LR Schedule</cell><cell>Test BLEU Score</cell><cell>Train ppl</cell><cell>Validation ppl</cell></row><row><cell>One-Cycle</cell><cell>34.43 (0.26)</cell><cell>3.98 (0.028)</cell><cell>5.09 (0.017)</cell></row><row><cell>Cosine Decay</cell><cell>34.46 (0.33)</cell><cell>3.86 (0.131)</cell><cell>5.06 (0.106)</cell></row><row><cell>Linear Decay</cell><cell>34.16 (0.28)</cell><cell>4.11 (0.092)</cell><cell>5.14 (0.066)</cell></row><row><cell>Knee schedule</cell><cell>35.08 (0.12)</cell><cell>3.58 (0.063)</cell><cell>4.90 (0.049)</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_29"><head>Table 26 :</head><label>26</label><figDesc>SQuAD-v1.1 fine-tuning on BERT BASE for more learning rate schedules. We report the average training loss, average test EM, F1 scores over 3 runs. ImageNet on Resnet-50 trained with Momentum. Shown are the training loss, top-1/top-5 test accuracy and learning rate as a function of epochs, for the baseline scheme (orange) vs the Knee schedule scheme (blue). The plot is split into 3 parts to permit higher fidelity in the y-axis range.</figDesc><table><row><cell>LR Schedule</cell><cell>EM (av)</cell><cell>F1 (av)</cell><cell>Train Loss (av)</cell></row><row><cell>One Cycle</cell><cell>79.9 (0.17)</cell><cell>87.8 (0.091)</cell><cell>1.062 (0.003)</cell></row><row><cell cols="3">Cosine Decay 81.31 (0.07) 88.61 (0.040)</cell><cell>0.999 (0.003)</cell></row><row><cell>Linear decay</cell><cell cols="3">80.89 (0.15) 88.38 (0.042) 1.0003 (0.004)</cell></row><row><cell cols="3">Knee schedule 81.38 (0.02) 88.66 (0.045)</cell><cell>1.003 (0.002)</cell></row></table><note></note></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1">We used the opensource implementation at: https://github.com/cybertronai/imagenet18 old2  We used the open-source implementation at: https://github.com/kuangliu/pytorch-cifar3  We used the open-source implementation at: https://github.com/NVIDIA/DeepLearningExamples/tree/master/PyTorch/LanguageModeling/BERT 4 https://github.com/pytorch/fairseq</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="5">https://github.com/HA-Transformer/HA-Transformer</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="6">We used the implementation at: https://github.com/huggingface/pytorch-transformers</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m" type="main">Stronger generalization bounds for deep nets via a compression approach</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sanjeev</forename><surname>Arora</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Rong</forename><surname>Ge</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Behnam</forename><surname>Neyshabur</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yi</forename><surname>Zhang</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1802.05296</idno>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">Shaping the learning landscape in neural networks around wide flat minima. CoRR, abs</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Carlo</forename><surname>Baldassi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Fabrizio</forename><surname>Pittorino</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Riccardo</forename><surname>Zecchina</surname></persName>
		</author>
		<ptr target="http://arxiv.org/abs/1905.07833" />
		<imprint>
			<date type="published" when="1905" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">and Ale s Tamchyna. Findings of the 2014 workshop on statistical machine translation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ondrej</forename><surname>Bojar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christian</forename><surname>Buck</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christian</forename><surname>Federmann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Barry</forename><surname>Haddow</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Philipp</forename><surname>Koehn</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Johannes</forename><surname>Leveling</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christof</forename><surname>Monz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Pavel</forename><surname>Pecina</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Matt</forename><surname>Post</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Herve</forename><surname>Saint-Amand</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Radu</forename><surname>Soricut</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Lucia</forename><surname>Specia</surname></persName>
		</author>
		<ptr target="http://www.aclweb.org/anthology/W/W14/W14-3302" />
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Ninth Workshop on Statistical Machine Translation</title>
		<meeting>the Ninth Workshop on Statistical Machine Translation<address><addrLine>Baltimore, Maryland, USA</addrLine></address></meeting>
		<imprint>
			<publisher>Association for Computational Linguistics</publisher>
			<date type="published" when="2014-06" />
			<biblScope unit="page" from="12" to="58" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Report on the 11th iwslt evaluation campaign, iwslt</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mauro</forename><surname>Cettolo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jan</forename><surname>Niehues</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sebastian</forename><surname>Stüker</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Luisa</forename><surname>Bentivogli</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Marcello</forename><surname>Federico</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the International Workshop on Spoken Language Translation</title>
		<meeting>the International Workshop on Spoken Language Translation<address><addrLine>Hanoi, Vietnam</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2014" />
			<biblScope unit="page">57</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Entropy-sgd: Biasing gradient descent into wide valleys</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Pratik</forename><surname>Chaudhari</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Anna</forename><surname>Choromanska</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Stefano</forename><surname>Soatto</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yann</forename><surname>Lecun</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Carlo</forename><surname>Baldassi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christian</forename><surname>Borgs</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jennifer</forename><surname>Chayes</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Levent</forename><surname>Sagun</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Riccardo</forename><surname>Zecchina</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Statistical Mechanics: Theory and Experiment</title>
		<imprint>
			<biblScope unit="volume">2019</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page">124018</biblScope>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jacob</forename><surname>Devlin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ming-Wei</forename><surname>Chang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kenton</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kristina</forename><forename type="middle">Toutanova</forename><surname>Bert</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1810.04805</idno>
		<title level="m">Pre-training of deep bidirectional transformers for language understanding</title>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Sharp minima can generalize for deep nets</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Laurent</forename><surname>Dinh</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Razvan</forename><surname>Pascanu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Samy</forename><surname>Bengio</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 34th International Conference on Machine Learning</title>
		<meeting>the 34th International Conference on Machine Learning</meeting>
		<imprint>
			<date type="published" when="2017" />
			<biblScope unit="volume">70</biblScope>
			<biblScope unit="page" from="1019" to="1028" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yang</forename><surname>Fan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Shufang</forename><surname>Xie</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yingce</forename><surname>Xia</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Lijun</forename><surname>Wu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Tao</forename><surname>Qin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xiang-Yang</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Tie-Yan</forename><surname>Liu</surname></persName>
		</author>
		<idno type="arXiv">arXiv:2006.10270</idno>
		<title level="m">Multibranch attentive transformer</title>
		<imprint>
			<date type="published" when="2020" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title level="m" type="main">Time matters in regularizing deep networks: Weight decay and data augmentation affect early learning dynamics</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Aditya</forename><surname>Golatkar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alessandro</forename><surname>Achille</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Stefano</forename><surname>Soatto</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1905.13277</idno>
		<imprint>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
	<note>matter little near convergence</note>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Priya</forename><surname>Goyal</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Piotr</forename><surname>Dollár</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ross</forename><surname>Girshick</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Pieter</forename><surname>Noordhuis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Lukasz</forename><surname>Wesolowski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Aapo</forename><surname>Kyrola</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1706.02677</idno>
		<title level="m">Andrew Tulloch, Yangqing Jia, and Kaiming He. Accurate, large minibatch sgd: Training imagenet in 1 hour</title>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title level="m" type="main">Towards understanding generalization in gradientbased meta-learning</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Simon</forename><surname>Guiroy</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Vikas</forename><surname>Verma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christopher</forename><surname>Pal</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1907.07287</idno>
		<imprint>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Deep residual learning for image recognition</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kaiming</forename><surname>He</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xiangyu</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Shaoqing</forename><surname>Ren</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jian</forename><surname>Sun</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the IEEE conference on computer vision and pattern recognition</title>
		<meeting>the IEEE conference on computer vision and pattern recognition</meeting>
		<imprint>
			<date type="published" when="2016" />
			<biblScope unit="page" from="770" to="778" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Flat minima</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sepp</forename><surname>Hochreiter</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jürgen</forename><surname>Schmidhuber</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Neural Computation</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="42" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Stanisław</forename><surname>Jastrzebski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zachary</forename><surname>Kenton</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Devansh</forename><surname>Arpit</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nicolas</forename><surname>Ballas</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Asja</forename><surname>Fischer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Amos</forename><surname>Storkey</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1711.04623</idno>
		<title level="m">Three factors influencing minima in sgd</title>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">On the relation between the sharpest directions of DNN loss and the SGD step length</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Stanisław</forename><surname>Jastrzebski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zachary</forename><surname>Kenton</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nicolas</forename><surname>Ballas</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Asja</forename><surname>Fischer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Amost</forename><surname>Storkey</surname></persName>
		</author>
		<ptr target="https://openreview.net/forum?id=SkgEaj05t7" />
	</analytic>
	<monogr>
		<title level="m">International Conference on Learning Representations</title>
		<imprint>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Deep learning without poor local minima</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kenji</forename><surname>Kawaguchi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Advances in neural information processing systems</title>
		<imprint>
			<date type="published" when="2016" />
			<biblScope unit="page" from="586" to="594" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Dheevatsa</forename><surname>Nitish Shirish Keskar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jorge</forename><surname>Mudigere</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Nocedal</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1609.04836</idno>
		<title level="m">Mikhail Smelyanskiy, and Ping Tak Peter Tang. On large-batch training for deep learning: Generalization gap and sharp minima</title>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b17">
	<monogr>
		<title level="m" type="main">Adam: A method for stochastic optimization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Diederik</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jimmy</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Ba</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1412.6980</idno>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
		<title level="m" type="main">Adam: A method for stochastic optimization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Diederik</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jimmy</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Ba</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1412.6980</idno>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b19">
	<monogr>
		<title level="m" type="main">Learning multiple layers of features from tiny images</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alex</forename><surname>Krizhevsky</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Geoffrey</forename><surname>Hinton</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2009" />
			<publisher>Citeseer</publisher>
		</imprint>
	</monogr>
	<note type="report_type">Technical report</note>
</biblStruct>

<biblStruct xml:id="b20">
	<monogr>
		<title level="m" type="main">Limitations of the empirical fisher approximation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Frederik</forename><surname>Kunstner</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Lukas</forename><surname>Balles</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Philipp</forename><surname>Hennig</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1905.12558</idno>
		<imprint>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b21">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Liyuan</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Haoming</forename><surname>Jiang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Pengcheng</forename><surname>He</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Weizhu</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xiaodong</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jianfeng</forename><surname>Gao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jiawei</forename><surname>Han</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1908.03265</idno>
		<title level="m">On the variance of the adaptive learning rate and beyond</title>
		<imprint>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b22">
	<monogr>
		<title level="m" type="main">Sgdr: Stochastic gradient descent with warm restarts</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ilya</forename><surname>Loshchilov</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Frank</forename><surname>Hutter</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1608.03983</idno>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<title level="m" type="main">An empirical model of large-batch training</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sam</forename><surname>Mccandlish</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jared</forename><surname>Kaplan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Dario</forename><surname>Amodei</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Openai Dota</forename><surname>Team</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1812.06162</idno>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">fairseq: A fast, extensible toolkit for sequence modeling</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Myle</forename><surname>Ott</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sergey</forename><surname>Edunov</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alexei</forename><surname>Baevski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Angela</forename><surname>Fan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sam</forename><surname>Gross</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nathan</forename><surname>Ng</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Grangier</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael</forename><surname>Auli</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of NAACL-HLT 2019: Demonstrations</title>
		<meeting>NAACL-HLT 2019: Demonstrations</meeting>
		<imprint>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<monogr>
		<title level="m" type="main">Squad: 100,000+ questions for machine comprehension of text</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Pranav</forename><surname>Rajpurkar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jian</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Konstantin</forename><surname>Lopyrev</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Percy</forename><surname>Liang</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1606.05250</idno>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Imagenet large scale visual recognition challenge</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Olga</forename><surname>Russakovsky</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jia</forename><surname>Deng</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Hao</forename><surname>Su</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jonathan</forename><surname>Krause</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sanjeev</forename><surname>Satheesh</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sean</forename><surname>Ma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zhiheng</forename><surname>Huang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Andrej</forename><surname>Karpathy</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Aditya</forename><surname>Khosla</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael</forename><surname>Bernstein</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">International journal of computer vision</title>
		<imprint>
			<biblScope unit="volume">115</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="211" to="252" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Christopher</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jaehoon</forename><surname>Shallue</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joe</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jascha</forename><surname>Antognini</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Roy</forename><surname>Sohl-Dickstein</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">George</forename><forename type="middle">E</forename><surname>Frostig</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Dahl</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1811.03600</idno>
		<title level="m">Measuring the effects of data parallelism on neural network training</title>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Cyclical learning rates for training neural networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Leslie</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Smith</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">2017 IEEE Winter Conference on Applications of Computer Vision (WACV)</title>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2017" />
			<biblScope unit="page" from="464" to="472" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<monogr>
		<title level="m" type="main">A disciplined approach to neural network hyper-parameters: Part 1-learning rate, batch size, momentum, and weight decay</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Leslie</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Smith</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1803.09820</idno>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
