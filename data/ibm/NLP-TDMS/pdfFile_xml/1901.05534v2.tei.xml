<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /nfs/home/kabenamualus/Research/task-dataset-metric-extraction/../grobid-0.6.0/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">LAGGING INFERENCE NETWORKS AND POSTERIOR COLLAPSE IN VARIATIONAL AUTOENCODERS</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Junxian</forename><surname>He</surname></persName>
							<email>junxianh@cs.cmu.edu</email>
							<affiliation key="aff0">
								<orgName type="institution">Carnegie Mellon University</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Daniel</forename><surname>Spokoyny</surname></persName>
							<email>dspokoyn@cs.cmu.edu</email>
							<affiliation key="aff0">
								<orgName type="institution">Carnegie Mellon University</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Graham</forename><surname>Neubig</surname></persName>
							<email>gneubig@cs.cmu.edu</email>
							<affiliation key="aff0">
								<orgName type="institution">Carnegie Mellon University</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Taylor</forename><surname>Berg-Kirkpatrick</surname></persName>
							<affiliation key="aff1">
								<orgName type="institution">University of California</orgName>
								<address>
									<settlement>San Diego</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">LAGGING INFERENCE NETWORKS AND POSTERIOR COLLAPSE IN VARIATIONAL AUTOENCODERS</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<note>Published as a conference paper at ICLR 2019</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>

		<encodingDesc>
			<appInfo>
				<application version="0.6.0" ident="GROBID-SDO" when="2021-06-26T07:05+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid-sdo"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>The variational autoencoder (VAE) is a popular combination of deep latent variable model and accompanying variational learning technique. By using a neural inference network to approximate the model's posterior on latent variables, VAEs efficiently parameterize a lower bound on marginal data likelihood that can be optimized directly via gradient methods. In practice, however, VAE training often results in a degenerate local optimum known as "posterior collapse" where the model learns to ignore the latent variable and the approximate posterior mimics the prior. In this paper, we investigate posterior collapse from the perspective of training dynamics. We find that during the initial stages of training the inference network fails to approximate the model's true posterior, which is a moving target. As a result, the model is encouraged to ignore the latent encoding and posterior collapse occurs. Based on this observation, we propose an extremely simple modification to VAE training to reduce inference lag: depending on the model's current mutual information between latent variable and observation, we aggressively optimize the inference network before performing each model update. Despite introducing neither new model components nor significant complexity over basic VAE, our approach is able to avoid the problem of collapse that has plagued a large amount of previous work. Empirically, our approach outperforms strong autoregressive baselines on text and image benchmarks in terms of held-out likelihood, and is competitive with more complex techniques for avoiding collapse while being substantially faster. 1 1 Code and data are available at https</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Variational autoencoders (VAEs) <ref type="bibr" target="#b17">(Kingma &amp; Welling, 2014)</ref> represent a popular combination of a deep latent variable model (shown in <ref type="figure" target="#fig_1">Figure 1(a)</ref>) and an accompanying variational learning technique. The generative model in VAE defines a marginal distribution on observations, x ∈ X , as:</p><formula xml:id="formula_0">p θ (x) = p θ (x|z)p(z)dz.</formula><p>(1)</p><p>The model's generator defines p θ (x|z) and is typically parameterized as a complex neural network. Standard training involves optimizing an evidence lower bound (ELBO) on the intractable marginal data likelihood (Eq.1), where an auxiliary variational distribution q φ (z|x) is introduced to approximate the model posterior distribution p θ (z|x). VAEs make this learning procedure highly scalable to large datasets by sharing parameters in the inference network to amortize inferential cost. This amortized approach contrasts with traditional variational techniques that have separate local variational parameters for every data point <ref type="bibr" target="#b1">(Blei et al., 2003;</ref><ref type="bibr" target="#b14">Hoffman et al., 2013)</ref>.</p><p>While successful on some datasets, prior work has found that VAE training often suffers from "posterior collapse", in which the model ignores the latent variable z <ref type="bibr" target="#b2">(Bowman et al., 2016;</ref><ref type="bibr" target="#b18">Kingma et al., 2016;</ref><ref type="bibr" target="#b4">Chen et al., 2017)</ref>. This phenomenon is more common when the generator p θ (x|z) is parametrized with a strong autoregressive neural network, for example, an LSTM <ref type="bibr" target="#b12">(Hochreiter &amp; Schmidhuber, 1997</ref>) on text or a PixelCNN (van den Oord et al., 2016) on images. Posterior collapse is especially evident when modeling discrete data, which hinders the usage of VAEs in  important applications like natural language processing. Existing work analyzes this problem from a static optimization perspective, noting that the collapsed solution is often a reasonably good local optimum in terms of ELBO <ref type="bibr" target="#b4">(Chen et al., 2017;</ref><ref type="bibr" target="#b31">Zhao et al., 2017;</ref><ref type="bibr" target="#b0">Alemi et al., 2018)</ref>. Thus, many proposed solutions to posterior collapse focus on weakening the generator by replacing it with a non-recurrent alternative <ref type="bibr" target="#b30">(Yang et al., 2017;</ref><ref type="bibr" target="#b24">Semeniuta et al., 2017)</ref> or modifying the training objective <ref type="bibr" target="#b31">(Zhao et al., 2017;</ref><ref type="bibr" target="#b26">Tolstikhin et al., 2018)</ref>. In this paper, we analyze the problem from the perspective of training dynamics and propose a novel training procedure for VAEs that addresses posterior collapse. In contrast with other solutions, our proposed procedure optimizes the standard ELBO objective and does not require modification to the VAE model or its parameterization.</p><formula xml:id="formula_1">= " &gt; A A A C Q n i c b V B N S 8 N A E N 3 4 b f 2 K e v S y W A Q P p a Q i q I h Q 9 O K x g l W h K W W z 3 Z j F 3 W z Y n Y g l 5 M f 4 Y 8 S r H v 0 N n s S r B z d p D l o d W O b t m z f D z A s S w Q 1 4 3 p s z N T 0 z O z e / s F h b W l 5 Z X X P X N 6 6 M S j V l X a q E 0 j c B M U z w m H W B g 2 A 3 i W Z E B o J d B 3 d n R f 3 6 n m n D V X w J o 4 T 1 J b m N e c g p A U s N 3 G N f p o P M l w S i I M w e 8 g b 2 A 5 n 5 S c T z H J / g / 6 s Q M S B 5 P n D r X t M r A / 8 F r Q r U U R W d g f v h D x V N J Y u B C m J M r + U l 0 M + I B k 4 F y 2 t + a l h C 6 B 2 5 Z T 0 L Y y K Z 6 W f l k T n e s c w Q h 0 r b F w M u 2 Z 8 d G Z G m W N Q q i 2 R + 1 Q o G l B K m Y V U Q y S I V Y 8 q / G c m g E c h G I d I m N B O L Q H j Y z 3 i c p M B i O t 4 j T A U G h Q t D 8 Z B r R k G M L C B U c 3 s K p h H R h I K 1 v W Y 9 a k 0 6 8 h d 0 9 5 p H T e 9 i v 9 4 + r c x a Q F t o G + 2 i F j p A b X S O O q i L K H p E z + g F v T p P z r v z 4 X y O p V N O 1 b O J f o X z 9 Q 0 l J b M X &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " 8 v n u d 1 + p s g y 2 E O 9 E Z d P k D c M D h n Q = " &gt; A A A C Q n i c b V B N S 8 N A E N 3 4 b f 2 K e v S y W A Q P p a Q i q I h Q 9 O K x g l W h K W W z 3 Z j F 3 W z Y n Y g l 5 M f 4 Y 8 S r H v 0 N n s S r B z d p D l o d W O b t m z f D z A s S w Q 1 4 3 p s z N T 0 z O z e / s F h b W l 5 Z X X P X N 6 6 M S j V l X a q E 0 j c B M U z w m H W B g 2 A 3 i W Z E B o J d B 3 d n R f 3 6 n m n D V X w J o 4 T 1 J b m N e c g p A U s N 3 G N f p o P M l w S i I M w e 8 g b 2 A 5 n 5 S c T z H J / g / 6 s Q M S B 5 P n D r X t M r A / 8 F r Q r U U R W d g f v h D x V N J Y u B C m J M r + U l 0 M + I B k 4 F y 2 t + a l h C 6 B 2 5 Z T 0 L Y y K Z 6 W f l k T n e s c w Q h 0 r b F w M u 2 Z 8 d G Z G m W N Q q i 2 R + 1 Q o G l B K m Y V U Q y S I V Y 8 q / G c m g E c h G I d I m N B O L Q H j Y z 3 i c p M B i O t 4 j T A U G h Q t D 8 Z B r R k G M L C B U c 3 s K p h H R h I K 1 v W Y 9 a k 0 6 8 h d 0 9 5 p H T e 9 i v 9 4 + r c x a Q F t o G + 2 i F j p A b X S O O q i L K H p E z + g F v T p P z r v z 4 X y O p V N O 1 b O J f o X z 9 Q 0 l J b M X &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " 8 v n u d 1 + p s g y 2 E O 9 E Z d P k D c M D h n Q = " &gt; A A A C Q n i c b V B N S 8 N A E N 3 4 b f 2 K e v S y W A Q P p a Q i q I h Q 9 O K x g l W h K W W z 3 Z j F 3 W z Y n Y g l 5 M f 4 Y 8 S r H v 0 N n s S r B z d p D l o d W O b t m z f D z A s S w Q 1 4 3 p s z N T 0 z O z e / s F h b W l 5 Z X X P X N 6 6 M S j V l X a q E 0 j c B M U z w m H W B g 2 A 3 i W Z E B o J d B 3 d n R f 3 6 n m n D V X w J o 4 T 1 J b m N e c g p A U s N 3 G N f p o P M l w S i I M w e 8 g b 2 A 5 n 5 S c T z H J / g / 6 s Q M S B 5 P n D r X t M r A / 8 F r Q r U U R W d g f v h D x V N J Y u B C m J M r + U l 0 M + I B k 4 F y 2 t + a l h C 6 B 2 5 Z T 0 L Y y K Z 6 W f l k T n e s c w Q h 0 r b F w M u 2 Z 8 d G Z G m W N Q q i 2 R + 1 Q o G l B K m Y V U Q y S I V Y 8 q / G c m g E c h G I d I m N B O L Q H j Y z 3 i c p M B i O t 4 j T A U G h Q t D 8 Z B r R k G M L C B U c 3 s K p h H R h I K 1 v W Y 9 a k 0 6 8 h d 0 9 5 p H T e 9 i v 9 4 + r c x a Q F t o G + 2 i F j p A b X S O O q i L K H p E z + g F v T p P z r v z 4 X y O p V N O 1 b O J f o X z 9 Q 0 l J b M X &lt; / l a t e x i t &gt; (b) Posterior mean space</formula><p>Recently,  proposed a new approach to training VAEs by composing the standard inference network with additional mean-field updates. The resulting semi-amortized approach empirically avoided collapse and obtained better ELBO. However, because of the costly instancespecific local inference steps, the new method is more than 10x slower than basic VAE training in practice. It is also unclear why the basic VAE method fails to find better local optima that make use of latents. We consider two questions in this paper: (1) Why does basic VAE training often fall into undesirable collapsed local optima? (2) Is there a simpler way to change the training trajectory to find a non-trivial local optimum?</p><p>To this end, we first study the posterior collapse problem from the perspective of training dynamics. We find, empirically, that the posterior approximation often lags far behind the true model posterior in the initial stages of training (Section 3). We then demonstrate how such lagging behavior can drive the generative model towards a collapsed local optimum, and propose a novel training procedure for VAEs that aggressively optimizes the inference network with more updates to mitigate lag (Section 4). Without introducing new modeling components over basic VAEs or additional complexity, our approach is surprisingly simple yet effective in circumventing posterior collapse. As a density estimator, it outperforms neural autoregressive baselines on both text (Yahoo and Yelp) and image (OMNIGLOT) benchmarks, leading to comparable performance with more complicated previous state-of-the-art methods at a fraction of the training cost (Section 6).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">BACKGROUND</head><p>2.1 VARIATIONAL AUTOENCODERS VAEs learn deep generative models defined by a prior p(z) and a conditional distribution p θ (x|z) as shown in <ref type="figure" target="#fig_1">Figure 1(a)</ref>. In most cases the marginal data likelihood is intractable, so VAEs instead optimize a tractable variational lower bound (ELBO) of log p θ (x),</p><formula xml:id="formula_2">L(x; θ, φ) = E z∼q φ (z|x) [log p θ (x|z)] Reconstruction Loss − D KL (q φ (z|x) p(z)) KL Regularizer ,<label>(2)</label></formula><p>where q φ (z|x) is a variational distribution parameterized by an inference network with parameters φ, and p θ (x|z) denotes the generator network with parameters θ. q φ (z|x) is optimized to approximate the model posterior p θ (z|x). This lower bound is composed of a reconstruction loss term that encourages the inference network to encode information necessary to generate the data and a KL regularizer to push q φ (z|x) towards the prior p(z). Below, we consider p(z) := N (0, I) unless otherwise specified. A key advantage of using inference networks (also called amortized inference) to train deep generative models over traditional locally stochastic variational inference <ref type="bibr" target="#b14">(Hoffman et al., 2013)</ref> is that they share parameters over all data samples, amortizing computational cost and allowing for efficient training.</p><p>The term VAE is often used both to denote the class of generative models and the amortized inference procedure used in training. In this paper, it is important to distinguish the two and throughout we will refer to the generative model as the VAE model, and the training procedure as VAE training.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">POSTERIOR COLLAPSE</head><p>Despite VAE's appeal as a tool to learn unsupervised representations through the use of latent variables, as mentioned in the introduction, VAE models are often found to ignore latent variables when using flexible generators like LSTMs <ref type="bibr" target="#b2">(Bowman et al., 2016)</ref>. This problem of "posterior collapse" occurs when the training procedure falls into the trivial local optimum of the ELBO objective in which both the variational posterior and true model posterior collapse to the prior. This is undesirable because an important goal of VAEs is to learn meaningful latent features for inputs. Mathematically, posterior collapse represents a local optimum of VAEs where q φ (z|x) = p θ (z|x) = p(z) for all x.</p><p>To facilitate our analysis about the causes leading up to collapse, we further define two partial collapse states: model collapse, when p θ (z|x) = p(z), and inference collapse, when q φ (z|x) = p(z) for all x. Note that in this paper we use these two terms to denote the posterior states in the middle of training instead of local optima at the end. These two partial collapse states may not necessarily happen at the same time, which we will discuss later.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">VISUALIZATION OF POSTERIOR DISTRIBUTION</head><p>Posterior collapse is closely related to the true model posterior p θ (z|x) and the approximate posterior q φ (z|x) as it is defined. Thus, in order to observe how posterior collapse happens, we track the state of p θ (z|x) and q φ (z|x) over the course of training, and analyze the training trajectory in terms of the posterior mean space</p><formula xml:id="formula_3">U = {µ : µ = (µ T x,θ , µ T x,φ )},</formula><p>where µ x,θ and µ x,φ are the means of p θ (z|x) and q φ (z|x), respectively. <ref type="bibr">2</ref> We can then roughly consider µ x,θ = 0 as model collapse and µ x,φ = 0 as inference collapse as we defined before. Each x will be projected to a point in this space under the current model and inference network parameters. If z is a scalar we can efficiently compute µ x,θ and visualize the posterior mean space as shown in <ref type="figure" target="#fig_1">Figure 1</ref>(b). The diagonal line µ x,θ = µ x,φ represents parameter settings where q φ (z|x) is equal to p θ (z|x) in terms of mean, indicating a well-trained inference network. The collapsed local optimum is located at the origin, 3 while the data points at a more desirable local optima may be distributed along the diagonal. In this paper we will utilize this posterior mean space multiple times to analyze the posterior dynamics.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">A LAGGING INFERENCE NETWORK PREVENTS USING LATENT CODES</head><p>In this section we analyze posterior collapse from a perspective of training dynamics. We will answer the question of why the basic VAE training with strong decoders tends to hit a collapsed local optimum and provide intuition for the simple solution we propose in Section 4. </p><formula xml:id="formula_4">p ✓ (z|x) is log p ✓ (x). However, the dependence (if any) may be lost if q (z|x) is still close to p(z) because p ✓ (z|x) would be pressured to agree with q (z|x) [This is important, but I think not very clear. Could you be more explicit? -GN].</formula><p>To examine the dynamic relationship between approximate posterior q (z|x), model posterior p ✓ (z|x), and prior p(z) during basic VAE training, we will next visualize the posterior mean-value space by training a basic VAE with a one-dimensional ["scalar"? -GN] latent variable on a relatively simple synthetic dataset.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">OBSERVATIONS ON SYNTHETIC DATA</head><p>As a synthetic dataset we use discrete sequence data, as posterior collapse has been found the most severe in text modeling tasks. To mimic the diversity of the real data distribution, we sample discrete data from a deep generative model, with a [[[four-mode mixture of Gaussian prior -four-modes of a Gaussian mixture as a prior?]]] and an LSTM generator. More details about this synthetic dataset and experiment details can be found in Appendix B.1.</p><p>We train a basic VAE with a one-dimensional latent variable, LSTM encoder, and LSTM decoder 2 on our synthetic dataset. We sample 500 data points and show them on the posterior mean space plots at four different training stages from beginning to convergence in <ref type="figure" target="#fig_2">Figure 2</ref>. The mean value of the approximate posterior distribution µ x, is from the output of the inference network, and µ x,✓ is approximated by:</p><formula xml:id="formula_5">E z⇠p ✓ (z|x) [z] = X zi2C [z i p(z i |x)],<label>(5)</label></formula><p>where C is a grid set with small stride and sufficiently large coverage. We assume the density value outside this grid set is zero. p ✓ (z|x) is also approximated on this grid.</p><p>As illustrated in <ref type="figure" target="#fig_2">Figure 2</ref>, all points are located at origin <ref type="bibr">[[[after-upon]</ref>]] initialization, which means z and x are both almost independent and zero mean at the beginning of training. In the second stage, the points starts to spread along the µ x,✓ axis. This phenomenon implies that for some data points p ✓ (z|x) moves far away from the prior p(z), and confirms that log p ✓ (x) is able to help escape model collapse. However, all of these points are still close to the µ x, axis, which suggests that q (z|x) fails to catch up to p ✓ (z|x) and these points are still in an inference collapsed state. </p><formula xml:id="formula_6">iter = 0 iter = 200 iter = 2000 convergence Basic Aggressive µ x,✓ &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " X W K g l M N T 3 f l z + H v E 5 P z z k x a y / d Q = " &gt; A A A C J H i c Z V B N S w M x E M 3 W r 1 q / q h 5 F C B b B Q y l b E d R b 0 Y v H C t Y W u q V k 0 2 w b m m y W Z F Y s y 5 7 8 M e J V f 4 c n 8 e D F / + A / M L v t w d a B M C 9 v 3 g w z z 4 8 E N + C 6 X 0 5 h a X l l d a 2 4 X t r Y 3 N r e K e / u 3 R s V a 8 p a V A m l O z 4 x T P C Q t Y C D Y J 1 I M y J 9 w d r + + D q r t x + Y N l y F d z C J W E + S Y c g D T g l Y q l 8 + 9 G T c T z x J Y O Q H y W N a x Z 4 v E w 9 G D E i a 9 s s V t + b m g f + D + g x U 0 C y a / f K P N 1 A 0 l i w E K o g x 3 b o b Q S 8 h G j g V L C 1 5 s W E R o W M y Z F 0 L Q y K Z 6 S X 5 G S k + t s w A B 0 r b F w L O 2 b 8 d C Z E m W 9 Q q s 2 T m a h k D S g l T t S o Y y S x l Y / K / m U i / 6 s t q J t I m M A u L Q H D R S 3 g Y x c B C O t 0 j i A U G h T P L 8 I B r R k F M L C B U c 3 s K p i O i C Q V r b M l 6 V F 9 0 5 D 9 o n d Y u a + 7 t W a V x N T O r i A 7 Q E T p B d X S O G u g G N V E L U f S E X t A r e n O e n X f n w / m c S g v O r G c f z Y X z / Q s 8 k a a P &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " X W K g l M N T 3 f l z + H v E 5 P z z k x a y / d Q = " &gt; A A A C J H i c Z V B N S w M x E M 3 W r 1 q / q h 5 F C B b B Q y l b E d R b 0 Y v H C t Y W u q V k 0 2 w b m m y W Z F Y s y 5 7 8 M e J V f 4 c n 8 e D F / + A / M L v t w d a B M C 9 v 3 g w z z 4 8 E N + C 6 X 0 5 h a X l l d a 2 4 X t r Y 3 N r e K e / u 3 R s V a 8 p a V A m l O z 4 x T P C Q t Y C D Y J 1 I M y J 9 w d r + + D q r t x + Y N l y F d z C J W E + S Y c g D T g l Y q l 8 + 9 G T c T z x J Y O Q H y W N a x Z 4 v E w 9 G D E i a 9 s s V t + b m g f + D + g x U 0 C y a / f K P N 1 A 0 l i w E K o g x 3 b o b Q S 8 h G j g V L C 1 5 s W E R o W M y Z F 0 L Q y K Z 6 S X 5 G S k + t s w A B 0 r b F w L O 2 b 8 d C Z E m W 9 Q q s 2 T m a h k D S g l T t S o Y y S x l Y / K / m U i / 6 s t q J t I m M A u L Q H D R S 3 g Y x c B C O t 0 j i A U G h T P L 8 I B r R k F M L C B U c 3 s K p i O i C Q V r b M l 6 V F 9 0 5 D 9 o n d Y u a + 7 t W a V x N T O r i A 7 Q E T p B d X S O G u g G N V E L U f S E X t A r e n O e n X f n w / m c S g v O r G c f z Y X z / Q s 8 k a a P &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " X W K g l M N T 3 f l z + H v E 5 P z z k x a y / d Q = " &gt; A A A C J H i c Z V B N S w M x E M 3 W r 1 q / q h 5 F C B b B Q y l b E d R b 0 Y v H C t Y W u q V k 0 2 w b m m y W Z F Y s y 5 7 8 M e J V f 4 c n 8 e D F / + A / M L v t w d a B M C 9 v 3 g w z z 4 8 E N + C 6 X 0 5 h a X l l d a 2 4 X t r Y 3 N r e K e / u 3 R s V a 8 p a V A m l O z 4 x T P C Q t Y C D Y J 1 I M y J 9 w d r + + D q r t x + Y N l y F d z C J W E + S Y c g D T g l Y q l 8 + 9 G T c T z x J Y O Q H y W N a x Z 4 v E w 9 G D E i a 9 s s V t + b m g f + D + g x U 0 C y a / f K P N 1 A 0 l i w E K o g x 3 b o b Q S 8 h G j g V L C 1 5 s W E R o W M y Z F 0 L Q y K Z 6 S X 5 G S k + t s w A B 0 r b F w L O 2 b 8 d C Z E m W 9 Q q s 2 T m a h k D S g l T t S o Y y S x l Y / K / m U i / 6 s t q J t I m M A u L Q H D R S 3 g Y x c B C O t 0 j i A U G h T P L 8 I B r R k F M L C B U c 3 s K p i O i C Q V r b M l 6 V F 9 0 5 D 9 o n d Y u a + 7 t W a V x N T O r i A 7 Q E T p B d X S O G u g G N V E L U f S E X t A r e n O e n X f n w / m c S g v O r G c f z Y X z / Q s 8 k a a P &lt; / l a t e x i t &gt; µ x,</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">INTUITIONS FROM ELBO</head><p>Since posterior collapse is directly relevant to the approximate posterior q φ (z|x) and true model posterior p θ (z|x), we aim to analyze their training dynamics to study how posterior collapse happens. To this end, it is useful to analyze an alternate form of ELBO:</p><formula xml:id="formula_7">L(x; θ, φ) = log p θ (x) marginal log data likelihood − D KL (q φ (z|x) p θ (z|x))</formula><p>agreement between approximate and model posteriors ,</p><p>With this view, the only goal of approximate posterior q φ (z|x) is to match model posterior p θ (z|x), while the optimization of p θ (z|x) is influenced by two forces, one of which is the ideal objective marginal data likelihood, and the other is D KL (q φ (z|x) p θ (z|x)), which drives p θ (z|x) towards q φ (z|x). Ideally if the approximate posterior is perfect, the second force will vanish, with ∇ θ D KL (q φ (z|x)|p θ (z|x)) = 0 when q φ (z|x) = p θ (z|x). At the start of training, z and x are nearly independent under both q φ (z|x) and p θ (z|x) as we show in Section 3.2, i.e. all x suffer from model collapse in the beginning. Then the only component in the training objective that possibly causes dependence between z and x under p θ (z|x) is log p θ (x). However, this pressure may be overwhelmed by the KL term when p θ (z|x) and q φ (z|x) start to diverge but z and x remain independent under q φ (z|x). We hypothesize that, in practice, training drives p θ (z|x) and q φ (z|x) to the prior in order to bring them into alignment, while locking into model parameters that capture the distribution of x while ignoring z. Critically, posterior collapse is a local optimum; once a set of parameters that achieves these goals are reached, gradient optimization fails to make further progress, even if better overall models that make use of z to describe x exist.</p><p>Next we visualize the posterior mean space by training a basic VAE with a scalar latent variable on a relatively simple synthetic dataset to examine our hypothesis.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">OBSERVATIONS ON SYNTHETIC DATA</head><p>As a synthetic dataset we use discrete sequence data since posterior collapse has been found the most severe in text modeling tasks. Details on this synthetic dataset and experiment are in Appendix B.1.</p><p>We train a basic VAE with a scalar latent variable, LSTM encoder, and LSTM decoder on our synthetic dataset. We sample 500 data points from the validation set and show them on the posterior mean space plots at four different training stages from initialization to convergence in <ref type="figure" target="#fig_2">Figure 2</ref>. The mean of the approximate posterior distribution µ x,φ is from the output of the inference network, and µ x,θ can be approximated by discretization of the true model posterior p θ (z|x) (see Appendix A). X ← Random data minibatch 7:</p><p>Compute gradients g φ ← ∇ φ L(X; θ, φ) 8:</p><p>Update φ using gradients g φ 9:</p><p>until convergence 10:</p><p>X ← Random data minibatch 11:</p><p>Compute gradients g θ ← ∇ θ L(X; θ, φ)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>12:</head><p>Update θ using gradients g θ 13:  As illustrated in <ref type="figure" target="#fig_2">Figure 2</ref>, all points are located at the origin upon initialization 4 , which means z and x are almost independent in terms of both q φ (z|x) and p θ (z|x) at the beginning of training. In the second stage of basic VAE training, the points start to spread along the µ x,θ axis. This phenomenon implies that for some data points p θ (z|x) moves far away from the prior p(z), and confirms that log p θ (x) is able to help move away from model collapse. However, all of these points are still distributed along a horizontal line, which suggests that q φ (z|x) fails to catch up to p θ (z|x) and these points are still in a state of inference collapse. As expected, the dependence between z and x under p θ (z|x) is gradually lost and finally the model converges to the collapsed local optimum.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">METHOD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">AGGRESSIVE TRAINING OF THE INFERENCE NETWORK</head><p>The problem reflected in <ref type="figure" target="#fig_2">Figure 2</ref> implies that the inference network is lagging far behind p θ (z|x), and might suggest more "aggressive" inference network updates are needed. Instead of blaming the poor approximation on the limitation of the inference network's amortization, we hypothesize that the optimization of the inference and generation networks are imbalanced, and propose to separate the optimization of the two. Specifically, we change the training procedure to:</p><formula xml:id="formula_9">θ * = arg max θ L(X; θ, φ * ), where φ * = arg max φ L(X; θ, φ),<label>(4)</label></formula><p>where optimizing the inference network q φ (z|x) is an inner loop in the entire training process as shown in Algorithm 1. This training procedure shares the same spirit with traditional stochastic variational inference (SVI) (Hoffman et al., 2013) that performs iterative inference for each data point separately and suffers from very lengthy iterative estimation. Compared with recent work that try to combine amortized variational inference and SVI <ref type="bibr" target="#b11">(Hjelm et al., 2016;</ref><ref type="bibr" target="#b19">Krishnan et al., 2018;</ref><ref type="bibr" target="#b21">Marino et al., 2018)</ref> where the inference network is learned to be a component to help perform instance-specific variational inference, our approach keeps variational inference fully amortized, allowing for reverting back to efficient basic VAE training as discussed in Section 4.2. Also, this aggressive inference network optimization algorithm is as simple as basic VAE training without introducing additional SVI steps, yet attains comparable performance to more sophisticated approaches as we will show in Section 6.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">STOPPING CRITERION</head><p>Always training with Eq.4 would be inefficient and neglects the benefit of the amortized inference network. Following our previous analysis, the term D KL (q φ (z|x) p θ (z|x)) tends to pressure q φ (z|x) or p θ (z|x) to p(z) only if at least one of them is close to p(z), and thus we posit that if we can confirm that we haven't reached this degenerate condition, we can continue with standard VAE training. Since q φ (z|x) is the one lagging behind, we use the mutual information I q between z and x under q φ (z|x) to control our stopping criterion. In practice, we compute the mutual information on the validation set every epoch, and stop the aggressive updates when I q stops climbing. In all our experiments in this paper we found that the aggressive algorithm usually reverts back to basic VAE training within 5 epochs. Mutual information, I q can be computed by <ref type="bibr" target="#b13">(Hoffman &amp; Johnson, 2016)</ref>:</p><formula xml:id="formula_10">I q = E x∼p d (x) [D KL (q φ (z|x)||p(z))] − D KL (q φ (z) p(z)),<label>(5)</label></formula><p>where p d (x) is the empirical distribution. The aggregated posterior,</p><formula xml:id="formula_11">q φ (z) = E x∼p d (x) [q φ (z|x)],</formula><p>can be approximated with a Monte Carlo estimate. D KL (q φ (z) p(z)) is also approximated by Monte Carlo, where samples from q φ (z) can be easily obtained by ancestral sampling (i.e. sample</p><p>x from dataset and sample z ∼ q φ (z|x)). This estimator for I q is the same as in <ref type="bibr" target="#b7">(Dieng et al., 2018)</ref>, which is biased because the estimation for D KL (q φ (z) p(z)) is biased. More specifically, it is a Monte Carlo estimate of an upper bound of mutual information. The complete algorithm is shown in Algorithm 1.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">OBSERVATIONS ON SYNTHETIC DATASET</head><p>By training the VAE model with our approach on synthetic data, we visualize the 500 data samples in the posterior mean space in <ref type="figure" target="#fig_2">Figure 2</ref>. From this, it is evident that the points move towards µ x,θ = µ x,φ and are roughly distributed along the diagonal in the end. This is in striking contrast to the basic VAE and confirms our hypothesis that the inference and generator optimization can be rebalanced by simply performing more updates of the inference network. In <ref type="figure" target="#fig_4">Figure 3</ref> we show the training trajectory of one single data instance for the first several optimization iterations and observe how the aggressive updates help escape inference collapse.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">RELATION TO RELATED WORK</head><p>Posterior collapse in VAEs is first detailed in <ref type="bibr" target="#b2">(Bowman et al., 2016)</ref> where they combine a LSTM decoder with VAE for text modeling. They interpret this problem from a regularization perspective, and propose the "KL cost annealing" method to address this issue, whereby the weight of KL term between approximate posterior and prior increases from a small value to one in a "warm-up" period. This method has been shown to be unable to deal with collapse on complex text datasets with very large LSTM decoders <ref type="bibr" target="#b30">(Yang et al., 2017;</ref>. Many works follow this line to lessen the effect of KL term such as β-VAE <ref type="bibr" target="#b10">(Higgins et al., 2017)</ref> that treats the KL weight as a hyperparameter or "free bits" method that constrains the minimum value of the KL term. Our approach differs from these methods in that we do not change ELBO objective during training and are in principle still performing maximum likelihood estimation. While these methods explicitly encourage the use of the latent variable, they may implicitly sacrifice density estimation performance at the same time, as we will discuss in Section 6.</p><p>Another thread of research focuses on a different problem called the "amortization gap" <ref type="bibr" target="#b5">(Cremer et al., 2018)</ref>, which refers to the difference of ELBO caused by parameter sharing of the inference network. Some approaches try to combine instance-specific variational inference with amortized variational inference to narrow this gap <ref type="bibr" target="#b11">(Hjelm et al., 2016;</ref><ref type="bibr" target="#b19">Krishnan et al., 2018;</ref><ref type="bibr" target="#b21">Marino et al., 2018)</ref>. The most related example is SA-VAE , which mixes instance-specific variational inference and empirically avoids posterior collapse. Our approach is much simpler without sacrificing performance, yet achieves an average of 5x training speedup.</p><p>Other attempts to address posterior collapse include proposing new regularizers <ref type="bibr" target="#b31">(Zhao et al., 2017;</ref><ref type="bibr" target="#b8">Goyal et al., 2017;</ref><ref type="bibr" target="#b26">Tolstikhin et al., 2018;</ref><ref type="bibr" target="#b23">Phuong et al., 2018)</ref>, deploying less powerful decoders <ref type="bibr" target="#b30">(Yang et al., 2017;</ref><ref type="bibr" target="#b24">Semeniuta et al., 2017)</ref>, using lossy input <ref type="bibr" target="#b4">(Chen et al., 2017)</ref>, utilizing different latent variable connections <ref type="bibr" target="#b6">(Dieng et al., 2017;</ref><ref type="bibr" target="#b22">Park et al., 2018)</ref>, or changing the prior <ref type="bibr" target="#b27">(Tomczak &amp; Welling, 2018;</ref><ref type="bibr" target="#b29">Xu &amp; Durrett, 2018)</ref>.  <ref type="bibr" target="#b30">(Yang et al., 2017)</ref> ≤332.1 10.0 --≤359.1 7.6 --SA-VAE + anneal  ≤327  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">EXPERIMENTS</head><p>Our experiments below are designed to (1) examine whether the proposed method indeed prevents posterior collapse, (2) test its efficacy with respect to maximizing predictive log-likelihood compared to other existing approaches, and (3) test its training efficiency.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.1">SETUP</head><p>For all experiments we use a Gaussian prior N (0, I) and the inference network parametrizes a diagonal Gaussian. We evaluate with approximate negative log likelihood (NLL) as estimated by 500 importance weighted samples 5 <ref type="bibr" target="#b3">(Burda et al., 2016)</ref> since it produces a tighter lower bound to marginal data log likelihood than ELBO (ELBO values are included in Appendix C), and should be more accurate. We also report D KL (q φ (z|x) p(z)) (KL), mutual information I q (MI), and number of active units (AU) <ref type="bibr" target="#b3">(Burda et al., 2016)</ref>   <ref type="figure">Figure 4</ref>: NLL versus AU (active units) for all models on three datasets. For each model we display 5 points which represent 5 runs with different random seeds. "Autoregressive" denotes LSTM-LM for text data and PixelCNN for image data. We plot "autoregressive" baselines as their AU is 0. To better visualize the system difference on OMNIGLOT dataset, for OMNIGLOT figure we ignore some β-VAE baselines that are not competitive.</p><p>As baselines, we compare with strong neural autoregressive models (LSTM-LM for text and Pixel-CNN (van den Oord et al., 2016) for images), basic VAE, the "KL cost annealing" method <ref type="bibr" target="#b2">(Bowman et al., 2016;</ref><ref type="bibr" target="#b25">Sønderby et al., 2016)</ref>, β-VAE <ref type="bibr" target="#b10">(Higgins et al., 2017)</ref>, and SA-VAE  which holds the previous state-of-the-art performance on text modeling benchmarks. For β-VAE we vary β between 0.2, 0.4, 0.6, and 0.8. SA-VAE is ran with 10 refinement steps. We also examine the effect of KL cost annealing on both SA-VAE and our approach. To facilitate our analysis later, we report the results in two categories: "Standard VAE objectives", and "Modified VAE objectives". <ref type="bibr">6</ref> We evaluate our method on density estimation for text on the Yahoo and Yelp corpora <ref type="bibr" target="#b30">(Yang et al., 2017)</ref> and images on <ref type="bibr">OMNIGLOT (Lake et al., 2015)</ref>. Following the same configuration as in , we use a single layer LSTM as encoder and decoder for text. For images, we use a ResNet <ref type="bibr" target="#b9">(He et al., 2016)</ref> encoder and a 13-layer Gated PixelCNN (van den Oord et al., 2016) decoder. We use 32-dimensional z and optimize ELBO objective with SGD for text and Adam <ref type="bibr" target="#b16">(Kingma &amp; Ba, 2015)</ref> for images. We concatenate z to the input for the decoders. For text, z also predicts the initial hidden state of the LSTM decoder. We dynamically binarize images during training and test on fixed binarized test data. We run all models with 5 different random restarts, and report mean and standard deviation. Full details of the setup are in Appendix B.2 and B.3.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2">RESULTS</head><p>In <ref type="table" target="#tab_2">Table 1 and Table 2</ref> we show the results on all three datasets, we also plot NLL vs AU for every trained model from separate runs in <ref type="figure">Figure 4</ref> to visualize the uncertainties. Our method achieves comparable or better performance than previous state-of-the-art systems on all three datasets. Note that to examine the posterior collapse issue for images we use a larger PixelCNN decoder than previous work, thus our approach is not directly comparable to them and included at the top of <ref type="table" target="#tab_3">Table 2</ref> as reference points. We observe that SA-VAE suffers from posterior collapse on both text datasets without annealing. However, we demonstrate that our algorithm does not experience posterior collapse even without annealing.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.3">TRAINING TIME</head><p>In <ref type="table" target="#tab_4">Table 3</ref> we report the total training time of our approach, SA-VAE and basic VAE training across the three datasets. We find that the training time for our algorithm is only 2-3 times slower than a regular VAE whilst being 3-7 times faster than SA-VAE.   We analyze the difference between our approach and the methods that weaken the KL regularizer term in ELBO, and explain the unwanted behavior produced by breaking maximum likelihood estimation.</p><p>As illustrative examples, we compare with the KL cost annealing method and β-VAE.</p><p>Decreasing the weight of the KL regularizer term in ELBO is equivalent to adding an additional regularizer to push q φ (z|x) far from p(z). We set β = 0.2 in order to better observe this phenomenon.</p><p>We investigate the training procedure on the Yelp dataset based on: (1) the mutual information between z and x, I q , (2) the KL regularizer, E x∼p d (x) [D KL (q φ (z|x) p(z))], and (3) the distance between the aggregated posterior and the prior, D KL (q φ (z) p(z)). Note that the KL regularizer is equal to the sum of the other two as stated in Eq.5. We plot these values over the course of training in <ref type="figure" target="#fig_7">Figure 5</ref>. In the initial training stage we observe that the KL regularizer increases with all three approaches, however, the mutual information, I q , in the annealing remains small, thus a large KL regularizer term does not imply that the latent variable is being used. Finally the annealing method suffers from posterior collapse. For β-VAE, the mutual information increases, but D KL (q φ (z) p(z)) also reaches a very large value. Intuitively, D KL (q φ (z) p(z)) should be kept small for learning the generative model well since in the objective the generator p θ (x|z) is learned with latent variables sampled from the variational distribution. If the setting of z that best explains the data has a lower likelihood under the model prior, then the overall model would fit the data poorly. The same intuition has been discussed in <ref type="bibr" target="#b31">Zhao et al. (2017)</ref> and <ref type="bibr" target="#b26">Tolstikhin et al. (2018)</ref>. This also explains why β-VAE generalizes poorly when it has large mutual information. In contrast, our approach is able to obtain high mutual information, and at the same time maintain a small D KL (q φ (z) p(z)) as a result of optimizing standard ELBO where the KL regularizer upper-bounds D KL (q φ (z) p(z)).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.5">ANALYSIS OF INNER LOOP UPDATE</head><p>We perform analysis to examine the tradeoff between performance and speed within the inner loop update in our approach, through fixing a budget of updates to the inference network instead of updat-ing until convergence. 7 In our implementation, we break the inner loop when the ELBO objective stays the same or decreases across 10 iterations. Note that we do not perform separate learning rate decay in the inner loop so this convergence condition is not strict, but empirically we found it to be sufficient. Across all datasets, in practice this yields roughly 30 -100 updates per inner loop update. Now we explore using a fixed budget of inner loop updates and observe its influence on performance and speed. We report the results on Yelp dataset from single runs in <ref type="table" target="#tab_5">Table 4</ref>. <ref type="bibr">8</ref> We see that sufficient number of inner iterations is necessary to address posterior collapse and achieve good performance, but the performance starts to saturate near convergence, thus we believe that optimizing to a near-convergence point is important.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">CONCLUSION</head><p>In this paper we study the "posterior collapse" problem that variational autoencoders experience when the model is parameterized by a strong autoregressive neural network. In our synthetic experiment we identify that the problem lies with the lagging inference network in the initial stages of training. To remedy this, we propose a simple yet effective training algorithm that aggressively optimizes the inference network with more updates before reverting back to basic VAE training.</p><p>Experiments on text and image modeling demonstrate the effectiveness of our approach.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A APPROXIMATION OF THE MEAN OF THE TRUE MODEL POSTERIOR</head><p>We approximate the mean of true model posterior p θ (z|x) by discretization of the density distribution (Riemann integral):</p><formula xml:id="formula_12">E z∼p θ (z|x) [z] = zi∈C [z i p(z i |x)],<label>(6)</label></formula><p>where C is a partition of an interval with small stride and sufficiently large coverage. We assume the density value outside this interval is zero. The model posterior, p θ (z|x), needs to be first approximated on this partition of interval. In practice, for the synthetic data we choose the interval <ref type="bibr">[-20.0, 20</ref>.0] and stride equal to 0.01. This interval should have sufficient coverage since we found all samples from true model posterior p θ (z|x) lies within [-5.0, 5.0] by performing MH sampling.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B EXPERIMENTAL DETAILS</head><p>In general, for annealing we increase the KL weight linearly from 0.1 to 1.0 in the first 10 epochs, as in . We also perform analysis for different annealing strategies in Appendix E</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B.1 SYNTHETIC EXPERIMENT FOR SECTION 3 AND 4</head><p>To generate synthetic data points, we first sample a two-dimensional latent variable z from a mixture of Gaussian distributions that have four mixture components. We choose dimension two because we want the synthetic data distribution to be relatively simple but also complex enough for a onedimensional latent variable model to fit. We choose mixture of Gaussian as the prior to make sure that the synthetic data is diverse. The mean of these Gaussians are (-2.0, -2.0), (-2.0, 2.0), (2.0, -2.0), (2.0, 2.0), respectively. All of them have a unit variance. Then we follow the synthetic data generation procedure in , where we sample data points from an one-layer LSTM conditioned on latent variables. The LSTM has 100 hidden units and 100-dimensional input embeddings. An affine transformation of z is used as the initial hidden state of LSTM decoder, z is also concatenated with output of LSTM at each time stamp to be directly mapped to vocabulary space. LSTM parameters are initialized with U <ref type="figure" target="#fig_1">(−1, 1)</ref>, and the part of MLP that maps z to vocabulary space is initialized with U(−5, 5), this is done to make sure that the latent variables have more influence in generating data. We generated a dataset with 20,000 examples (train/val/test is 16000/2000/2000) each of length 10 from a vocabulary of size 1000.</p><p>In the synthetic experiment we use a LSTM encoder and LSTM decoder, both of which have 50 hidden units and 50 latent embeddings. This LSTM decoder has less capacity than the one used for creating the dataset since in the real world model capacity is usually insufficient to exactly model the empirical distribution. Parameters of LSTM decoders are initialized with U(−0.01, 0.01), except for the embedding weight matrix which is initialized with U(−0.1, 0.1). Dropout layers with probability 0.5 are applied to both input embeddings and output hidden embeddings of decoder. We use the SGD optimizer and start with a learning rate of 1.0 and decay it by a factor of 2 if the validation loss has not improved in 2 epochs and terminate training once the learning rate has decayed a total of 5 times.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B.2 TEXT</head><p>Following , we use a single-layer LSTM with 1024 hidden units and 512dimensional word embeddings as the encoder and decoder for all of text models. The LSTM parameters are initialized from U(−0.01, 0.01), and embedding parameters are initialized from U(−0.1, 0.1). We use the final hidden state of the encoder to predict (via a linear transformation) the latent variable. We use the SGD optimizer and start with a learning rate of 1.0 and decay it by a factor of 2 if the validation loss has not improved in 2 epochs and terminate training once the learning rate has decayed a total of 5 times. We don't perform any text preprocessing and use the datasets as provided. We follow  and use dropout of 0.5 on the decoder for both the input embeddings of the decoder and on the output of the decoder before the linear transformation to vocabulary space.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B.3 IMAGES</head><p>We use the same train/val/test splits as provided by . We use the Adam optimizer and start with a learning rate of 0.001 and decay it by a factor of 2 if the validation loss has not improved in 20 epochs. We terminate training once the learning rate has decayed a total of 5 times. Inputs were dynamically binarized throughout training by viewing the input as Bernoulli random variables that are sampled from pixel values. We validate and test on a fixed binarization and our decoder uses binary likelihood. Our ResNet is the same as used by <ref type="bibr" target="#b4">Chen et al. (2017)</ref>. Our 13-layer PixelCNN architecture is a larger variant based on what was used in  and described in their Appendix B.3 section. The PixelCNN has five 7 x 7 layers, followed by, four 5 x 5 layers, and then four 3 x 3 layers. Each layer has 64 feature maps. We use batch normalization followed by an ELU activation before our final 1 x 1 convolutional layer and sigmoid nonlinearity.</p><p>C ADDITIONAL RESULTS CONTAINING ELBO   </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D UNCERTAINTY OF EVALUATION</head><p>To measure the uncertainty in the evaluation stage caused by random Monte Carlo samples, we load pre-trained VAE models trained by our approach and basic VAE training, and repeat our evaluation process with 10 different random seeds. We report the mean and variance values in <ref type="table" target="#tab_8">Table 7 and  Table 8</ref>.  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>E COMPARISON WITH DIFFERENT KL-ANNEALING SCHEDULES</head><p>For the annealing baseline in <ref type="table" target="#tab_2">Table 1</ref> and <ref type="table" target="#tab_3">Table 2</ref>, we implement annealing as increasing KL weight linearly from 0.1 to 1.0 in the first 10 epochs following , and observed posterior collapse for KL-annealing method. However, this annealing strategy may not be the optimal. In this section, we explore different KL-annealing schedules. Specifically, we increase KL weight linearly from 0.0 to 1.0 in the first s iterations, and s is varied as 30k, 50k, 100k, and 120k. We report results on three datasets in <ref type="table" target="#tab_10">Table 9</ref>. The results indicate that KL-annealing does not experience posterior collapse if the annealing procedure is sufficiently slow, but it does not produce superior predictive log likelihood to our approach, which is expected because a very slow annealing schedule resembles β-VAE training in the first many epochs, and β-VAE encourages learning latent representations but might sacrifice generative modeling performance, as we already showed in <ref type="table" target="#tab_2">Table 1 and Table 2</ref>. Also, the optimal KL annealing schedule varies with different datasets and model architectures, so that it requires careful tuning for the task at hand. The lagging behavior of inference networks observed in Section 3 might be caused by different magnitude of gradients of encoder and decoder 9 , thus another simpler possible solution to this problem is to use separate learning rates for the encoder and decoder optimization. Here we report the results of our trial by using separate learning rates. We experiment with the Yelp dataset, and keep the decoder optimization the same as discussed before, but vary the encoder learning rates to be 1x, 2x, 4x, 6x, 8x, 10x, 30x, 50x of the decoder learning rate. We notice that training becomes very unstable when the encoder learning rate is too large. Particularly it experiences KL value explosion for all the 8x, 10x, 30x, 30x, 50x settings. Therefore, in <ref type="table" target="#tab_2">Table 10</ref> we only report the settings where we obtained meaningful results. All of the settings suffer from posterior collapse, which means simply changing learning rates of encoders may not be sufficient to circumvent posterior collapse.  In Section 3 we observe and analyze the lagging behavior of inference networks on synthetic data, but <ref type="figure" target="#fig_2">Figure 2</ref> only shows the setting where the model is initialized at the origin. It remains unknown if a different initialization of inference networks would also suffer from posterior collapse, and whether our approach would work in that case or not. Here we explore this setting. Specifically, we add an offset to the uniform initialization we used before: we initialize all parameters as U(0.04, 0.06) (previously U(−0.01, 0.01)), except the embedding weight as U(0.0, 0.2) (previously U(−0.1, 0.1)). Since all parameters are positive values the output of encoder must be positive. We show the posterior mean space over course of training in <ref type="figure">Figure 6</ref>. Note that all points are located at (approximately) the same place, and are on µ x,θ = 0 upon initialization, which means z and x are still nearly independent in terms of both p θ (x|z) and q φ (z|x). We observe that in basic VAE training these points move back to µ x,φ = 0 very quickly. This suggests that the "lagging" issue might be severe only at the inference collapse state. In such a setting our approach works similarly as before.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Basic</head><p>Aggressive iter = 0 iter = 200 iter = 2000 convergence</p><p>Published as a conference paper at ICLR 2019 when the encoder learning rate is too large. Particularly it experiences KL value explosion for all the 8x, 10x, 30x, 30x, 50x settings. Therefore, in <ref type="table" target="#tab_2">Table 10</ref> we only report the settings where we obtained meaningful results. All of the settings suffer from posterior collapse, which means simply changing learning rates of encoders may not be sufficient to circumvent posterior collapse.  In Section 3 we observe and analyze the lagging behavior of inference networks on synthetic data, but <ref type="figure" target="#fig_2">Figure 2</ref> only shows the setting where the model is initialized at the origin. It remains unknown if a different initialization of inference networks would also suffer from posterior collapse, and whether our approach would work in that case or not. Here we explore this setting. Specifically, we add an offset to the uniform initialization we used before: we initialize all parameters as U (0.04, 0.06) (previously U ( 0.01, 0.01)), except the embedding weight as U (0.0, 0.2) (previously U ( 0.1, 0.1)). Since all parameters are positive values the output of encoder must be positive. We show the posterior mean space over course of training in <ref type="figure">Figure 6</ref>. Note that all points are located at (approximately) the same place, and are on µ x,✓ = 0 upon initialization, which means z and x are still nearly independent in terms of both p ✓ (x|z) and q (z|x). We observe that in basic VAE training these points move back to µ x, = 0 very quickly. This suggests that the "lagging" issue might be severe only at the inference collapse state. In such a setting our approach works similarly as before. </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><label></label><figDesc>t e x i t s h a 1 _ b a s e 6 4 = " X W K g l M N T 3 f l z + H v E 5 P z z k x a y / d Q = " &gt; A A A C J H i c Z V B N S w M x E M 3 W r 1 q / q h 5 F C B b B Q y l b E d R b 0 Y v H C t Y W u q V k 0 2 w b m m y W Z F Y s y 5 7 8 M e J V f 4 c n 8 e D F / + A / M L v t w d a B M C 9 v 3 g w z z 4 8 E N + C 6 X 0 5 h a X l l d a 2 4 X t r Y 3 N r e K e / u 3 R s V a 8 p a V A m l O z 4 x T P C Q t Y C D Y J 1 I M y J 9 w d r + + D q r t x + Y N l y F d z C J W E + S Y c g D T g l Y q l 8 + 9 G T c T z x J Y O Q H y W N a x Z 4 v E w 9 G D E i a 9 s s V t + b m g f + D + g x U 0 C y a / f K P N 1 A 0l i w E K o g x 3 b o b Q S 8 h G j g V L C 1 5 s W E R o W M y Z F 0 L Q y K Z 6 S X 5 G S k + t s w A B 0 r b F w L O 2 b 8 d C Z E m W 9 Q q s 2 T m a h k D S g l T t S o Y y S x l Y / K / m U i / 6 s t q J t I m M A u L Q H D R S 3 g Y x c B C O t 0 j i A U G h T P L 8 I B r R k F M L C B U c 3 s K p i O i C Q V r b M l 6 V F 9 0 5 D 9 o n d Y u a + 7 t W a V x N T O r i A 7 Q E T p B d X S O G u g G N V E L U f S E X t Ar e n O e n X f n w / m c S g v O r G c f z Y X z / Q s 8 k a a P &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " X W K g l M N T 3 f l z + H v E 5 P z z k x a y / d Q = " &gt; A A A C J H i c Z V B N S w M x E M 3 W r 1 q / q h 5 F C B b B Q y l b E d R b 0 Y v H C t Y W u q V k 0 2 w b m m y W Z F Y s y 5 7 8 M e J V f 4 c n 8 e D F / + A / M L v t w d a B M C 9 v 3 g w z z 4 8 E N + C 6 X 0 5 h a X l l d a 2 4 X t r Y 3 N r e K e / u 3 R s V a 8 p a V A m l O z 4 x T P C Q t Y C D Y J 1 I M y J 9 w d r + + D q r t x + Y N l y F d z C J W E + S Y c g D T g l Y q l 8 + 9 G T c T z x J Y O Q H y W N a x Z 4 v E w 9 G D E i a 9 s s V t + b m g f + D + g x U 0 C y a / f K P N 1 A 0l i w E K o g x 3 b o b Q S 8 h G j g V L C 1 5 s W E R o W M y Z F 0 L Q y K Z 6 S X 5 G S k + t s w A B 0 r b F w L O 2 b 8 d C Z E m W 9 Q q s 2 T m a h k D S g l T t S o Y y S x l Y / K / m U i / 6 s t q J t I m M A u L Q H D R S 3 g Y x c B C O t 0 j i A U G h T P L 8 I B r R k F M L C B U c 3 s K p i O i C Q V r b M l 6 V F 9 0 5 D 9 o n d Y u a + 7 t W a V x N T O r i A 7 Q E T p B d X S O G u g G N V E L U f S E X t A r e n O e n X f n w / m c S g v O r G c f z Y X z / Q s 8 k a a P &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " X W K g l M N T 3 f l z + H v E 5 P z z k x a y / d Q = " &gt; A A A C J H i c Z V B N S w M x E M 3 W r 1 q / q h 5 F C B b B Q y l b E d R b 0 Y v H C t Y W u q V k 0 2 w b m m y W Z F Y s y 5 7 8 M e J V f 4 c n 8 e D F / + A / M L v t w d a B M C 9 v 3 g w z z 4 8 E N + C 6 X 0 5 h a X l l d a 2 4 X t r Y 3 N r e K e / u 3 R s V a 8 p a V A m l O z 4 x T P C Q t Y C D Y J 1 I M y J 9 w d r + + D q r t x + Y N l y F d z C J W E + S Y c g D T g l Y q l 8 + 9 G T c T z x J Y O Q H y W N a x Z 4 v E w 9 G D E i a 9 s s V t + b m g f + D + g x U 0 C y a / f K P N 1 A 0 l i w E K o g x 3 b o b Q S 8 h G j g V L C 1 5 s W E R o W M y Z F 0 L Q y K Z 6 S X 5 G S k + t s w A B 0 r b F w L O 2 b 8 d C Z E m W 9 Q q s 2 T m a h k D S g l T t S o Y y S x l Y / K / m U i / 6 s t q J t I m M A u L Q H D R S 3 g Y x c B C O t 0 j i A U G h T P L 8 I B r R k F M L C B U c 3 s K p i O i C Q V r b M l 6 V F 9 0 5 D 9 o n d Y u a + 7 t W a V x N T O r i A 7 Q E T p B d X S O G u g G N V E L U f S E X t Ar e n O e n X f n w / m c S g v O r G c f z Y X z / Q s 8 k a a P &lt; / l a t e x i t &gt; µ x, &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " J r R 8 b p J T 9 W I D X N 5 J E d h m m w 5 B e V U = " &gt; A A A C I n i c Z V B N S w M x E M 3 6 W e t X 1 W M v w S J 4 K G U r g n o r e v F Y w b W F b i n Z N N u G J p s l m R X L s g d / j H j V 3 + F J P A n + C f + B 2 b Y H 2 w 6 E e X n z Z p h 5 Q S y 4 A d f 9 d l Z W 1 9 Y 3 N g t b x e 2 d 3 b 3 9 0 s H h g 1 G J p s y j S i j d D o h h g k f M A w 6 C t W P N i A w E a w W j m 7 z e e m T a c B X d w z h m X U k G E Q 8 5 J W C p X q n s y 6 S X + p L A M A j T p 6 y K / U C m f j z k W d Y r V d y a O w m 8 D O o z U E G z a P Z K v 3 5 f 0 U S y C K g g x n T q b g z d l G j g V L C s 6 C e G x Y S O y I B 1 L I y I Z K a b T o 7 I 8 I l l + j h U 2 r 4 I 8 I T 9 3 5 E S a f I 1 r T J P Z q 6 W M 6 C U M F W r g q H M U z 5 m 8 j d j G V Q D W c 1 F 2 o R m Y R E I L 7 s p j + I E W E S n e 4 S J w K B w b h j u c 8 0 o i L E F h G p u T 8 F 0 S D S h Y G 0 t W o / q i 4 4 s A + + s d l V z 7 8 4 r j e u Z W Q V U R s f o F N X R B W q g W 9 R E H q L o G b 2 i N / T u v D g f z q f z N Z W u O L O e I z Q X z s 8 f g A 2 l p g = = &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " J r R 8 b p J T 9 W I D X N 5 J E d h m m w 5 B e V U = " &gt; A A A C I n i c Z V B N S w M x E M 3 6 W e t X 1 W M v w S J 4 K G U r g n o r e v F Y w b W F b i n Z N N u G J p s l m R X L s g d / j H j V 3 + F J P A n + C f + B 2 b Y H 2 w 6 E e X n z Z p h 5 Q S y 4 A d f 9 d l Z W 1 9 Y 3 N g t b x e 2 d 3 b 3 9 0 s H h g 1 G J p s y j S i j d D o h h g k f M A w 6 C t W P N i A w E a w W j m 7 z e e m T a c B X d w z h m X U k G E Q 8 5 J W C p X q n s y 6 S X + p L A M A j T p 6 y K / U C m f j z k W d Y r V d y a O w m 8 D O o z U E G z a P Z K v 3 5 f 0 U S y C K g g x n T q b g z d l G j g V L C s 6 C e G x Y S O y I B 1 L I y I Z K a b T o 7 I 8 I l l + j h U 2 r 4 I 8 I T 9 3 5 E S a f I 1 r T J P Z q 6 W M 6 C U M F W r g q H M U z 5 m 8 j d j G V Q D W c 1 F 2 o R m Y R E I L 7 s p j + I E W E S n e 4 S J w K B w b h j u c 8 0 o i L E F h G p u T 8 F 0 S D S h Y G 0 t W o / q i 4 4 s A + + s d l V z 7 8 4 r j e u Z W Q V U R s f o F N X R B W q g W 9 R E H q L o G b 2 i N / T u v D g f z q f z N Z W u O L O e I z Q X z s 8 f g A 2 l p g = = &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " J r R 8 b p J T 9 W I D X N 5 J E d h m m w 5 B e V U = " &gt; A A A C I n i c Z V B N S w M x E M 3 6 W e t X 1 W M v w S J 4 K G U r g n o r e v F Y w b W F b i n Z N N u G J p s l m R X L s g d / j H j V 3 + F J P A n + C f + B 2 b Y H 2 w 6 E e X n z Z p h 5 Q S y 4 A d f 9 d l Z W 1 9 Y 3 N g t b x e 2 d 3 b 3 9 0 s H h g 1 G J p s y j S i j d D o h h g k f M A w 6 C t W P N i A w E a w W j m 7 z e e m T a c B X d w z h m X U k G E Q 8 5 J W C p X q n s y 6 S X + p L A M A j T p 6 y K / U C m f j z k W d Y r V d y a O w m 8 D O o z U E G z a P Z K v 3 5 f 0 U S y C K g g x n T q b g z d l G j g V L C s 6 C e G x Y S O y I B 1 L I y I Z K a b T o 7 I 8 I l l + j h U 2 r 4 I 8 I T 9 3 5 E S a f I 1 r T J P Z q 6 W M 6 C U M F W r g q H M U z 5 m 8 j d j G V Q D W c 1 F 2 o R m Y R E I L 7 s p j + I E W E S n e 4 S J w K B w b h j u c 8 0 o i L E F h G p u T 8 F 0 S D S h Y G 0 t W o / q i 4 4 s A + + s d l V z 7 8 4 r j e u Z W Q V U R s f o F N X R B W q g W 9 R E H q L o G b 2 i N / T u v D g f z q f z N Z W u O L O e I z Q X z s 8 f g A 2 l p g = = &lt; / l a t e x i t &gt; mean of true model posterior mean of approximate posterior µ x, = µ x,✓ &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " 8 v n u d 1 + p s g y 2 E O 9 E Z d P k D c M D h n Q</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 1 :</head><label>1</label><figDesc>Left: Depiction of generative model p(z)p θ (x|z) and inference network q φ (z|x) in VAEs. Right: A toy posterior mean space (µ x,θ , µ x,φ ) with scalar z. The horizontal axis represents the mean of the model posterior p θ (z|x), and the vertical axis represents the mean of the approximate posterior q φ (z|x). The dashed diagonal line represents when the approximate posterior matches the true model posterior in terms of mean.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 2 :</head><label>2</label><figDesc>The projections of 500 data samples on the posterior mean space. From left to right we show the change of these points at four different time stamps in the course of training. The top row is from the basic VAE training, the bottom row is from our approach. [Can you make the font slightly bigger? -GN] [Can you also add labels indicating the four training stages ("Stage 1", "Stage 2", ..., or even better "X Epochs", "X Epochs", ...). -GN] [Add labels to the top of "Vanilla VAE" and "Our Approach" (or whatever alternative name you come up with.) -GN]</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head></head><label></label><figDesc>&lt; l a t e x i t s h a 1 _ b a s e 6 4 = " J r R 8 b p J T 9 W I D X N 5 J E d h m m w 5 B e V U = " &gt; A A A C I n i c Z V B N S w M x E M 3 6 W e t X 1 W M v w S J 4 K G U r g n o r e v F Y w b W F b i n Z N N u G J p s l m R X L s g d / j H j V 3 + F J P A n + C f + B 2 b Y H 2 w 6 E e X n z Z p h 5 Q S y 4 A d f 9 d l Z W 1 9 Y 3 N g t b x e 2 d 3 b 3 9 0 s H h g 1 G J p s y j S i j d D o h h g k f M A w 6 C t W P N i A w E a w W j m 7 z e e m T a c B X d w z h m X U k G E Q 8 5 J W C p X q n s y 6 S X + p L A M A j T p 6 y K / U C m f j z k W d Y r V d y a O w m 8 D O o z U E G z a P Z K v 3 5 f 0 U S y C K g g x n T q b g z d l G j g V L C s 6 C e G x Y S O y I B 1 L I y I Z K a b T o 7 I 8 I l l + j h U 2 r 4 I 8 I T 9 3 5 E S a f I 1 r T J P Z q 6 W M 6 C U M F W r g q H M U z 5 m 8 j d j G V Q D W c 1 F 2 o R m Y R E I L 7 s p j + I E W E S n e 4 S J w K B w b h j u c 8 0 o i L E F h G p u T 8 F 0 S D S h Y G 0 t W o / q i 4 4 s A + + s d l V z 7 8 4 r j e u Z W Q V U R s f o F N X R B W q g W 9 R E H q L o G b 2 i N / T u v D g f z q f z N Z W u O L O e I z Q X z s 8 f g A 2 l p g = = &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " J r R 8 b p J T 9 W I D X N 5 J E d h m m w 5 B e V U = " &gt; A A A C I n i c Z V B N S w M x E M 3 6 W e t X 1 W M v w S J 4 K G U r g n o r e v F Y w b W F b i n Z N N u G J p s l m R X L s g d / j H j V 3 + F J P A n + C f + B 2 b Y H 2 w 6 E e X n z Z p h 5 Q S y 4 A d f 9 d l Z W 1 9 Y 3 N g t b x e 2 d 3 b 3 9 0 s H h g 1 G J p s y j S i j d D o h h g k f M A w 6 C t W P N i A w E a w W j m 7 z e e m T a c B X d w z h m X U k G E Q 8 5 J W C p X q n s y 6 S X + p L A M A j T p 6 y K / U C m f j z k W d Y r V d y a O w m 8 D O o z U E G z a P Z K v 3 5 f 0 U S y C K g g x n T q b g z d l G j g V L C s 6 C e G x Y S O y I B 1 L I y I Z K a b T o 7 I 8 I l l + j h U 2 r 4 I 8 I T 9 3 5 E S a f I 1 r T J P Z q 6 W M 6 C U M F W r g q H M U z 5 m 8 j d j G V Q D W c 1 F 2 o R m Y R E I L 7 s p j + I E W E S n e 4 S J w K B w b h j u c 8 0 o i L E F h G p u T 8 F 0 S D S h Y G 0 t W o / q i 4 4 s A + + s d l V z 7 8 4 r j e u Z W Q V U R s f o F N X R B W q g W 9 R E H q L o G b 2 i N / T u v D g f z q f z N Z W u O L O e I z Q X z s 8 f g A 2 l p g = = &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " J r R 8 b p J T 9 W I D X N 5 J E d h m m w 5 B e V U = " &gt; A A A C I n i c Z V B N S w M x E M 3 6 W e t X 1 W M v w S J 4 K G U r g n o r e v F Y w b W F b i n Z N N u G J p s l m R X L s g d / j H j V 3 + F J P A n + C f + B 2 b Y H 2 w 6 E e X n z Z p h 5 Q S y 4 A d f 9 d l Z W 1 9 Y 3 N g t b x e 2 d 3 b 3 9 0 s H h g 1 G J p s y j S i j d D o h h g k f M A w 6 C t W P N i A w E a w W j m 7 z e e m T a c B X d w z h m X U k G E Q 8 5 J W C p X q n s y 6 S X + p L A M A j T p 6 y K / U C m f j z k W d Y r V d y a O w m 8 D O o z U E G z a P Z K v 3 5 f 0 U S y C K g g x n T q b g z d l G j g V L C s 6 C e G x Y S O y I B 1 L I y I Z K a b T o 7 I 8 I l l + j h U 2 r 4 I 8 I T 9 3 5 E S a f I 1 r T J P Z q 6 W M 6 C U M F W r g q H M U z 5 m 8 j d j G V Q D W c 1 F 2 o R m Y R E I L 7 s p j + I E W E S n e 4 S J w K B w b h j u c 8 0 o i L E F h G p u T 8 F 0 S D S h Y G 0 t W o / q i 4 4 s A + + s d l V z 7 8 4 r j e u Z W Q V U R s f o F N X R B W q g W 9 R E H q L o G b 2 i N / T u v D g f z q f z N Z W u O L O e I z Q X z s 8 f g A 2 l p g = = &lt; / l a t e x i t &gt; Figure 2: The projections of 500 data samples from a synthetic dataset on the posterior mean space over the course of training. "iter" denotes the number of updates of generators. The top row is from the basic VAE training, the bottom row is from our aggressive inference network training. The results show that while the approximate posterior is lagging far behind the true model posterior in basic VAE training, our aggressive training approach successfully moves the points onto the diagonal line and away from inference collapse.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 3 :</head><label>3</label><figDesc>Trajectory of one data instance on the posterior mean space with our aggressive training procedure. Horizontal arrow denotes one step of generator update, and vertical arrow denotes the inner loop of inference network update. We note that the approximate posterior q φ (z|x) takes an aggressive step to catch up to the model posterior p θ (z|x).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head></head><label></label><figDesc>0.2) 0.1 (0.0) 0.1 (0.0) 0.8 (0.4) 357.8 (0.2) 0.3 (0.1) 0.3 (0.0) 1.0 (0.0) Ours 328.2 (0.2) 5.6 (0.2) 3.0 (0.0) 8.0 (0.0) 356.9 (0.2) 3.4 (0.3) 2.4 (0.1) 7.4 (1.3)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head></head><label></label><figDesc>in latent representation. The activity of a latent dimension z is measured as A z = Cov x (E z∼q(z|x) [z]). The dimension z is defined as active if A z &gt; 0.01.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure 5 :</head><label>5</label><figDesc>Training behavior on Yelp. Left: VAE + annealing. Middle: Our method. Right: β-VAE (β = 0.2).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head>Figure 6 :Figure 6 :</head><label>66</label><figDesc>The projections of 500 data samples on the posterior mean space. From left to right we show the change of these points at four different time stamps in the course of training. The top row is from the basic VAE training, the bottom row is from our approach. [Can you make the font slightly bigger? -GN] [Can you also add labels indicating the four training stages ("Stage 1", "Stage 2", ..., or even better "X Epochs", "X Epochs", ...). -GN] [Add labels to the top of "Vanilla VAE" and "Our Approach" (or whatever alternative name you come up with.) -GN]    15 µ x,✓ &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " X W K g l M N T 3 f l z + H v E 5 P z z k x a y / d Q = "&gt; A A A C J H i c Z V B N S w M x E M 3 W r 1 q / q h 5 F C B b B Q y l b E d R b 0 Y v H C t Y W u q Vk 0 2 w b m m y W Z F Y s y 5 7 8 M e J V f 4 c n 8 e D F / + A / M L v t w d a B M C 9 v 3 g w z z 4 8 E N + C 6 X 0 5 h a X l l d a 2 4 X t r Y 3 N r e K e / u 3 R s V a 8 p a V A m l O z 4 x T P C Q t Y C D Y J 1 I M y J 9 w d r + + D q r t x + Y N l y F d z C J W E + S Y c g D T g l Y q l 8 + 9 G T c T z x J Y O Q H y W N a x Z 4 v E w 9 G D E i a 9 s s V t + b m g f + D + g x U 0 C y a / f K P N 1 A 0 l i w E K o g x 3 b o b Q S 8 h G j g V L C 1 5 s W E R o W M y Z F 0 L Q y K Z 6 S X 5 G S k + t s w A B 0 r b F w L O 2 b 8 d C Z E m W 9 Q q s 2 T m a h k D S g l T t S o Y y S x l Y / K / m U i / 6 s t q J t I m M A u L Q H D R S 3 g Y x c B C O t 0 j i A U G h T P L 8 I B r R k F M L C B U c 3 s K p i O i C Q V r b M l 6 V F 9 0 5 D 9 o n d Y u a + 7 t W a V x N T O r i A 7 Q E T p B d X S O G u g G N V E L U f S E X t A r e n O e n X f n w / m c S g v O r G c f z Y X z / Q s 8 k a a P &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " X W K g l M N T 3 f l z + H v E 5 P z z k x a y / d Q = " &gt; A A A C J H i c Z V B N S w M x E M 3 W r 1 q / q h 5 F C B b B Q y l b E d R b 0 Y v H C t Y W u q V k 0 2 w b m m y W Z F Y s y 5 7 8 M e J V f 4 c n 8 e D F / + A / M L v t w d a B M C 9 v 3 g w z z 4 8 E N + C 6 X 0 5 h a X l l d a 2 4 X t r Y 3 N r e K e / u 3 R s V a 8 p a V A m l O z 4 x T P C Q t Y C D Y J 1 I M y J 9 w d r + + D q rt x + Y N l y F d z C J W E + S Y c g D T g l Y q l 8 + 9 G T c T z x J Y O Q H y W N a x Z 4 v E w 9 G D E i a 9 s s V t + b m g f + D + g x U 0 C y a / f K P N 1 A 0 l i w E K o g x 3 b o b Q S 8 h G j g V L C 1 5 s W E R o W M y Z F 0 L Q y K Z 6 S X 5 G S k + t s w A B 0 r b F w L O 2 b 8 d C Z E m W 9 Q q s 2 T m a h k D S g l T t S o Y y S x l Y / K / m U i / 6 s t q J t I m M A u L Q H D R S 3 g Y x c B C O t 0 j i A U G h T P L 8 I B r R k F M L C B U c 3 s K p i O i C Q V r b M l 6 V F 9 0 5 D 9 o n d Y u a + 7 t W a V x N T O r i A 7 Q E T p B d X S O G u g G N V E L U f S E X t Ar e n O e n X f n w / m c S g v O r G c f z Y X z / Q s 8 k a a P &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " X W K g l M N T 3 f l z + H v E 5 P z z k x a y / d Q= " &gt; A A A C J H i c Z V B N S w M x E M 3 W r 1 q / q h 5 F C B b B Q y l b E d R b 0 Y v H C t Y W u q V k 0 2 w b m m y W Z F Ys y 5 7 8 M e J V f 4 c n 8 e D F / + A / M L v t w d a B M C 9 v 3 g w z z 4 8 E N + C 6 X 0 5 h a X l l d a 2 4 X t r Y 3 N r e K e / u 3 R s V a 8 p a V A m l O z 4 x T P C Q t Y C D Y J 1 I M y J 9 w d r + + D q r t x + Y N l y F d z C J W E + S Y c g D T g l Y q l 8 + 9 G T c T z x J Y O Q H y W N a x Z 4 v E w 9 G D E i a 9 s s V t + b m g f + D + g x U 0 C y a / f K P N 1 A 0 l i w E K o g x 3 b o b Q S 8 h G j g V L C 1 5 s W E R o W M y Z F 0 L Q y K Z 6 S X 5 G S k + t s w A B 0 r b F w L O 2 b 8 d C Z E m W 9 Q q s 2 T m a h k D S g l T t S o Y y S x l Y / K / m U i / 6 s t q J t I m M A u L Q H D R S 3 g Y x c B C O t 0 j i A U G h T P L 8 I B r R k F M L C B U c 3 s K p i O i C Q V r b M l 6 V F 9 0 5 D 9 o n d Y u a + 7 t W a V x N T O r i A 7 Q E T p B d X S O G u g G N V E L U f S E X t A r e n O e n X f n w / m c S g v O r G c f z Y X z / Q s 8 k a a P &lt; / l a t e x i t &gt; µ x, &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " J r R 8 b p J T 9 W I D X N 5 J E d h m m w 5 B e V U = " &gt; A A A C I n i c Z V B N S w M x E M 3 6 W e t X 1 W M v w S J 4 K G U r g n o r e v F Y w b W F b i n Z N N u G J p s l m R X L s g d / j H j V 3 + F J P A n + C f + B 2 b Y H 2 w 6 E e X n z Z p h 5 Q S y 4 A d f 9 d l Z W 1 9 Y 3 N g t b x e 2 d 3 b 3 9 0 s H h g 1 G J p s y j S i j d D o h h g k f M A w 6 C t W P N i A w E a w W j m 7 z e e m T a c B X d w z h m X U k G E Q 8 5 J W C p X q n s y 6 S X + p L A M A j T p 6 y K / U C m f j z k W d Y r V d y a O w m 8 D O o z U E G z a P Z K v 3 5 f 0 U S y C K g g x n T q b g z d l G j g V L C s 6 C e G x Y S O y I B 1 L I y I Z K a b T o 7 I 8 I l l + j h U 2 r 4 I 8 I T 9 3 5 E S a f I 1 r T J P Z q 6 W M 6 C U M F W r g q H M U z 5 m 8 j d j G V Q D W c 1 F 2 o R m Y R E I L 7 s p j + I E W E S n e 4 S J w K B w b h j u c 8 0 o i L E F h G p u T 8 F 0 S D S h Y G 0 t W o / q i 4 4 s A + + s d l V z 7 8 4 r j e u Z W Q V U R s f o F N X R B W q g W 9 R E H q L o G b 2 i N / T u v D g f z q f z N Z W u O L O e I z Q X z s 8 f g A 2 l p g = = &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " J r R 8 b p J T 9 W I D X N 5 J E d h m m w 5 B e V U = " &gt; A A A C I n i c Z V B N S w M x E M 3 6 W e t X 1 W M v w S J 4 K G U r g n o r e v F Y w b W F b i n Z N N u G J p s l m R X L s g d / j H j V 3 + F J P A n + C f + B 2 b Y H 2 w 6 E e X n z Z p h 5 Q S y 4 A d f 9 d l Z W 1 9 Y 3 N g t b x e 2 d 3 b 3 9 0 s H h g 1 G J p s y j S i j d D o h h g k f M A w 6 C t W P N i A w E a w W j m 7 z e e m T a c B X d w z h m X U k G E Q 8 5 J W C p X q n s y 6 S X + p L A M A j T p 6 y K / U C m f j z k W d Y r V d y a O w m 8 D O o z U E G z a P Z K v 3 5 f 0 U S y C K g g x n T q b g z d l G j g V L C s 6 C e G x Y S O y I B 1 L I y I Z K a b T o 7 I 8 I l l + j h U 2 r 4 I 8 I T 9 3 5 E S a f I 1 r T J P Z q 6 W M 6 C U M F W r g q H M U z 5 m 8 j d j G V Q D W c 1 F 2 o R m Y R E I L 7 s p j + I E W E S n e 4 S J w K B w b h j u c 8 0 o i L E F h G p u T 8 F 0 S D S h Y G 0 t W o / q i 4 4 s A + + s d l V z 7 8 4 r j e u Z W Q V U R s f o F N X R B W q g W 9 R E H q L o G b 2 i N / T u v D g f z q f z N Z W u O L O e I z Q X z s 8 f g A 2 l p g = = &lt; / l a t e x i t &gt; &lt; l a t e x i t s h a 1 _ b a s e 6 4 = " J r R 8 b p J T 9 W I D X N 5 J E d h m m w 5 B e V U = " &gt; A A A C I n i c Z V B N S w M x E M 3 6 W e t X 1 W M v w S J 4 K G U r g n o r e v F Y w b W F b i n Z N N u G J p s l m R X L s g d / j H j V 3 + F J P A n + C f + B 2 b Y H 2 w 6 E e X n z Z p h 5 Q S y 4 A d f 9 d l Z W 1 9 Y 3 N g t b x e 2 d 3 b 3 9 0 s H h g 1 G J p s y j S i j d D o h h g k f M A w 6 C t W P N i A w E a w W j m 7 z e e m T a c B X d w z h m X U k G E Q 8 5 J W C p X q n s y 6 S X + p L A M A j T p 6 y K / U C m f j z k W d Y r V d y a O w m 8 D O o z U E G z a P Z K v 3 5 f 0 U S y C K g g x n T q b g z d l G j g V L C s 6 C e G x Y S O y I B 1 L I y I Z K a b T o 7 I 8 I l l + j h U 2 r 4 I 8 I T 9 3 5 E S a f I 1 r T J P Z q 6 W M 6 C U M F W r g q H M U z 5 m 8 j d j G V Q D W c 1 F 2 o R m Y R E I L 7 s p j + I E W E S n e 4 S J w K B w b h j u c 8 0 o i L E F h G p u T 8 F 0 S D S h Y G 0 t W o / q i 4 4 s A + + s d l V z 7 8 4 r j e u Z W Q V U R s f o F N X R B W q g W 9 R E H q L o G b 2 i N / T u v D g f z q f z N Z W u O L O e I z Q X z s 8 f g A 2 l p g = = &lt; / l a t e x i t &gt; The projections of 500 data samples from synthetic dataset on the posterior mean space over the course of training. "iter" denotes the number of updates of generators. The top row is from the basic VAE training, the bottom row is from our aggressive inference network training. The results show that while the approximate posterior is lagging far behind the true model posterior in basic VAE training, our aggressive training approach successfully moves the points onto the diagonal line and away from inference collapse.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 1 :</head><label>1</label><figDesc>Results on Yahoo and Yelp datasets. We report mean values across 5 different random restarts, and standard deviation is given in parentheses when available. For LSTM-LM * we report the exact negative log likelihood.</figDesc><table><row><cell>Yahoo</cell><cell>Yelp</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head>Table 2 :</head><label>2</label><figDesc></figDesc><table><row><cell>Model</cell><cell>NLL</cell><cell>KL</cell><cell>MI</cell><cell>AU</cell></row><row><cell></cell><cell>Previous Reports</cell><cell></cell><cell></cell><cell></cell></row><row><cell>VLAE (Chen et al., 2017)</cell><cell>89.83</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell>VampPrior (Tomczak &amp; Welling, 2018)</cell><cell>89.76</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell cols="3">Modified VAE Objective</cell><cell></cell><cell></cell></row><row><cell>VAE + anneal</cell><cell>89.21 (0.04)</cell><cell>1.97 (0.12)</cell><cell cols="2">1.79 (0.11) 5.3 (1.0)</cell></row><row><cell>β-VAE (β = 0.2)</cell><cell cols="4">105.96 (0.38) 69.62 (2.16) 3.89 (0.03) 32.0 (0.0)</cell></row><row><cell>β-VAE (β = 0.4)</cell><cell cols="4">96.09 (0.36) 44.93 (12.17) 3.91 (0.03) 32.0 (0.0)</cell></row><row><cell>β-VAE (β = 0.6)</cell><cell>92.14 (0.12)</cell><cell cols="3">25.43 (9.12) 3.93 (0.03) 32.0 (0.0)</cell></row><row><cell>β-VAE (β = 0.8)</cell><cell>89.15 (0.04)</cell><cell>9.98 (0.20)</cell><cell cols="2">3.84 (0.03) 13.0 (0.7)</cell></row><row><cell>SA-VAE + anneal</cell><cell>89.07 (0.06)</cell><cell>3.32 (0.08)</cell><cell cols="2">2.63 (0.04) 8.6 (0.5)</cell></row><row><cell>Ours + anneal</cell><cell>89.11 (0.04)</cell><cell>2.36 (0.15)</cell><cell cols="2">2.02 (0.12) 7.2 (1.3)</cell></row><row><cell cols="3">Standard VAE Objective</cell><cell></cell><cell></cell></row><row><cell>PixelCNN  *</cell><cell>89.73 (0.04)</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell>VAE</cell><cell>89.41 (0.04)</cell><cell>1.51 (0.05)</cell><cell cols="2">1.43 (0.07) 3.0 (0.0)</cell></row><row><cell>SA-VAE</cell><cell>89.29 (0.02)</cell><cell>2.55 (0.05)</cell><cell cols="2">2.20 (0.03) 4.0 (0.0)</cell></row><row><cell>Ours</cell><cell>89.05 (0.05)</cell><cell>2.51 (0.14)</cell><cell cols="2">2.19 (0.08) 5.6 (0.5)</cell></row></table><note>Results on OMNIGLOT dataset. We report mean values across 5 different random restarts, and standard deviation is given in parentheses when available. For PixelCNN* we report the exact negative log likelihood.</note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head>Table 3 :</head><label>3</label><figDesc>Comparison of total training time, in terms of relative speed and absolute hours.</figDesc><table><row><cell></cell><cell>Yahoo</cell><cell></cell><cell cols="2">Yelp15</cell><cell cols="2">OMNIGLOT</cell></row><row><cell></cell><cell cols="6">Relative Hours Relative Hours Relative Hours</cell></row><row><cell>VAE</cell><cell>1.00</cell><cell>5.35</cell><cell>1.00</cell><cell>5.75</cell><cell>1.00</cell><cell>4.30</cell></row><row><cell>SA-VAE</cell><cell>9.91</cell><cell>52.99</cell><cell>10.33</cell><cell>59.37</cell><cell>15.15</cell><cell>65.07</cell></row><row><cell>Ours</cell><cell>2.20</cell><cell>11.76</cell><cell>3.73</cell><cell>21.44</cell><cell>2.19</cell><cell>9.42</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5"><head>Table 4 :</head><label>4</label><figDesc>Results on Yelp dataset using a fixed budget of inner encoder updates</figDesc><table><row><cell cols="4"># Inner Iterations NLL KL MI AU Hours</cell></row><row><cell>10</cell><cell>357.9 1.1 1.0</cell><cell>3</cell><cell>11.97</cell></row><row><cell>30</cell><cell>357.1 3.6 2.5</cell><cell>8</cell><cell>22.31</cell></row><row><cell>50</cell><cell>356.9 4.2 2.8</cell><cell>9</cell><cell>29.58</cell></row><row><cell>70</cell><cell cols="2">357.1 4.4 2.7 10</cell><cell>24.18</cell></row><row><cell>convergence</cell><cell>357.0 3.8 2.6</cell><cell>8</cell><cell>21.44</cell></row><row><cell>6.4 ANALYSIS OF BASELINES</cell><cell></cell><cell></cell><cell></cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6"><head>Table 5 :</head><label>5</label><figDesc>Results on Yahoo and Yelp datasets. We report mean values across 5 different random restarts, and standard deviation is given in parentheses when available. For LSTM-LM * we report the exact negative log likelihood.</figDesc><table><row><cell></cell><cell></cell><cell>Yahoo</cell><cell></cell><cell></cell><cell></cell><cell>Yelp</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>Model</cell><cell>IW</cell><cell>-ELBO</cell><cell>KL</cell><cell>MI</cell><cell>AU</cell><cell>IW</cell><cell>-ELBO</cell><cell>KL</cell><cell>MI</cell><cell>AU</cell></row><row><cell></cell><cell></cell><cell></cell><cell cols="2">Previous Reports</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>CNN-VAE (Yang et al., 2017)</cell><cell>-</cell><cell>332.1</cell><cell>10.0</cell><cell>-</cell><cell>-</cell><cell>-</cell><cell>359.1</cell><cell>7.6</cell><cell>-</cell><cell>-</cell></row><row><cell>SA-VAE + anneal (Kim et al., 2018)</cell><cell>-</cell><cell>327.5</cell><cell>7.19</cell><cell>-</cell><cell>-</cell><cell>-</cell><cell>-</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell></cell><cell></cell><cell></cell><cell cols="3">Modified VAE Objective</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7"><head>Table 6 :</head><label>6</label><figDesc>Results on OMNIGLOT dataset. We report mean values across 5 different random restarts, and standard deviation is given in parentheses when available. For PixelCNN * we report the exact negative log likelihood.</figDesc><table><row><cell>Model</cell><cell>IW</cell><cell>-ELBO</cell><cell>KL</cell><cell>MI</cell><cell>AU</cell></row><row><cell></cell><cell cols="2">Previous Reports</cell><cell></cell><cell></cell><cell></cell></row><row><cell>VLAE (Chen et al., 2017)</cell><cell>89.83</cell><cell>-</cell><cell>-</cell><cell>-</cell><cell></cell></row><row><cell>VampPrior (Tomczak &amp; Welling, 2018)</cell><cell>89.76</cell><cell>-</cell><cell>-</cell><cell>-</cell><cell></cell></row><row><cell></cell><cell cols="2">Modified VAE Objective</cell><cell></cell><cell></cell><cell></cell></row><row><cell>VAE + anneal</cell><cell>89.21 (0.04)</cell><cell>89.55 (0.04)</cell><cell>1.97 (0.12)</cell><cell cols="2">1.79 (0.11) 5.3 (1.0)</cell></row><row><cell>β-VAE (β = 0.2)</cell><cell cols="5">105.96 (0.38) 113.24 (0.40) 69.62 (2.16) 3.89 (0.03) 32.0 (0.0)</cell></row><row><cell>β-VAE (β = 0.4)</cell><cell cols="5">96.09 (0.36) 101.16 (0.66) 44.93 (12.17) 3.91 (0.03) 32.0 (0.0)</cell></row><row><cell>β-VAE (β = 0.6)</cell><cell>92.14 (0.12)</cell><cell>94.92 (0.47)</cell><cell cols="3">25.43 (9.12) 3.93 (0.03) 32.0 (0.0)</cell></row><row><cell>β-VAE (β = 0.8)</cell><cell>89.15 (0.04)</cell><cell>90.17 (0.06)</cell><cell>9.98 (0.20)</cell><cell cols="2">3.84 (0.03) 13.0 (0.7)</cell></row><row><cell>SA-VAE + anneal</cell><cell>89.07 (0.06)</cell><cell>89.42 (0.06)</cell><cell>3.32 (0.08)</cell><cell cols="2">2.63 (0.04) 8.6 (0.5)</cell></row><row><cell>Ours + anneal</cell><cell>89.11 (0.04)</cell><cell>89.62 (0.16)</cell><cell>2.36 (0.15)</cell><cell cols="2">2.02 (0.12) 7.2 (1.3)</cell></row><row><cell></cell><cell cols="2">Standard VAE Objective</cell><cell></cell><cell></cell><cell></cell></row><row><cell>PixelCNN  *</cell><cell>89.73 (0.04)</cell><cell>-</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell>VAE</cell><cell>89.41 (0.04)</cell><cell>89.67 (0.06)</cell><cell>1.51 (0.05)</cell><cell cols="2">1.43 (0.07) 3.0 (0.0)</cell></row><row><cell>SA-VAE</cell><cell>89.29 (0.02)</cell><cell>89.54 (0.03)</cell><cell>2.55 (0.05)</cell><cell cols="2">2.20 (0.03) 4.0 (0.0)</cell></row><row><cell>Ours</cell><cell>89.05 (0.05)</cell><cell>89.52 (0.03)</cell><cell>2.51 (0.14)</cell><cell cols="2">2.19 (0.08) 5.6 (0.5)</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_8"><head>Table 7 :</head><label>7</label><figDesc>Evaluation of a trained VAE model trained by our approach across 10 different random seeds. Mean values are reported and variance is given in parentheses. IW denotes the approximation to NLL we used in Section 6.</figDesc><table><row><cell>Dataset</cell><cell>IW</cell><cell>-ELBO</cell><cell>KL</cell><cell>MI</cell><cell>AU</cell></row><row><cell>Yahoo Yelp OMNIGLOT</cell><cell cols="5">5.35 (0) 357.03 (10 −5 ) 358.25 (2 × 10 −4 ) 3.82 (10 −5 ) 2.61 (0.003) 8 (0) 3.01 (0.002) 8 (0) 327.98 (10 −5 ) 329.54 (5 × 10 −4 ) 89.03 (0) 89.53 (3 × 10 −4 ) 2.54 (0) 2.21 (0.001) 6 (0)</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_9"><head>Table 8 :</head><label>8</label><figDesc>Evaluation of a trained VAE model trained by basic VAE training across 10 different random seeds. Mean values are reported and variance is given in parentheses. IW denotes the approximation to NLL we used in Section 6.</figDesc><table><row><cell>Dataset</cell><cell>IW</cell><cell>-ELBO</cell><cell>KL</cell><cell>MI</cell><cell>AU</cell></row><row><cell cols="6">Yahoo Yelp OMNIGLOT 89.41 (0) 328.85 (0) 329.54 (1 × 10 −5 ) 0.00 (0) 358.17 (0) 358.38 (3 × 10 −5 ) 0.00 (0) 89.66 (2 × 10 −4 ) 1.48 (0) 1.39 (6 × 10 −4 ) 3 (0) 0.00 (0) 0 (0) 0.00 (0) 0 (0)</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_10"><head>Table 9 :</head><label>9</label><figDesc>Results on Yahoo and Yelp datasets, with different annealing schedules. Starred entries represent original annealing strategy.</figDesc><table><row><cell></cell><cell>Yahoo</cell><cell></cell><cell>Yelp</cell><cell></cell><cell cols="2">OMNIGLOT</cell></row><row><cell>Model</cell><cell cols="5">NLL KL MI AU NLL KL MI AU NLL KL</cell><cell cols="2">MI AU</cell></row><row><cell>VAE + anneal (30k)</cell><cell>328.4 0.0 0.0</cell><cell>0</cell><cell>357.9 0.2 0.2</cell><cell>1</cell><cell cols="3">89.18 2.54 2.19 10</cell></row><row><cell>VAE + anneal (50k)</cell><cell>328.3 0.7 0.7</cell><cell>4</cell><cell>357.7 0.3 0.3</cell><cell>1</cell><cell cols="3">89.15 3.18 2.58 10</cell></row><row><cell cols="4">VAE + anneal (100k) 327.5 4.3 2.6 12 356.8 1.9 1.2</cell><cell>5</cell><cell cols="3">89.27 4.04 2.97 16</cell></row><row><cell cols="4">VAE + anneal (120k) 327.5 7.8 3.2 18 356.9 2.7 1.8</cell><cell>6</cell><cell cols="3">89.32 4.12 3.00 15</cell></row><row><cell>VAE + anneal  *</cell><cell>328.6 0.0 0.0</cell><cell>0</cell><cell>358.0 0.0 0.0</cell><cell>0</cell><cell cols="2">89.20 2.11 1.89</cell><cell>5</cell></row><row><cell>Ours + anneal  *</cell><cell cols="6">326.6 6.7 3.2 15 355.9 3.7 2.3 10 89.13 2.53 2.16</cell><cell>8</cell></row><row><cell>Ours</cell><cell>328.0 5.4 3.0</cell><cell>8</cell><cell>357.0 3.8 2.6</cell><cell>8</cell><cell cols="2">89.03 2.54 2.20</cell><cell>6</cell></row><row><cell cols="8">F SEPARATE LEARNING RATES OF INFERENCE NETWORK AND GENERATOR</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_11"><head>Table 10 :</head><label>10</label><figDesc>Results on Yelp dataset varying learning rate of inference network.</figDesc><table><row><cell>Learning Rate NLL KL MI AU</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_12"><head>Table 10 :</head><label>10</label><figDesc>Results on Yelp dataset varying learning rate of inference network.</figDesc><table><row><cell>Learning Rate NLL KL MI AU</cell></row></table><note></note></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2">µ x,θ can be approximated through discretization of the model posterior, which we show in Appendix A. 3 Note that the converse is not true: the setting where all points are located at the origin may not be a local optimum. For example when a model is initialized at the origin as we show in Section 3.2.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2">This LSTM decoder has less capacity than the one used for creating the dataset since in real world model capacity is usually insufficient to exactly model the empirical distribution.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="4">In Appendix G we also study the setting where the points are not initialized at origin.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="5">We measure the uncertainty in the evaluation caused by the Monte Carlo estimates in Appendix D. The variance of our NLL estimates for a trained VAE model is smaller than 10 −3 on all datasets.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="6">While annealing reverts back to ELBO objective after the warm-up period, we consider part of "Modified VAE objectives" since it might produce undesired behavior in the warm-up period, as we will discuss soon.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="7">Note that in practice, we never reach exact convergence, thus here we aim to show how close to convergence is required in the inner loop update. 8 70 inner iterations take less time than 50 because the aggressive training of it stops earlier in practice.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="9">In the experiments, we did observe that the gradients of decoder is much larger than the gradients of encoder.</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Fixing a broken ELBO</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alexander</forename><surname>Alemi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ben</forename><surname>Poole</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ian</forename><surname>Fischer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joshua</forename><surname>Dillon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Rif</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kevin</forename><surname>Saurous</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Murphy</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICML</title>
		<meeting>ICML</meeting>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Latent Dirichlet allocation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>David</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Blei</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Andrew</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael I Jordan</forename><surname>Ng</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of machine Learning research</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="993" to="1022" />
			<date type="published" when="2003-01" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Generating sentences from a continuous space</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Luke</forename><surname>Samuel R Bowman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Oriol</forename><surname>Vilnis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Andrew</forename><surname>Vinyals</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Rafal</forename><surname>Dai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Samy</forename><surname>Jozefowicz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Bengio</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of CoNLL</title>
		<meeting>CoNLL</meeting>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Importance weighted autoencoders</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yuri</forename><surname>Burda</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Roger</forename><surname>Grosse</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ruslan</forename><surname>Salakhutdinov</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICLR</title>
		<meeting>ICLR</meeting>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Ilya Sutskever, and Pieter Abbeel. Variational lossy autoencoder</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xi</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Diederik</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Tim</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yan</forename><surname>Salimans</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Prafulla</forename><surname>Duan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">John</forename><surname>Dhariwal</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Schulman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICLR</title>
		<meeting>ICLR</meeting>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Inference suboptimality in variational autoencoders</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Chris</forename><surname>Cremer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xuechen</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Duvenaud</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICML</title>
		<meeting>ICML</meeting>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">TopicRNN: A recurrent neural network with long-range semantic dependency</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Adji</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Chong</forename><surname>Dieng</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jianfeng</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">John</forename><surname>Gao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Paisley</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICLR</title>
		<meeting>ICLR</meeting>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Avoiding latent variable collapse with generative skip models</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Adji</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yoon</forename><surname>Dieng</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alexander</forename><forename type="middle">M</forename><surname>Kim</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><forename type="middle">M</forename><surname>Rush</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Blei</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICML workshop on Theoretical Foundations and Applications of Deep Generative Models</title>
		<meeting>ICML workshop on Theoretical Foundations and Applications of Deep Generative Models</meeting>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Z-forcing: Training stochastic recurrent networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Anirudh</forename><surname>Goyal</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alias Parth</forename><surname>Goyal</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alessandro</forename><surname>Sordoni</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Marc-Alexandre</forename><surname>Côté</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nan</forename><forename type="middle">Rosemary</forename><surname>Ke</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of NIPS</title>
		<meeting>NIPS</meeting>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Deep residual learning for image recognition</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kaiming</forename><surname>He</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xiangyu</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Shaoqing</forename><surname>Ren</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jian</forename><surname>Sun</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of CVPR</title>
		<meeting>CVPR</meeting>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Shakir Mohamed, and Alexander Lerchner. β-VAE: Learning basic visual concepts with a constrained variational framework</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Irina</forename><surname>Higgins</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Loic</forename><surname>Matthey</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Arka</forename><surname>Pal</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christopher</forename><surname>Burgess</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xavier</forename><surname>Glorot</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Matthew</forename><surname>Botvinick</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICLR</title>
		<meeting>ICLR</meeting>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Iterative refinement of the approximate posterior for directed belief networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Devon</forename><surname>Hjelm</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Ruslan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kyunghyun</forename><surname>Salakhutdinov</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nebojsa</forename><surname>Cho</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Vince</forename><surname>Jojic</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Junyoung</forename><surname>Calhoun</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Chung</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of NIPS</title>
		<meeting>NIPS</meeting>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Long short-term memory</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sepp</forename><surname>Hochreiter</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jürgen</forename><surname>Schmidhuber</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Neural computation</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="1735" to="1780" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">ELBO surgery: yet another way to carve up the variational evidence lower bound</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Matthew</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Matthew J Johnson</forename><surname>Hoffman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of NIPS Workshop in Advances in Approximate Bayesian Inference</title>
		<meeting>NIPS Workshop in Advances in Approximate Bayesian Inference</meeting>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Stochastic variational inference</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Matthew</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Hoffman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>David</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Chong</forename><surname>Blei</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">John</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Paisley</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Journal of Machine Learning Research</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1303" to="1347" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Semi-amortized variational autoencoders</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yoon</forename><surname>Kim</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sam</forename><surname>Wiseman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Andrew</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Miller</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alexander M</forename><surname>Sontag</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Rush</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICML</title>
		<meeting>ICML</meeting>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Adam: A method for stochastic optimization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Diederik</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jimmy</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Ba</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICLR</title>
		<meeting>ICLR</meeting>
		<imprint>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Auto-encoding variational bayes</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Diederik</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Max</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Welling</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICLR</title>
		<meeting>ICLR</meeting>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Improved variational inference with inverse autoregressive flow</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Diederik</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Tim</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Rafal</forename><surname>Salimans</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xi</forename><surname>Jozefowicz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ilya</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Max</forename><surname>Sutskever</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Welling</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of NIPS</title>
		<meeting>NIPS</meeting>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">On the challenges of learning with inference networks on sparse, high-dimensional data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Rahul</forename><surname>Krishnan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Dawen</forename><surname>Liang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Matthew</forename><surname>Hoffman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of AISTATS</title>
		<meeting>AISTATS</meeting>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Human-level concept learning through probabilistic program induction</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ruslan</forename><surname>Brenden M Lake</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joshua</forename><forename type="middle">B</forename><surname>Salakhutdinov</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Tenenbaum</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">350</biblScope>
			<biblScope unit="issue">6266</biblScope>
			<biblScope unit="page" from="1332" to="1338" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Iterative amortized inference</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joseph</forename><surname>Marino</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yisong</forename><surname>Yue</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Stephan</forename><surname>Mandt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICML</title>
		<meeting>ICML</meeting>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">A hierarchical latent structure for variational conversation modeling</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yookoon</forename><surname>Park</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jaemin</forename><surname>Cho</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Gunhee</forename><surname>Kim</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of NAACL</title>
		<meeting>NAACL</meeting>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<title level="m" type="main">The mutual autoencoder: Controlling information in latent code representations</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mary</forename><surname>Phuong</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Max</forename><surname>Welling</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nate</forename><surname>Kushman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ryota</forename><surname>Tomioka</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sebastian</forename><surname>Nowozin</surname></persName>
		</author>
		<ptr target="https://openreview.net/forum?id=HkbmWqxCZ" />
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">A hybrid convolutional variational autoencoder for text generation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Stanislau</forename><surname>Semeniuta</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Aliaksei</forename><surname>Severyn</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Erhardt</forename><surname>Barth</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of EMNLP</title>
		<meeting>EMNLP</meeting>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Ladder variational autoencoders</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Tapani</forename><surname>Casper Kaae Sønderby</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Lars</forename><surname>Raiko</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Maaløe</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ole</forename><surname>Søren Kaae Sønderby</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Winther</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of NIPS</title>
		<meeting>NIPS</meeting>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Wasserstein autoencoders</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ilya</forename><surname>Tolstikhin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Olivier</forename><surname>Bousquet</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sylvain</forename><surname>Gelly</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Bernhard</forename><surname>Schoelkopf</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICLR</title>
		<meeting>ICLR</meeting>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">VAE with a VampPrior</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Jakub</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Max</forename><surname>Tomczak</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Welling</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of AISTATS</title>
		<meeting>AISTATS</meeting>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Conditional image generation with pixelcnn decoders</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Aaron</forename><surname>Van Den Oord</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nal</forename><surname>Kalchbrenner</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Lasse</forename><surname>Espeholt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Oriol</forename><surname>Vinyals</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alex</forename><surname>Graves</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of NIPS</title>
		<meeting>NIPS</meeting>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">Spherical latent spaces for stable variational autoencoders</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jiacheng</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Greg</forename><surname>Durrett</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of EMNLP</title>
		<meeting>EMNLP</meeting>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">Improved variational autoencoders for text modeling using dilated convolutions</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zichao</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zhiting</forename><surname>Hu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ruslan</forename><surname>Salakhutdinov</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Taylor</forename><surname>Berg-Kirkpatrick</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of ICML</title>
		<meeting>ICML</meeting>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Shengjia</forename><surname>Zhao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jiaming</forename><surname>Song</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Stefano</forename><surname>Ermon</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1706.02262</idno>
		<title level="m">InfoVAE: Information maximizing variational autoencoders</title>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
